<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Workforce Planning Calculator | Direct Hire vs Contractor | Main Line Talent Group</title>
<meta name="description" content="Free workforce cost calculator that compares the true cost of hiring a direct W-2 employee versus engaging a contractor. Includes employer taxes, benefits, recruiting fees, ramp costs, and a personalized PESTLE industry analysis. Make smarter hiring decisions with data.">
<meta name="keywords" content="workforce cost calculator, direct hire vs contractor, hiring cost comparison, true cost of employment, contractor vs full time, staffing cost analysis, workforce planning tool, PESTLE analysis, compensation benchmarking, employer cost calculator, talent management, HR planning tool, Main Line Talent Group">
<meta name="author" content="Main Line Talent Group">
<meta name="robots" content="index, follow">
<link rel="canonical" href="https://www.mainlinetalent.com/resources/workforceplanningcalculator">
<meta property="og:type" content="website">
<meta property="og:title" content="Workforce Planning Calculator | Direct Hire vs Contractor | Main Line Talent Group">
<meta property="og:description" content="Compare the true cost of hiring a direct employee versus engaging a contractor. Free calculator with industry-specific PESTLE analysis, compensation benchmarking, and a personalized PDF report.">
<meta property="og:url" content="https://www.mainlinetalent.com/resources/workforceplanningcalculator">
<meta property="og:site_name" content="Main Line Talent Group">
<meta property="og:image" content="https://www.mainlinetalent.com/resources/workforceplanningcalculator/og-preview.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Workforce Planning Calculator | Direct Hire vs Contractor | Main Line Talent Group">
<meta name="twitter:description" content="Free calculator comparing true hiring costs: W-2 employee vs contractor. Includes taxes, benefits, recruiting, ramp costs, and industry-specific PESTLE analysis.">
<meta name="twitter:image" content="https://www.mainlinetalent.com/resources/workforceplanningcalculator/og-preview.png">
<meta name="theme-color" content="#231F20">
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebApplication","name":"Workforce Planning Calculator","description":"Free workforce cost calculator comparing direct W-2 hire vs contractor costs.","url":"https://www.mainlinetalent.com/resources/workforceplanningcalculator","applicationCategory":"BusinessApplication","operatingSystem":"Any","offers":{"@type":"Offer","price":"0","priceCurrency":"USD"},"creator":{"@type":"Organization","name":"Main Line Talent Group","url":"https://www.mainlinetalent.com"}}
</script>
<link href="https://fonts.googleapis.com/css2?family=Work+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">
<style>
:root {
  --dark:#231F20; --red:#EB1C24; --blue:#4C9CC9; --blue-dark:#2E5E79; --green:#2d7a4f;
  --dark-red:#961217; --amber:#b45014; --bg:#f7f5f2; --card:#ffffff; --border:#e8e4e0;
  --muted:#8a8580; --beige1:#D6CFC7; --beige2:#C4B8AE; --beige3:#AFA095; --neutral-gray:#BBB1B1;
  --light-gray:#E6E6E6; --r:10px; --font-heading:'Work Sans','Helvetica Neue',sans-serif; --shadow:0 2px 12px rgba(0,0,0,0.06);
}
*{box-sizing:border-box;margin:0;padding:0;}
html{overflow-x:hidden;width:100%;}
body{font-family:'Helvetica Neue',Helvetica,Arial,sans-serif;background:var(--bg);color:var(--dark);line-height:1.6;-webkit-font-smoothing:antialiased;overflow-x:hidden;width:100%;border-radius:var(--r);border-top:5px solid var(--dark);}body::before{content:'';position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);width:340px;height:340px;background:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAYAAAB5fY51AAA2HklEQVR4nO3deXicV5Un/u+5961Fm2VJ1m5LlrxGsuM1Tpyt5GwkELIQyiYkhKSzkLVnwnT3PL/+/X5dEjM9PUtP90ADPSwJNEmAqGigCQwNAWwlaSBAyGLiJI6zOF4i76tU9db73nvmjyqFELLIspa6pfN5HvNHwhNX1Vv31Fun7vdcQAghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGKTyqVUgxQifxRU/16CiEmDk31AxDiZMgbeJpIAaoPsOtPv/CvF7/2/AUmzBmGVgSAUfxvhJHHyAAM2FaS0kcUfvW3g7vuYoAo/69EiSv296kYFynF6OPasy6Yc8F5V7964dc/TdH9u8FepPAGcGuthwzMIkZ9RRXuyA12PzV4fMtIQZ7qxyYmlvQApoFEqkcRwF3LL7jGX96Dlxatzvm5jBkmMsNszTCzM3+yzOYYW1OuVW6NivBdkcYrAaAnkZD38jQgF7n00abeHgOgPN4w+zaEhnatPt+zsQqtrNEEOPWHAR1n6HavzCMbUgf4NgCxnoEBM9UvtJh4UrBKXCKR0kSErg9df0XF7HlzzLHD5mDnKWr/gmXQfgas3HkLEADDjAZPY5aOqCPGmm4da/3Tpo4kAZxCwpvqxygmljvvVjEmPZt6LQBu7jr7Ol0+k2EDZi+Gnae/D8zkXBOTAczzYvBgEBCh1jLWePRJAJW96JEeVomTglXKUinVR2S7L3j/KfGmtkSQHQYRacoNY8+SVTjW3Aad88EOVC1Cvtk+Uyk0eh4CZihAH7chr1TRFRfXNZ1C6LNJQE/1YxUTRwpWCUugRwFAbfd5N0fqWuNsQsMUIRXm4FfVY/eqBGzgg5xY4wQLizbPQwUpWBBAQMhsOon5smj0NgDoTyan+oGKCSQFq3TRQG+PqatbVFU5e/6HbRiCwQqwICggCLF75Tr4VTMBG071Y31PDEYZFOZEoggLuxeIAUukjTXU5cXWNzRUNKp02kDe1yVLLmyJSqRSGkS8+MqPXBlraJsT+r4hkAIAqxRULoMjrQtwYPEqeP4wWBXvXRYByLFFoxdBDXkImd/ovSmAfMvhcq0qblUzP8oANsoWh5IlF7ZE9fT2WgCIzZ5/C3lxBv/hr/4ju8Z3nv5+GBWFYoti3kCqiNAZ8aD4j/flB0SqwjJOj0SvA0CyxaF0ScEqQclkUvcR2RWXfmxtRUPzWbnsEIjoD26hWBG0n8G+haficNs8UC6TD7gUHULAQC1pNOgoAvAf/bKpwOq4YXuKKlt+fWvrOgK4X5rvJUkKVilK9gMAonNP+Y9eTRPIWvPWS00ggA38ihnYtfoCqMCAoMFFdJfFABQDFgadnocYGG9360QghGTtHGacjdi/B4BkKlU8T0SMGylYpYfSG5RpXrhq1sy53T0mZ8Cw+q2FKP/FSsHzsxhc0YPh2gZQmMs35IsEATAAKklhdiSCAPy2j84CAENnbYBlWl9wWn19k+rrsyl5f5ccuaAlJpHaqMGM7kuvTZY1dVabXMaA1Nt+2WMiqCDA8foW7F2yFshli2rnOwEIYNESiWIGNOw73DMRABCRzxx2KV12U2zmtQzJF5YiuaAlppAbjFBN853Iz1x5z8YUW8aO0y+EicZBtpg2ixM8AJ06Ckvv/Q3PEJQ2jHnKfAJAVJrvpUcKVglJJFIeEfEZ629LlDXN7gqzWUNE73qNubDF4WBnNw51LoHOFUe+kAAEbDHL8zBLa4SjqLwEUhlrzCnKm//JlraLCIDkC0vL1L8zxbgp5AZRsfC023VlLawZ3d2SNhYmEseuNReBrS2afCGD0akj8JDf7vpeFICAGI2WcLYXuQ0A96YkX1hKpGCVjHxusPP0cxdEahouC/wsE/Goftq3moCcjz1Lz8DxhlaoXA5TPdsxBFBNCq1epJAbfO+vhPn/B+kha3kBvIsuq2tZRNJ8LylyIUtEIpXPDc4557KPlDV1aA5DM9p9VQSCF+ZwvKYRg8t7oHIZsJq6gqWQHyMzOxIp5AZHr7Ar3iwgeJdXVl4LSPO9lMiFLA008Knzwnqg0pvZfKe1Bsz2hK4tQ4HCHHavXodceRVolF8nJ4IBEAdhrhd5Izd4IphIWbZYaO1N9fX1lYXme7F80xUnQQpWCUikUhrMNPvjf3ppVeuihtB/72b7mzEKO99zWRxqW4j9b+QLJ//tkW+254f01agILP/xzvZR/DdU1sB0K9V0c6R8PQG8EQnZ+V4CpGCVgEJukGs6Vt+IeAWI32nH0rsjBozysHPNxTBKYRQ7CcYdA1BgdHpRaOBtgjijExCjEsBqrW8FgB4MSPO9BEjBclyqMKRv1dW3LK5obD87zAwxjzVHRwTtZ7Fv8SocbemAzmXBo79RGxeGgZlao9nzkIMZ8/c4AvRwaO1SiqzaUN9yJgEsw/3cJwXLcVu6ewkA4q1L7/Jm1sfZGgMaW4qZSYFMgMyMmdi96nwgyE1q44fAsGzRqaOI4eROGszvkmfbTqQ+EC2/AQDLcD/3ScFyG6U3KHPxxRfHKls7LzdBALA9ibsIBhFB5XwMrlyHXHUtYAPwJExxIOQzgTGlMMeLwrzNGJkTZYl0YAwWkf7wwubKWYXhftJ8d5gULIcl+/sVmHF8XuLj5bNaW8Nc1oBObj8Ck4LO+TjS1I7Xu9fAy2aBSfpaGIAxW3uYoRTGYwaqAmiYrenyaOZd1LKBAUjz3W1SsNxF/cmkBRBVlTP/0uoIwGbc7h4YjN2nvx9hJAbiyelXe0yYG42O699nQRS1Fp3K3AXA64FscXCZFCxHJZNJRUS8/Iob1lZ3dLWH2SFLpMfneioF5Wexf/4SHGpflG++T+AWh5GtDLXaQ4PWGM999kRQwya0S7RedFvz3PMK5xfKXZajpGA5qqu/nwGgYu7Sv4hU14PM+N2WMABtQwTxCuxecyEonPihBwxGhxdBlGlUkxlGiwDkiLgZhDMV3Q0AvckGGe7nKClYTspvZZi/dOnsijkLegI/xxasx3Mmu1UKlMtiz7KzMDSrCSqYmOZ7/jRnoEIpzBnJDY7zQYnEpH1jeaHWF62qq1tM6bSRfKGb5KI5aCQ3WH3aB++oaGort2HOEBGNb2uGoIMcjte2YPeys+D52Qnp/BS2H6BNRVB5grnBUf8dBPhszVLlqWvLqj8GSL7QVXLRHDSQH9JXVtO5dINhBYaZmOtIBDYhdq8+H0G8DDS2DfTvygCIAZgbicJMSLnKC4k0GYtToa4HUHbewEAIab47RwqWY5L9/RpEOHXDLZeUN8/rMH7G0gTtO8hvccjicMdiHFi4PD/FYRz/KgIQglHvKdRpb1RD+sZKAeQbY7p1tOXu5vYrGYA0390jBcs5SQDgpiXnXKMqqhjMdiJvFIgZoS7Da2suzO/sHO+/ihnzdAyKJnbrBAHIKcYsDrHWi30CAHohw/1cIwXLJamUSq8nu+h9yUXRmuZLwswwwKMb0jdW+RHKQ9jbvQbHm9oK+cKT/+8SgJAZ1aTR5MURMAqHpE4chtJD1tguhbMvrm04g9An+ULHSMFySAI9CgDXLzzttkhtSxmbcMy5wROhwgDZGbOwe9X5+Wmk4/S10MCiPeKhnBjMPOERIAUgx7ALQOrCeOx2SL7QOVKw3EEDvT2msbGxomruwiuMCRnMk3D9GIQIEOawe+W58KuqQebkN4sbAHHSbxrSNzn9b0OkjbF8mlf2gRkzZtdKvtAtUrAckUilNIh49vnXfiw6q7099DMWJzCkb+wIVgGe7+PI7HnYt3gNPP/kRiiPfB1s1h5mUhRmApvtb1XIF9plimrvrKDrJF/oFilYjigM6aMZ85bcoCJRxgT3e96KARhS2LXmYhilT3q4n2agw4uAaawj+saGABgCxdlipY7eAoB6sEnOL3SEFCwHjAzpO2v9J06d0TR3dZDJYrQn4owbpaCzPvYtXoojcxYAucw7HBz/3nJg1GqNJh2B4fGYy3BiCEplQ2NXeJHFH29tTxBImu+OkILlgJEhfd6crk+q2ibF1pipuHTKhshUzMDu1RdCByGsHtuuAGag3YsgRpjsG0UA+RHMAWBbwZRguhMApPnuBilYxY/S65VpXrhwVrx57mVh4AMwU3I3wAR4fg67Vp6Dodp66ODEN4tbJlSQwpxIPjc42SOYgTe+3moTWizxvIuWNzXVS/PdDVKwilwitVEDjPkX/8lHypo6ZtpcLjzZIX1jRgoU5DBcPxv7lq6F52dhT+ChKAABbH5IH2lMZYVQAA3DhF3kVf1pdGZ+uF9Cmu/FTgpWkduUzw16sfr2W0EKYzj1alwRAGsZu067EEGkDOoEptpYEKJgzI1EYcdxssRYWZCKWIsWG/wZgHI5v7D4ScEqYslkvyYiXr3+tp7yxjndYda3k95sf4v8zvdhHJi3FAfnLYH2R3eyTj43aDHL81CvFQzbKa8MBFJD1tilnm7/i9b2RH64nzTfi5kUrGKWbwTTjHnL7tRVtbAmmPrbEgDaMMJoHLvXnA+2o48yMjM6VAwexnNy19jltzhYrofi1RTND/dLpSRfWMSkYBWrfG7QLEok2qN1LZcGfhZExfHpbzVBZ33sXboWQ/Wt0Ln3GmrMMMyYQQrNUQ8BADXl91d5FlpnwhALFZ13bk3NUurrszLcr3jJhSlShdwgGpZfen1Z8zzNYRhiEo7bGg0GQZkAx2tasHtFDyiXe/eZ75QfI9PueaggBcvFcYcFFH4IYDaLFOnLymtuBYDeZLI4XmjxR6RgFScqNNsryhrabrTWgNkWzbVSyM9dpzCDPSvPR1BeAbIB3vEuiwlRAuZEYsAEDAE8WZagYBhrlPeh+vr6SqTTkxduFCekaBaB+L1EKqWJCKd/9JOXlrXMmx3ksoYmJTc4OgwGSEH7AQ7MnY8Di1bAy/pvmy8cyQ02aY065SHAFP/M+bZIZawxXRpNN6vy9XKyTvEqmkUgfq+hu5cB8IyFK26geEW+W12UGFZFsOP0i2CJ3jZfOPKPOr0YQPakM4gTIf8LJmGGJT4tSjcBQG9KhvsVIylYxSaZ1On1ZJZfdkNXtGH2ujAzxDTBQ/rGihVB+RkcWLQaR1vmgsMM8sv/91XJMKNaKTR6UYQ8iWMZThRBD1mDLhU7/frmtpXU12clX1h8pGAVmWSyHwBQ3n7KJ6M1jVG2ZlKG9I0FE0GbAEMzajG46gJE/aDQfCdw4X+ZGZ1eBHEowBbl0wBQGKEMth1Qag30XwCSLyxGUrCKC6U3KNPQ0NBYXt/6MRPkALbeVD+od0KcP6hCBVnsWnUuhqtrocIcAAWF/M72mCK0eVGYiR09f9LyD41UYAMsi3iXzJd8YVGSglVEkv2swIzGc666raqjKxrmcmaCDsQZN0wEnQtwpHku9navye98VwBACNmiRWtUk4Ypmo0Mb4+RzxdmLJtlpGfcpGIfk3xh8Snu1TDN9Cfzs4LrFq34iNURgI0jn+4MZsKuNZcgiERBhd8INAidkTjsBJ+IM55CIopZi6Va3wwgIvnC4iIFq1gkk5qIsPqa21ZXty2eb4czXExbGd4NKwXtZ7B/wak4PHcxdC6LgIBardAwwecNjjdFrI6xtUt0dPGNTbPPl3xhcXFiQUwHqf5+BsDxWQt6dfUsHZ5ISK8IKGMQxMuxe9UFUGH+DOe5OooouCh3Xr0TxYQQbFst87na+3eA5AuLiRSs4qD6CDz3lBXtVW0LEkHO5/zRD+5gpUC5LAZXnI2js5owwxjMicQQ8Mhvhm7IP1LSw9ZgiYquO7u6oVNJvrBoyEUoAonURgUQt5x16Y3xxrkVJggMTdWQvjFiIqggwHBtC3YsOZPbwoArdH5In2sIIJ/ZLNYU+9jMqg0MoCeRkLVSBOQiFIGBfG6wrGpe9wYLAGycvC5EBGtzOHDGxdReXUtsXCxXeZZIeYaxEJGb0Y54ofkuppiTC6OUJJP9GkRY+dE/PT9e37Ewf97gu40+KF6WmWMU5Zc17dluzIG4AmzxDGY4IQqkjls23eCO/8fvfD8B6EdSmu9TzMmFUVLyu6m5Zv6qm3VFFcMW837wd6eUMhEPNHjswN+8fHTf32sdhcdOfisEwAjJooaJV0Tp3wHgZKrLyeJbSqRgTaX8kD67eO0HlsTrmi7JZTMArJuf4sxMOqqH9+7IHNv6i298P2Ie2GpDP0rQrq5yAulhG/ISUmdeWld3GvX1yfmFU0wK1hQqDOnj2jUXfDxaPyfCJiza3OB7I+PFo5TZ9dKP9nzn/r3/csR/9Xc299O4VlCMyT8tdRwQgByz7STlfTBe+XEAfHsi4ej1KQ1SsKYODfT2mNra+TNmzmn/sDGGUQi1OEkrZY4dxtDOlz4z8o9+Yfx/3A8iBShX77Iskbah5WVe/ENt1W015w0MnPhhjGLcuLtAHJdIpTSIeP5VH708Nmvu3NDPWhR7cPAdMLOJxMqVv3/Xk7/6+t9vYmZigD6ze/ePXmLaXKFIMeDk5ksF0DCzXUzcfEslkgCQknzhlHFygZSCnt5eCwAzWufdjGicyTramwagSDPZEEd2bfkKAO7p3aQ35Sd2Br+12a/ltIcIF/m4hndhwSizxMt1/EYG0Dsgw/2mihSsqZBKqT4ie1rypuXlDR1rw+xxQJGTn9pkGSriecd2vZB77qEHfgAQBvrW2XUYsATgc8cO/fOzofFjpLQFF+XE0ffCRDprDHeTWv2JjgVrCDLcb6pIwZoCye5eAoB429K7vZpZnrHWuHr3wUShF/VgDuy578hrL76c7Lca+a9/1iaTeuuRI688h/BfPB0hxdawg09TgeETbCtYnRuYuwAZ7jdVpGBNPkpvUGZ21xm1Fc0dlwZBDmBoN/dXWpDS2j+4z+7Z+vRnASCdXv/Gv12fTgMAHjPHPrMTOfYUOTRo5s0IDOjAWMxX6kNLGhoaVTptHBpCUTKkYE2yRGqjBjPm9FxxbVnT3Fqby4Xk6FYGtmS8snLK7tv5iy3/8uWnUswK+SmdAIA0YBlM97y+7/GnTPhCBWkFZidrlgIoAxN2K6/8zljVNQxgk5ysM+mkYE2ywnmDkbKGljtAqqjOGzxhSoNyw8jt2f4PALCpt/etz4V70aMBhL825gtDpOHBzYIFAAZKRY1FJ9FtACI9kOF+k83dxeKgZLJfExF3f/Bj76tqaV/o+74hcvMaMNh6sZg+tvuVvY/+4///EIgw0Nf3Rz919mHAEIB/OHrwG5tt7mBcae1qvpAANcTGdFN0/h0tcy4hgPtlDU0qebEnU6FR27LinOt0ZQNT+C6nJRc5AlmtPYSHdt4LYDj5oNV4+0LEP0skvKGhoT2bDX/bU5oUs5N7OBQYOSaqh8GppHsBqKSjX3FdJQVrsuRzg2bR6e+bq2tbPpjLZQFy9KdxZpCO6Ny+18IjT//8HgBIP9v7jndNnx8YYAD4pn/kG9uYOUqk2MGbLAYBBJUxhtfqaNcFra3zQAQZ7jd55IWeJIXcIJrO+cBHyuo74hzmDNzstcMCJhIvo6M7nv+3J3+cfinFrNDX9453GmnAcCqlHj1w4GfPsHm0QhExyNG7LCDHbBYoxC6H/gQBLMP9Jo+80JODBnp7TDNQHpvVeKtlC2Z3c4OkPPDwURzduf3TAPhtmu1/pLdvkwJAz9vg0weVoghbB++x8gzlzy1bouIfmzFjRq2crDN5nF00LinkBlFz1R3JssbO9jCbNa6ciPNWzNZGYzE9tG/Hlqe/+fffAzMN9PW95zSGPgwYBtC3a/u/Phfyy2VaaVfzhRqgrLWm20PDLfGKqwjgjbLFYVI4uWhcU8gNcnP3adfoWDnYOrlO87cQpC2BcXT7lq8DMIneTaNdqLwpHxoe/g35DzB50OxmwQKAgJhqjOKzY+UfB4AeSL5wMkjBmmjJpO4jsvPWvv/M8oaWddlc1hK5OaTPMrOORPTw66/6ux/5l2/mc4ObRr1QNw3k84Xf8TNf3QrOxIm1m+lCgAA9ZA0vVrEzkw0tayVfODmkYE2wRNftBAANy876hFc320MYWDiZcyaAYLxYlHJ7X/vOjmefeCmfG3znZvtb9RXyhY/t3fvyNoOH4ipKxG6OqSAQcjB2Hiz1eNE7AckXTgYpWBOLBj51XphItMerFy473wYBiNnFagXAQilP+Yf3Y/CZ/FYGvCk3OFrpfL6Qvhscvn+HMvBIOTncjwEwlM7ZEKfr2IWdNZ3VKh9Lkub7BJKCNYGS/azADFp254Z4/ZzWIJc1IEUubvRmhvXicZXbu/23z/3o6z9jZkq/KTc4WusBwwDu37Pnh1uMfbFcKcWO9rLyw/2sWaSo/s/L9UcYACeTsqYmkLy4E6g/CQvAQ1XdXyilwO7Vqd8jYoQh/L2v/gMA29PbO+Y7xULzPXzShF/yFTmdL2RWiLLFfPAdABTSaWefiwukYE2QZDKpiYhXX37zmqrZnV2+71vlaLMdbFlH4/rYjq3DTzx4z78WcoNjXpjrCs33Lxza88AWkzscU8rdfCFBD1tjF3pq6V2trYlCvtDN6+wAKVgTJdkPAKhavPIub2YD2FjLbm69AqBNJKJhDu+9Z3jf9sFCbvBk7iSsTSb1jkxm9+/Yfj/6Rr7QvZpFAALAtrDC6YjdDYCSkOb7RHF1BRW5fG6wc+3ahlhD6wfDXA4Eo938AZ9BWuvsvt08+NQvvwj84ZC+sSoM96Mfh+FnXgbbCEHBwXGk+eY76QyHWKjUJatrWmYT0kbyhRNDXtQJkEjlc4MNKy+5Md7YUWFyuUKz3T2WYSJlcRoafPXnzz98/7NvHdI3VmnAMFLUP7jz1y9Y88ty5SlLbp4SrQDKWQ67tPaur4hfDwCSL5wY8qJOgJEhfZVNC27K31Q5e/o8iDRsNovg8Kv/AwBvSafH7bn0Ip8v/JUJvnxMETx2cYZDniFSnmF0g24CuqKFfKEYZ1KwxllhSB9Ou/bu88ubOzsDP2OdHdJnLXvxuMrsfHHnK5//Lw+DCOn168ftV7DCcD/+a3/7t54xZk+5y813kMpYa07xVNvdLUc/lG++J6X5Ps6cXEhFLb/bmesWn3a9rpgBYuvseXxQykRI0fDul+9/HRhO/NXPPIxvQeGfJRIeDuDYZg4egPLgOTrcj8DIEaOWFa/1orcCoGSqy8niW8ykYI2nwpC+Uy64eoGqrr88yA5z/kQc9xBbjuiozh7YcXzP5n/7EgAMYPS5wdHaNDBgAeChIPOVl5mzMYKybv46AQLp4dCgC5FzLm9oWEJ9ki8cb1KwxtHIkL7artNujta1xNmEBq6eiENsdDyG7J7t/+fFx37wcrKf9bsN6RurPsByKqUe3rPnd08Y//G4iihiN5vv+S0ObOYTqUujVTcCwO2JhJPXv1hJwRo/NNDbY9rb2+Mz5i74kDU2vw3aSQyoKIXHD9K+Z355HwDa+7neCVt4vX19CgBtyh6/Zx8xIkxuNrKQH+5nrcVCqI/X1NRUnzcwEMLZnkDxcXRBFZ/CkD6uPe/qq2N1s+eFfsbA2SF9bCPRuM4MvvLcMw995WFmxsDAew/pG6u+Qr7w3gP7HnyWeVu5IqeH+2WsMad6eubd5dUbGIAM9xs/Ti6oYrSpt9cAQE1Txx2IRBlu9o4BAETaAgH2P7c5DcDvGf2QvrEaGe6X+60JvhJoDY/ZOriPFABgQFRpGCugbwWAHmxy981QZKRgjYNCbhBLL7jmjMq2xcuMP8QE5eanKltW0age2vXq8P4nHv4CCBjoWzfhC65nIH9+4f2ZI1/bYs1wVCnP2S0OROo4G9vlecuvbWw7j0AszffxIQVrPORzgzxz6crbvZn1njGwjg7SBKCMF4kSHdv/1R0vPLk7+SC/03mD44oAtsmk3nzw4M6XiL8V0wqedbP5DjBCZjsHRGs9vhuQ4X7jRQrWyVPpDcrUt7c3lTXPvTzMBQw22sk+KzOgPR0c2mMPb/3NFwGMaUjfWBXyhXgoe+yrr7GFJih28XUEYIl0YEKcpsvPXtXcPKsw3E/W20mSF/AkJVIbFZgx7+KPX13ZvGCGCXxDjuYGGTBeWYz8va/98lf9X3gmxazGMqRvrPL5QtDX9+x55FlrN1eQVuzoycoKoCwj7FJq5rWRshsZwEbJF540eQFPDhVyg2UVDZ23W+XBcujua6o1Kz+Ho9u3fhmjPG9wvG1KJDQB5kmE/zikFSJw9IghACFBRUyIBaxuBRCT8wtPnruLqwgkEilNROi+5KPnl81ZMD/MDhvl6lYGa9mLxL3jr7+8Z+tXPv/twnmDk95DWlcIDf/toQPpp0L/aNzpfCFUxlqzXHlzb2mZcxEBSEnz/aQ4ubiKRcMdvQyA55xxSTJaVcPMhl19P5JSRnuE4Z3Pf/sQDh0pnDc4FYWCbTKpjx8/vv9Z5u9oFSHl6B4RApADoQmGL/TiNwPg3lTK2TvGYiAFa8zyucHW5ecuUJU1G3K+DzB7Tt4MsAXpiPb3vIbBJx79MjAxucHR6k2nGQAeyeX+/hWYXIyhrZsJJzBBDxvGAvDFZ9XUdFNfn5XhfmMnL9wYjQzpm3f2+z8aa5obs2Fg4OiislAmEo/T8J4dP37plz/6bYpZTURucLT6AMtIqf59u55+ns1AmecRWTfvshSAHLNZpLzI5RUzbgFkuN/JkBdubGig0Gwvb1t4jWELYuvsa6mUhskchzm08+8AYMv68RvSN1Yjw/0ezQX3HSSC52ZSB0B+uB9Cy6er+FWorp4pzfexc3aRTaVCbhCnfvjOZLS+bUHoZx3ODVobicW1v2/Hlkf/93/6KZgpnV4/5XczfRgwDOB/tr72zRctv1iutLaO5gsJUBk2pkuh9fayGVcTwCnJF46Jk4tsqvX09loA3NC16lodLweMk+sIxIAiZUHA8I7n7wMQJiY+Nzha+XzhEwh+Egw/bLSGYlgm97aSEgAD0EwLviASvwYAetHj5ptmiknBOkHJZFL3EdnF5126sqyp7dwwk7NQjh4/z5YRKdO5wVeHt/6w/yGAMNA3dc32t9pUOL/wh5ljX3jBmiCqrAaTk+fRWqV0xua4S6kzr25oWUuQ4X5jIQXrBO3tup0AoG7peTd6Na0xY7OWnPvMz7OKTCwaodzhPf17Xnr62WS/1cDUNdvfqg+wNpVSjx8+/Mwzlh+uUFGCozvfNVv4rG0Hgc7x9B2A5AvHQgrWiaGB3h7TeGpjRdWc+VeYwAeY3cwNgkHKU7kj+7D7+cfvATCpucHRSvf1EQB6OHf0y7vJIkIE974UAgyCJejQWKz04hcvqltUVcgXuvdkppAUrBMwMqRv4Tl3f7isoa0lzDmcG2Rro7Eyldm/44kt6S/+nJlpMnODo7UeMArgB/bu/eGvjd1RSUoz3LzLUgANszHdpOtuLstdZwFiJGUNngB5sU5AodmuovWtd5KOOLlH9A2kGSaAOTz4dwBsT29v0fZTfoqEByD7u9B+NqMVPEe/FgKAZUUxZiwA3UUAA2lnn8tUkII1SiPN9mUfvHFtecOc1b6ftUS2aBf5u2G2rKNxfWzntmO/uu9zPwERpiI3OFrrkG++3xsOfu1ZmzsWz49EdfLjgghqyAZ2lYrNv7W17TwC0C/N91GTgjVa+SF9qF106l2RmnqwDZ09b5BImUgkAnt835eG9ry8dwLOGxxv1iaTevu+4cHnQN/ytCbt7PmFBMNkG8H6TI78BwBIplLF/NoXFSlYo6PS65VpW7yqOdrU+YEgFzCxm3dXYIZSWg8f2I59j/zo6wAwsOXzRb9gCsP96LvD/ldfZUIUpIr+Qb8thiHSWRvyKVqdv7q6oUNJvnDU5EUahURqowIYLeuuvL68aW6lCXIGrjbbwcaLVyC3a/vPNz/23adSzApF2Gx/q/xwvxR9b//Ox7aY4NdlWis4en6hAshnNqdoL7ahovJGhuQLR0tepFEoDOmLVTZ13MwA4HBukJUG+8N05NVtXwBgpmJI31gV8oX2SWu+dFQTpmr+zXgwBBUJLVZ46lpgdpnkC0fHmTfrVEkm+zURYeVVd1xY0TK/I/CzlsjN142t4Ui0XA29vm3HE9/40vemakjfWPVhwCgAn/KPPvhkaA6UK3eb7wqkjiMw3Uq13dlgrpDhfqPj5MKbVPndyFyz9IwbVEUVwNbRZjsDyjOeYjr22rYHgSOHp3BI31ixSSY1Dh48+pT106wVIs6erAMYJtRZQk9Z2Q2Q4X6jIgXr3SSTOr2ezJwlidXRmlmXBbmszQ/pcxCDPU9p/8CuzP7f/vQrANNUDukbq950mgnAANn/uY0552mr2a2i+wZWpLPGcDdHeq5qbJThfqMgL867SBRyg7PPveiaeP0cz4aBdXVIHxOMFytH9vVX/3Xbr362JdmPKR3SN1Z9gP0rdEUf2rnzlResfbhcaSJHtzgoBnxi06Eoss6ruB2Q5vt7kRfnndHAp84La2pqqqta533UWAaso1sZwCDSZI4dpX0v/PYrAAiFMwDdtMUCsL8wuf+9jxQ0sbPH1hqQ5tDwChX5ULUM93tPUrDeQSKV0mCm1rOTN5W3zm8IfT8k5ehWBmYbjZXrzIHXnnnm21/8ITOjGIb0jVUfEDKAv9v92o9eNPxCufI0OzrcT+fzhbZLqaY749XXKIA3ynC/dyQF6x2MDOlrXHbGlRQtB2zgZLECgHySJcTBF559EEDYUzxD+sZsUyKhAQSPhH5/SAra4XxhSESV1mBZxLudAfRgwNkPk4kmBevtpFKqj8h2X3rNaeUtHWuCTIaJyM1FzswqEtVDg68dHfy37/5TfkjfOucXxMhwv28PHfraFmuysXxVdhJBqSEO7SrtnXLFrKZLCGAZ7vf2pGC9jWR3LwFAdfuSP4vMbIgYhMbRrVcAwUSiMcLRvffvfPHpXfkhfW7+qvZmfYV84ZNHj257Fub7caUJjp5fqBgIQHYOFF0ci30CkOF+78TRVTihKL1BmWXt7TNnzO26MAhDKGM1O7jGGQxSEZU9/DoObH70HgCULsIhfWOVLuQLNwa5f9hBFlHAwYnvABPDgrRvQ6xWscTypsp6Ge739qRgvUUitVGDGTOuuGNDvLmjxvhZA0eb7WCYSLxMBftee+yJ73z1yRQzuZAbHK31gGGAvja489HnDT9VobSCq1scAPIth4s0zbwp2nw1A9iYkOb7W0nBeotCblBH61ruBJGD91VvQhoc+Dj6yov3AmCXcoOjtQkJBYB/x/z5IaWgHL5ihkjFDKMLdBMAr2dgk5PFdyKV3Bv4ZIzkBk+98tZEWVPHkjCbtYrcbH6ytaxjMT28a9u+bd/7628V+5C+sVqHAUMA/mb4YP+W0ByKO50vhDoKYxeSWnpnY9v7CMQy3O8PScF6s0JucNailbdHqmpgjWFX77EUkYl4CkM7t/3zgQM4lnywNJrtb4NtMqkPHTp05EUK74+RB8Vs3HyqDGuZG0B8WlR/EpDhfm8lBWtEKqXS68m0Lf1AZ7Sx7ZLA95kIysUmLpgBL6KDvTuDw1uf+gwApJ/tLdk3fm86zQCwUdnPv0w2iBK0k9cNBCalsybAUtLnnl1b2yX5wj8kL0RBAj0KANrOX/eRsoY55RzmDMjN4CCDTCReRsN7tm969icPPpdidjI3OFp9gOVUSv3T9u3Pb7bhz8uVB4eH+8FnNouV9q6rqNkASL7wzeSFyKPfD+lrv8GwBTO7+9ooDR4+juHB7Z8GgC3r004W3hPR29enAODXgf/lw4rIc/IrYZ4lUmQMFrK6Cairknzh77m7KMdRIpXSRIQlV92WjDXMnR/6viEiJ18bZmsjsbjOHRp8Zva9/+VfwUwu5wZHq6+wxeG/Dea++6y1r5Ypra2j+UIFqCFm0+2plj9ril9JAMtwvzwnF+V4G8kNNi1efZ2OV4I4dPLjmQEo8iwRY//Wxx9KAyZRArnBUeJ8vnDf8d/a8BusFDTDsqNvcWZgplVY68VvARDthQz3A6RgAYXzBrsSly+PN89NBP6wBbv5aUaWWUW0yuzdln1h4/e/lc8NFv+JOONl08CABYD7jh/85hZrbZRIu/lrIcCk9LDNcbf2zrqqsXUFoc9KvlAK1htD+mqXn3tTtK4paoyxrjbbQcp40ZgyBw/0H3nx6afyucHS2dn+XvoAy8mkfvLw4We2UfBQmdIgNsbFkqXA8AHTCYVkLH41ANyOhJvvy3E03QsWDXzqvLC+q6uyvGVeMgxCwBo3P8WYAU0qd+QwBjc/fi+cH9I3NoV8IR7OZb74ujKkyc1PHwbAIB3YEAvZ21BXV1dVGDvj4tMZN9O6YI3kBmevvur68ub2htD3jbND+gAbiZWp7J5Xnv7dd7/0mOtD+sZqJF94z+DgT581dmslecrCzVlZCqCMNWaeVk1/Ga34uAJ4uucLp3XBKmxl8Krb226CjjG7+aNSgWJYg6M7X/gyAFMKQ/rGqjDczx8Is/0ZTfAcvrAGisqNwTwduYMBNd3zhdO3YCWTmoiw9APXr53RMm9Z6GdYudrU5HxucGj3S4d3/iD9jfx5g+4P6RurdYXhfg8c3P/VzWGYjZFyNl9IBDVkrV2mI4s/0th4CYEwnZvv07ZgJZP9AMB1p666Wc9sBkzo6Ik4DECZSCQCOrLv3t27nz/g4HmD483aVErt8P2XHrfBI56niJidrFkEIAfYVjAuilTdBoCn83C/6VqwVHqDMnMWrWiJzZp7RZjz2cLNE3EYAHRU5/bt4L2/+enXAKBhy/TZyvBO1vf1EQAMWP+vd1iFGEDWyQ8kgAnaN4ZXKDp3dU3NHJVOm+maL5yWTzqR2qjAjLkXJ9eXN86tskHOELnZbAeTicUjOLZn5y+f+nH/5hSzSpfQkL6xSgOGwfS9wcHHnrT+MzFPKXL0lGgFUJbZLFRe1dXlM2/OH1QxPfOF0/JJjzTbyxrn3WKJwGzdfR1IweaydHzXts8CsFvSpZ8bHK00SAGwr4H/+zA8KHK29w5LpDxjscJT1wDt8el6so67C3WMCkP6eOlH/8OFsYa2U0w2Y8nREyZGcoPDe3a+9MRX/+Y7YKb0+vXurspxth6wBOB/Ifj2s5zbXU7a3eY7SA1xaBaT7ry72VxCAKbjcD8nF+pJKTQsGzoW3eZVVIOttS7uxSMAIGWVJhzftbUfQEaa7X+EbTKpd+7cmdlsgwe10lBg497VBgiMEECDVXyWjt8BgKfjcL/pVbCSSZ1eT6Zl0dozo7NaPuDnfAsy3lQ/rLFgtqy8iM7t3eHv//UPvgYAA9gkd1dvMTLcb4Cin9vGyJYxnLzLIgAM6CFreDF5PRfNmrWK+qZfvnBaFayR3ODcCy+9Mt7YqSgILOBkvQKgjBePUub1HT/a+ouB55P9rEt5SN9YjeQLH9yx7aVn2A7EdJSUgyfrMAANQo7ZztOsLy+vuhYA3Z6YXvnC6VSwaKC3xzQ2oqJybtdV1phCs925D9s8pZQ9dgxHXt36OUzT3OBo9eZ/iKBHgqP37CcDRUQuXnUGwATFxmANYlfV1dVVTrfhftOmYCVSKQ0itH/w/72sfFZbR+BnHR7SxyYSK1e5AzufeuLBv/3xdM0NjlZhuB/+cXDwu88zXqogrdnR4X4EqGFms4Aw5y/jNZcTwBsxffKFTi7YsRgZ0lfZ1HmHisYZHE71QxozIsUEg8MvP/d1AJjOucFRKgz3Q/BU6H8lVIBmNwPRAGBBKGfLC5S9CwD1oMfZ53KipkfBSqVUH5Fdeun1K8ubO87ws1nA1fMG2bKKRPXwrleGnv/xd/rzQ/qmb25wtHoG8ucXpv3jX3mOzXCMlOdi871AD1vD3cpbc2Nz85nTabjftChYye5eAoDq+UvvitQ2aZjQuPrUCZ6JRCMUDu2/7/CrT27PD+lzduFNGgLYplLq5wcO7H6W7Q9jWrN29GQdAhAw7BzWWEPxTwLAdMkXurlqTwylNyjT1tZWU9my4INhEDBgtYtdSgaDNJR/aB92PfmzfwJASK+f6ofljPRIvjDIfWYXLCli5Wq/2hLpHOd4hfYumN/UVK/ycaySX88l/wRHhvQ1XfCxG8ua2+psLmfgbG6QTSReobL7X3n8+YceeDzFTJIbHL38cL+Uundw5789Z/FUpVLKwjrZ/1EA+RZmsefN+ISO/gkD2DgN8oUl/wRHcoMz2hdfBxUFc+jscyblMQc+Dj71q28D4E29vc4+l6myCZsUAPOMCb+YUdrp4X4hSMVDg1NV5AYAsemQLyzpN3wyP6SPV330ztPLGzuWBtlh6+5WBss6GtPDO144tOPb6ftAhIG+vpJ/g463dcg33//X0b3f2mztobgiJ3e+A28M9zOnaL3oxpaWiwrnF7q6E3pUnFy8o5Yf0ofahatu8arrwBw6mhu0AHnG05oy+3fftx/7X0/81c88OLrQphjbZFIPHj++bzOH34moCLmbLwQCAE1MvJbifw5A9zq4i/9ElG7BSqVUej2ZttXnd6qqho/k/CyD3fz0YVbQSuncwdf9Yy/++rMASHKDY7e+kAr4yZD/xa0wiADaOLn3PT/cL2sMlmt9zpl1dfOJiEt5uF/JPrEEehQAtKw67/ry5jlRDnPGzRHIAMMaXVZB/uD2jU/94BsvpphJcoNjlwYMp1Lqnw/uevz5MPh5ufaILDl5Z6IA+MymW2msj1bdApT2cL9SfWI0kG+2l1d3LLjaWgVmdvS5MogiQOYIXn/+V/cDIGm2n7zevk0KAB4Ng3uOgKAd/nZtiRSZECsjsaswe3ZZKZ9fWJJv/EQipUHES5O3Xx5v6JgfZjPG3SF9bHU8po7veHHX7771hX8GEUuz/eT1YcAwQJ9W5ptPs9ldrpS2juYLFaCG2JpTFLX/mU8b8s330swXOrmI30vPpl4LAI0LV96gyyoY1t0PHCJtFYEOvvzsgwCy0mwfN/l84euvD/8m9B9kpdzOF7LCDAbWxKKfAEC9JZovLL2ClUzqPiJefPYVq6INcy4I/AyDlJufNmyZvIj297w2vP/Jxz4LAAN90mwfL5sGBiwA/CjIfG4bIxMl0uzohwET6YwN7KnaO+PiWbPOLdV8YckVrDfOG1xx+k3x+lYyobFw9BcggjKRWBnx8YMPvPbMo68kUhs9QJrt42VkuN/Gfftees76PynTGoCr+UJGaMnOJcIHy2ZcB5RmvrDUChalNyhTVdVSV9bSscGEFmDj6KcMg7WnwqP7sX/zIw8AoIYt+9ysvEUsnd/iQP8n5987SJY8sHL1RQ4J2oYGKylyWXNl5axCvtDNXsg7KKmClezvV2DG4uQ1yaqWxTW5XNbZ8waZYaOxmPIHX33mN+kvPSJD+ibG+sJwv3/a+/r3t1r8rpI8xXCzl6UByjCHXYpm3VhVfWMhX+joB/bbK6mC1Z9MWgBeRfP82+FFmdx83wEAmIhhDI68su1eANzT21tSb7xiUhjuF/7Cmq9lNcFzuPkeEqjMMs7wyq4GQD3YVFIfciVTsN7IDV5x3cqK2QuWBn6GidjNRc6WvWhcDw++fHDHj795v+QGJ9a6gQFLAL5w4MgDm0OTjZF2drgfEfSQDWy38k69efbccwnEpXR+YckUrJHcYM3Sc2+MzWwC29C6+fQYgDJexEPu0O6v7979/AHZyjDhrE0m9Y7Mgd1brPl+THlQjg73UwyETHY2mM4lfRcAJEuo+e5ktu6P5XODzc3Ns1RV/dW+75v8Xb17cQtmhopEOTj4erjn8U33AaCBLZ+XYjXBRvKFj3H4X3vIu3IWGD5glGM9awuAiShrTDif+AMN1bFOSqdfTgGqz9GNsW9WEgUrkepRA319tuvqP7+tZv6pVdnMcajoDLxx/KQzCNaGiFXV6H1bf/ObLT9L/yrFrPrIvcLrmnRhuB+93vfE5bPn/e7KSGxZ1gTQTt6lA5YZZ0Si3n+ubv2TW468/P/1JBKqr7DvzGUlUbA29fYY6gPIZBsPb33icTt83DJcnHvFACnrR7U6/srT/w0gbFmfdusj3mHp5BaiNPCICf5HdTR2lwGMdXRbDDNxNRMdZu8UADh/YMDdY6KEEEJMsVQqpZiZSuEPUikH7xBLQwpQDCYGHP/Djg5UEkIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQwnn/F3RhX6HRJE84AAAAAElFTkSuQmCC') center/contain no-repeat;opacity:0.035;pointer-events:none;z-index:0;}.wizard-shell{position:relative;z-index:1;}
.wizard-shell{max-width:640px;margin:0 auto;padding:24px 28px 16px;}
.brand-bar{display:flex;align-items:center;justify-content:flex-start;gap:12px;padding:0 0 10px;border-bottom:none;margin-bottom:10px;}
.brand-logo-wrap{display:flex;align-items:center;gap:0;}
.brand-logo-wrap img.brand-logo{height:60px;width:auto;display:block;object-fit:contain;}
.brand-logo-text{display:flex;flex-direction:column;justify-content:center;}
.brand-logo-text .brand-name{font-weight:800;font-size:0.62em;letter-spacing:0.12em;text-transform:uppercase;color:var(--dark);line-height:1.2;}
.brand-logo-text .brand-name-sub{font-size:0.52em;font-weight:600;letter-spacing:0.06em;color:var(--muted);line-height:1.2;margin-top:1px;}
.brand-sub{font-family:var(--font-heading);font-size:1.4em;color:var(--dark);font-weight:800;letter-spacing:-0.01em;line-height:1.2;}
.progress-bar{display:flex;gap:3px;margin-bottom:18px;overflow:hidden;border-radius:6px;}
.progress-dot{flex:1;background:var(--border);transition:background 0.4s ease;padding:8px 4px;text-align:center;}
.progress-dot .prog-num{display:block;font-size:0.6em;font-weight:800;letter-spacing:0.05em;line-height:1;color:var(--muted);transition:color 0.4s;}
.progress-dot .prog-title{display:block;font-family:var(--font-heading);font-size:0.55em;font-weight:600;color:var(--muted);margin-top:2px;line-height:1.2;transition:color 0.4s;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
.progress-dot.active{background:var(--red);}
.progress-dot.active .prog-num,.progress-dot.active .prog-title{color:#fff;}
.progress-dot.done{background:var(--dark);}
.progress-dot.done .prog-num,.progress-dot.done .prog-title{color:rgba(255,255,255,0.85);}
.step{display:none;animation:fadeUp 0.35s ease;}
.step.active{display:block;}
@keyframes fadeUp{from{opacity:0;transform:translateY(12px);}to{opacity:1;transform:translateY(0);}}
.step-label{font-size:0.7em;font-weight:700;text-transform:uppercase;letter-spacing:0.1em;color:var(--muted);margin-bottom:8px;}
.step-title{font-family:var(--font-heading);font-size:1.6em;font-weight:800;line-height:1.25;margin-bottom:8px;}
.step-desc{font-size:0.9em;color:var(--muted);line-height:1.6;margin-bottom:28px;}
.choices{display:flex;flex-direction:column;gap:10px;}
.choice{display:flex;align-items:center;gap:14px;background:var(--card);border:2px solid var(--border);border-radius:var(--r);padding:16px 18px;cursor:pointer;transition:all 0.2s ease;}
.choice:hover{border-color:var(--dark);}
.choice.selected{border-color:var(--red);background:linear-gradient(135deg, #fdf6f6 0%, #faf8f6 40%, #f5f2ef 100%);}
.choice-icon{width:40px;height:40px;border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:1.2em;flex-shrink:0;background:var(--bg);}
.choice-text{flex:1;}
.choice-text strong{display:block;font-size:0.92em;font-weight:700;}
.choice-text small{font-size:0.78em;color:var(--muted);}
.choice-check{width:22px;height:22px;border-radius:50%;border:2px solid var(--border);flex-shrink:0;display:flex;align-items:center;justify-content:center;transition:all 0.2s;}
.choice.selected .choice-check{background:var(--red);border-color:var(--red);}
.choice.selected .choice-check::after{content:'\2713';color:#fff;font-size:0.7em;font-weight:800;}
.field{margin-bottom:18px;}
.field label{display:block;font-size:0.72em;font-weight:700;text-transform:uppercase;letter-spacing:0.08em;color:var(--muted);margin-bottom:6px;}
.field input,.field select{width:100%;padding:12px 14px;font-size:16px;font-family:inherit;border:2px solid var(--border);border-radius:8px;background:var(--card);transition:border-color 0.2s;box-sizing:border-box;}
.field input:focus,.field select:focus{outline:none;border-color:var(--red);}
.field-row{display:flex;gap:12px;}
.field-row .field{flex:1;}
.field-hint{font-size:0.75em;color:var(--muted);margin-top:4px;}
.field-warning{font-size:0.82em;color:#c0392b;background:#fdf0ef;border:1px solid #f5c6cb;border-radius:6px;padding:8px 12px;margin-top:8px;line-height:1.4;}
.field input[type=range]{-webkit-appearance:none;appearance:none;width:100%;height:6px;border-radius:3px;background:var(--border);border:none;padding:0;cursor:pointer;}
.field input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;width:20px;height:20px;border-radius:50%;background:var(--dark);cursor:pointer;}
.range-labels{display:flex;justify-content:space-between;font-size:0.72em;color:var(--muted);margin-top:4px;}
.range-value{text-align:center;font-size:1.5em;font-weight:800;color:var(--dark);margin-bottom:8px;}
.context-box{background:#f0f4f7;border-left:3px solid var(--blue);border-radius:0 8px 8px 0;padding:14px 16px;margin:20px 0;font-size:0.85em;color:#4a5568;line-height:1.6;}
.context-box strong{color:var(--dark);}
.live-preview{background:var(--card);border:2px solid var(--border);border-radius:var(--r);overflow:hidden;margin-top:24px;transition:all 0.3s ease;}
.live-preview.has-data{border-color:var(--dark);}
.lp-header{background:var(--dark);color:#fff;padding:12px 16px;font-size:0.72em;font-weight:700;text-transform:uppercase;letter-spacing:0.1em;}
.lp-row{display:flex;border-bottom:1px solid var(--border);}
.lp-col{flex:1;padding:14px 16px;text-align:center;}
.lp-col:first-child{border-right:1px solid var(--border);}
.lp-col-label{font-size:0.68em;font-weight:700;text-transform:uppercase;letter-spacing:0.08em;color:var(--muted);margin-bottom:4px;}
.lp-col-value{font-size:1.4em;font-weight:800;}
.lp-col-sub{font-size:0.72em;color:var(--muted);margin-top:2px;}
.lp-delta{padding:12px 16px;text-align:center;font-weight:700;font-size:0.88em;}
.lp-delta.contractor-wins{background:#e8f5ee;color:var(--green);}
.lp-delta.direct-wins{background:#eaf3fa;color:var(--blue);}
.lp-breakeven{padding:8px 16px;text-align:center;font-size:0.75em;color:var(--muted);border-top:1px solid var(--border);}
.nav-row{display:flex;gap:12px;margin-top:18px;}
.btn{flex:1;padding:14px 20px;font-size:0.9em;font-weight:700;font-family:var(--font-heading);border:none;border-radius:50px;cursor:pointer;transition:all 0.2s;text-align:center;}
.btn-primary{background:var(--red);color:#fff;}
.btn-primary:hover{opacity:0.9;}
.btn-secondary{background:var(--card);color:var(--dark);border:2px solid var(--border);}
.btn-secondary:hover{border-color:var(--dark);}
.btn-red{background:var(--red);color:#fff;}
.btn-red:hover{opacity:0.9;}
.btn:disabled{opacity:0.4;cursor:not-allowed;}
.result-cards{display:flex;flex-direction:column;gap:16px;margin-bottom:16px;}
.result-card{flex:1;background:var(--card);border:2px solid var(--border);border-radius:var(--r);overflow:hidden;}
.rc-accent{height:3px;}
.rc-body{padding:18px;}
.rc-label{font-size:0.68em;font-weight:700;text-transform:uppercase;letter-spacing:0.08em;color:var(--muted);margin-bottom:6px;}
.rc-total{font-size:1.6em;font-weight:800;margin-bottom:4px;}
.rc-sub{font-size:0.75em;color:var(--muted);}
.rc-detail{margin-top:12px;padding-top:12px;border-top:1px solid var(--border);}
.rc-line{display:flex;justify-content:space-between;font-size:0.78em;padding:3px 0;color:var(--muted);}
.rc-line.total-line{font-weight:700;color:var(--dark);padding-top:8px;border-top:1px solid var(--border);margin-top:4px;}
.rc-line .green{color:var(--green);}
.verdict-bar{text-align:center;padding:14px 20px;border-radius:var(--r);font-weight:700;margin-bottom:16px;color:#fff;}
.verdict-bar.cw{background:var(--dark);}
.verdict-bar.dw{background:var(--green);}
.verdict-bar .big{font-size:1.05em;}
.verdict-bar .sm{font-size:0.78em;opacity:0.85;margin-top:4px;font-weight:400;}
.recommendation-box{background:#fff;border:1px solid var(--border);border-radius:var(--r);margin-bottom:16px;overflow:hidden;}
.recommendation-box .rec-header{padding:12px 16px;font-weight:700;font-size:0.82em;border-bottom:1px solid var(--border);display:flex;align-items:center;gap:8px;}
.recommendation-box .rec-body{padding:14px 16px;font-size:0.82em;line-height:1.65;color:#444;}
.recommendation-box .rec-body p{margin-bottom:10px;}
.recommendation-box .rec-body p:last-child{margin-bottom:0;}
.recommendation-box .rec-highlight{background:#fef9e7;border-left:3px solid var(--amber);padding:10px 14px;border-radius:0 6px 6px 0;margin:10px 0;font-size:0.95em;}
.recommendation-box .rec-highlight.green{background:#e8f5ee;border-left-color:var(--green);}
.recommendation-box .rec-factors{display:flex;flex-wrap:wrap;gap:8px;margin-top:10px;}
.recommendation-box .rec-factor{background:var(--bg);padding:6px 12px;border-radius:20px;font-size:0.88em;font-weight:600;color:var(--dark);}
.verdict-bar.one-clear{background:var(--amber);}
.verdict-bar.one-clear .sm{opacity:1;font-weight:600;}
.report-cta{background:var(--dark);border-radius:var(--r);padding:24px;border-left:4px solid var(--red);margin-top:20px;}
.fin-stmt{width:100%;border-collapse:collapse;font-size:0.82em;}
.fin-stmt th{text-align:right;padding:8px 12px;font-weight:700;font-size:0.72em;text-transform:uppercase;letter-spacing:0.06em;color:var(--muted);background:#f9f8f7;border-bottom:2px solid var(--border);}
.fin-stmt th:first-child{text-align:left;}
.fin-stmt td{padding:7px 12px;border-bottom:1px solid #f0eeec;text-align:right;color:var(--dark);font-variant-numeric:tabular-nums;}
.fin-stmt td:first-child{text-align:left;color:var(--muted);font-size:0.95em;}
.fin-stmt tr.fin-subtotal td{font-weight:800;border-top:2px solid var(--border);border-bottom:none;background:#faf9f8;padding:9px 12px;}
.fin-stmt tr.fin-subtotal td:first-child{color:var(--dark);}
.fin-stmt tr.fin-section-head td{font-weight:800;color:var(--dark);font-size:0.95em;padding-top:14px;border-bottom:1px solid var(--border);background:#faf9f8;}
.fin-stmt tr.fin-green td{color:var(--green);}
.fin-stmt .fin-pos{color:var(--green);}
.fin-stmt .fin-neg{color:var(--red);}
.report-cta h3{color:#fff;font-size:1.05em;margin-bottom:6px;}
.report-cta p{color:#b4c4d2;font-size:0.83em;line-height:1.6;margin-bottom:14px;}
.email-modal-overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.5);z-index:10000;align-items:flex-start;justify-content:center;padding:20px;overflow-y:auto;}
.email-modal-overlay.open{display:flex;}
.email-modal{background:#fff;border-radius:12px;box-shadow:0 12px 48px rgba(0,0,0,0.25);max-width:460px;width:100%;position:relative;overflow:hidden;margin:auto;}
.email-modal-close{position:absolute;top:12px;right:14px;background:none;border:none;font-size:22px;color:#999;cursor:pointer;z-index:1;}
.email-modal-header{background:var(--dark);color:#fff;padding:24px 28px 20px;border-bottom:3px solid var(--red);}
.email-modal-header h3{font-size:1.1em;font-weight:800;margin:0 0 6px;}
.email-modal-header p{font-size:0.82em;color:#b4c4d2;margin:0;}
.email-modal-body{padding:22px 28px 24px;}
.email-modal-body .hs-form{max-width:100%!important;}
.email-modal-body .hs-form fieldset{max-width:100%!important;margin:0!important;padding:0!important;}
.email-modal-body .hs-form .hs-form-field{margin-bottom:10px!important;}
.email-modal-body .hs-form .hs-form-field>label{font-size:0.75em!important;margin-bottom:3px!important;}
.email-modal-body .hs-form .hs-input{width:100%!important;box-sizing:border-box!important;padding:8px 10px!important;font-size:0.85em!important;border-radius:5px!important;}
.email-modal-body .hs-form textarea.hs-input{min-height:50px!important;}
.email-modal-body .hs-form .hs-richtext{font-size:0.8em!important;}
.email-modal-body .hs-form .legal-consent-container{font-size:0.75em!important;}
.email-modal-body .hs-form .hs-button{background:var(--dark)!important;color:#fff!important;border:none!important;border-radius:50px!important;padding:11px 24px!important;font-size:0.9em!important;font-weight:700!important;cursor:pointer!important;width:100%!important;}
.email-modal-body .hs-form .hs-error-msgs{font-size:0.75em!important;color:var(--red);}
.report-ready-btn{display:inline-block;background:var(--red);color:#fff;padding:14px 28px;border-radius:50px;font-size:1em;font-weight:700;border:none;cursor:pointer;width:100%;text-align:center;}
.report-ready-btn:hover{opacity:0.9;}
.ftr{font-size:0.7em;color:var(--muted);text-align:center;padding:12px 20px;line-height:1.6;}
/* Accordion questions */
.q-section{border:2px solid var(--border);border-radius:10px;margin-bottom:12px;transition:border-color 0.3s;max-width:100%;}
.q-section.completed{border-color:#c5e1c8;}
.q-section.q-open{border-color:var(--blue);}
.q-header{display:flex;align-items:center;gap:10px;padding:14px 16px;cursor:pointer;user-select:none;background:var(--card);transition:background 0.2s;}
.q-header:hover{background:#f8f7f6;}
.q-check{width:24px;height:24px;border-radius:50%;border:2px solid var(--border);flex-shrink:0;display:flex;align-items:center;justify-content:center;transition:all 0.3s;font-size:0.7em;font-weight:800;color:#fff;}
.q-section.completed .q-check{background:#4caf50;border-color:#4caf50;}
.q-section.completed .q-check::after{content:'\2713';}
.q-title{flex:1;font-size:0.88em;font-weight:700;color:var(--dark);}
.q-chevron{font-size:0.7em;color:var(--muted);transition:transform 0.3s;font-weight:700;}
.q-section.q-open .q-chevron{transform:rotate(180deg);}
.q-body{display:none;}
.q-section.q-open .q-body{display:block;}
.q-body-inner{padding:4px 16px 18px;overflow:hidden;max-width:100%;}
.q-confirm{display:inline-block;margin-top:10px;padding:8px 20px;font-size:0.8em;font-weight:700;color:#fff;background:var(--red);border:none;border-radius:50px;cursor:pointer;transition:background 0.2s;}
.q-confirm:hover{background:#c4161d;}
.q-confirm:disabled{background:var(--border);cursor:default;}

@media(min-width:900px){
  .wizard-shell{max-width:740px;padding:16px 40px 12px;}
  .brand-bar{gap:16px;padding:0 0 8px;}
  .brand-logo-wrap img.brand-logo{height:48px;}
  .brand-sub{font-size:1.55em;}
  .progress-bar{margin-bottom:12px;}
  .progress-dot{padding:8px 6px;}
  .progress-dot .prog-num{font-size:0.65em;}
  .progress-dot .prog-title{font-size:0.6em;}
  .step-label{margin-bottom:4px;}
  .step-title{font-size:1.75em;margin-bottom:4px;}
  .step-desc{margin-bottom:18px;}
  .choices{gap:8px;}
  .choice{padding:12px 16px;}
  .nav-row{margin-top:14px;}
  .btn{padding:13px 24px;font-size:0.95em;}
  .ftr{padding:12px 20px;}
}
@media(max-width:768px){
  .brand-bar{flex-direction:row;align-items:center;gap:10px;}
  .progress-bar{gap:1px;}
  .progress-dot{padding:6px 2px;}
  .progress-dot .prog-title{font-size:0.48em;}
  .progress-dot .prog-num{font-size:0.55em;}
}
@media(max-width:520px){
  html,body{overflow-x:hidden;width:100%;}
  .wizard-shell{padding:16px 20px 60px;}
  .step-title{font-size:1.3em;}
  .field-row{flex-direction:column;gap:0;}
  .result-cards{flex-direction:column;}
  .lp-col-value{font-size:1.1em;}
  .email-modal{max-width:100%;border-radius:8px;}
  .email-modal-header{padding:18px 18px 14px;}
  .email-modal-body{padding:16px 18px 18px;}
  .q-header{padding:12px 14px;}
  .q-title{font-size:0.82em;}
  .fin-stmt{min-width:380px;}
  .fin-stmt th,.fin-stmt td{padding:6px 8px;font-size:0.75em;}
  .brand-logo-wrap img.brand-logo{height:30px;width:30px;object-fit:contain;}
  .progress-dot .prog-title{display:none;}
  .progress-dot .prog-num{font-size:0.65em;}
  .progress-dot{padding:8px 4px;}
  .nav-row{flex-direction:column;gap:8px;}
  .nav-row .btn{width:100%;}
  .choices{gap:6px;}
  .choice{padding:10px 12px;}
}
</style>
</head>
<body>

<div class="wizard-shell" id="wizardShell">
  <div class="brand-bar">
    <div class="brand-logo-wrap">
      <img src="data:image/png;base64,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" alt="Main Line Talent Group" class="brand-logo" style="height:44px;width:auto;flex-shrink:0;">
    </div>
    <div class="brand-sub">Workforce Planning Calculator</div>
  </div>
  <div class="progress-bar" id="progressBar">
    <div class="progress-dot active" data-step="1"><span class="prog-num">1</span><span class="prog-title">Role</span></div>
    <div class="progress-dot" data-step="2"><span class="prog-num">2</span><span class="prog-title">Details</span></div>
    <div class="progress-dot" data-step="3"><span class="prog-num">3</span><span class="prog-title">Direct Hire</span></div>
    <div class="progress-dot" data-step="4"><span class="prog-num">4</span><span class="prog-title">Contractor</span></div>
    <div class="progress-dot" data-step="5"><span class="prog-num">5</span><span class="prog-title">Results</span></div>
  </div>

  <!-- STEP 1: Welcome -->
  <div class="step active" id="step1">
    <div class="step-label">Step 1 of 5</div>
    <div class="step-title" style="font-size:1.35em;margin-bottom:4px;">How can we help?</div>
    <div class="step-desc" style="margin-bottom:14px;">This tool calculates the true cost of hiring, including taxes, benefits, recruiting, and ramp time, so you can compare your options with confidence.</div>
    <div class="choices" id="intentChoices" style="gap:8px;">
      <div class="choice" data-val="perm" onclick="selectChoice('intent',this)" style="padding:12px 14px;">
        <div class="choice-icon"><span></span></div>
        <div class="choice-text"><strong>Hiring a permanent employee</strong><small>Full-time W-2 with salary &amp; benefits</small></div>
        <div class="choice-check"></div>
      </div>
      <div class="choice" data-val="contract" onclick="selectChoice('intent',this)" style="padding:12px 14px;">
        <div class="choice-icon"><span></span></div>
        <div class="choice-text"><strong>Engaging a contractor</strong><small>Flexible, project-based engagement</small></div>
        <div class="choice-check"></div>
      </div>
      <div class="choice" data-val="compare" onclick="selectChoice('intent',this)" style="padding:12px 14px;">
        <div class="choice-icon"><span></span></div>
        <div class="choice-text"><strong>Not sure yet. Help me compare</strong><small>See both options side by side</small></div>
        <div class="choice-check"></div>
      </div>
    </div>
    <div class="nav-row"><button class="btn btn-primary" id="btn1next" onclick="goStep(2)" disabled>Continue </button></div>
  </div>

  <!-- STEP 2: Role Details -->
  <div class="step" id="step2">
    <div class="step-label">Step 2 of 5</div>
    <div class="step-title" style="font-size:1.35em;margin-bottom:4px;">Tell us about the role.</div>
    <div class="step-desc" style="margin-bottom:14px;">This information tailors the cost analysis and provides industry-specific insights in your report.</div>

    <div class="q-section q-open" id="q2-industry">
      <div class="q-header" onclick="toggleQ(this)">
        <div class="q-check"></div>
        <div class="q-title">Industry</div>
        <div class="q-chevron"></div>
      </div>
      <div class="q-body"><div class="q-body-inner">
        <div class="field" style="margin-bottom:0;"><label>Industry *</label>
          <select id="wIndustry" onchange="checkStep2();if(this.value)confirmQ('q2-industry','q2-role',function(){return true;})">
            <option value="">Select your industry</option>
            <option>Aerospace & Defense</option><option>Automotive</option><option>Construction & Engineering</option><option>Distribution & Logistics</option><option>Education</option><option>Energy & Utilities</option><option>Financial Services</option><option>Food & Beverage</option><option>Government & Public Sector</option><option>Healthcare</option><option>Manufacturing</option><option>Nonprofit</option><option>Pharma & Life Sciences</option><option>Professional Services</option><option>Real Estate</option><option>Retail & E-commerce</option><option>Technology</option><option>Other</option>
          </select>
        </div>
      </div></div>
    </div>

    <div class="q-section" id="q2-role">
      <div class="q-header" onclick="toggleQ(this)">
        <div class="q-check"></div>
        <div class="q-title">Job Title / Role</div>
        <div class="q-chevron"></div>
      </div>
      <div class="q-body"><div class="q-body-inner">
        <div class="field" style="margin-bottom:0;"><label>Job title *</label>
          <input type="text" id="wRole" placeholder="e.g. Epicor Kinetic Developer, Acumatica Consultant, IT Manager" oninput="checkStep2()">
        </div>
        <button class="q-confirm" onclick="confirmQ('q2-role','q2-state',function(){return $('wRole').value.trim();})">Confirm</button>
      </div></div>
    </div>

    <div class="q-section" id="q2-state">
      <div class="q-header" onclick="toggleQ(this)">
        <div class="q-check"></div>
        <div class="q-title">Worker Location</div>
        <div class="q-chevron"></div>
      </div>
      <div class="q-body"><div class="q-body-inner">
        <div class="field"><label>State of residence *</label>
          <select id="wState" onchange="checkStep2();if(this.value)confirmQ('q2-state','q2-start',function(){return true;})">
            <option value="">Select state</option>
            <option value="AL-2.70-8000-0">Alabama</option><option value="AK-1.00-47600-0">Alaska</option><option value="AZ-2.00-8000-0">Arizona</option><option value="AR-3.10-10000-0">Arkansas</option><option value="CA-3.40-7000-0.01">California</option><option value="CO-1.70-20400-0">Colorado</option><option value="CT-3.00-15000-0">Connecticut</option><option value="DE-1.80-10500-0.0014">Delaware</option><option value="FL-2.70-7000-0">Florida</option><option value="GA-2.64-9500-0">Georgia</option><option value="HI-4.00-51600-0">Hawaii</option><option value="ID-1.00-46500-0">Idaho</option><option value="IL-3.175-12960-0">Illinois</option><option value="IN-2.50-9500-0">Indiana</option><option value="IA-1.00-36100-0">Iowa</option><option value="KS-2.70-14000-0">Kansas</option><option value="KY-2.70-11100-0">Kentucky</option><option value="LA-1.60-7700-0">Louisiana</option><option value="ME-2.17-12000-0">Maine</option><option value="MD-2.30-8500-0">Maryland</option><option value="MA-1.87-15000-0.00756">Massachusetts</option><option value="MI-2.70-9500-0">Michigan</option><option value="MN-1.00-40000-0">Minnesota</option><option value="MS-2.70-14000-0">Mississippi</option><option value="MO-2.51-10500-0">Missouri</option><option value="MT-1.18-40500-0">Montana</option><option value="NE-1.25-9000-0">Nebraska</option><option value="NV-2.95-40600-0">Nevada</option><option value="NH-1.70-14000-0">New Hampshire</option><option value="NJ-2.80-42300-0.003825">New Jersey</option><option value="NM-2.00-30800-0">New Mexico</option><option value="NY-4.025-12500-0">New York</option><option value="NC-1.00-29600-0">North Carolina</option><option value="ND-1.02-40800-0">North Dakota</option><option value="OH-2.70-9000-0">Ohio</option><option value="OK-1.50-25700-0">Oklahoma</option><option value="OR-2.40-52000-0">Oregon</option><option value="PA-3.68-10000-0">Pennsylvania</option><option value="RI-1.10-28200-0.011">Rhode Island</option><option value="SC-2.64-14000-0">South Carolina</option><option value="SD-1.00-15000-0">South Dakota</option><option value="TN-2.70-7000-0">Tennessee</option><option value="TX-2.70-9000-0">Texas</option><option value="UT-2.30-44800-0">Utah</option><option value="VT-1.00-16100-0">Vermont</option><option value="VA-2.50-8000-0">Virginia</option><option value="WA-1.03-72500-0.0058">Washington</option><option value="WV-2.70-12000-0">West Virginia</option><option value="WI-3.05-14000-0">Wisconsin</option><option value="WY-1.00-30100-0">Wyoming</option><option value="DC-2.70-9000-0">Washington DC</option>
          </select>
        </div>
        <div class="field" style="margin-bottom:0;">
          <label style="display:flex;align-items:center;gap:10px;cursor:pointer;text-transform:none;letter-spacing:0;font-size:0.88em;font-weight:600;color:var(--dark);">
            <input type="checkbox" id="wRemote" onchange="onRemoteToggle();if(this.checked)confirmQ('q2-state','q2-start',function(){return true;})" style="width:18px;height:18px;accent-color:var(--dark);cursor:pointer;">
            This role is fully remote
          </label>
          <div id="remoteNotice" style="display:none;font-size:0.78em;color:var(--blue);margin-top:6px;padding:8px 12px;background:#f0f4f7;border-radius:6px;">Costs will be calculated using national averages since the worker location may vary.</div>
        </div>
      </div></div>
    </div>

    <div class="q-section" id="q2-start">
      <div class="q-header" onclick="toggleQ(this)">
        <div class="q-check"></div>
        <div class="q-title">Anticipated Start Date</div>
        <div class="q-chevron"></div>
      </div>
      <div class="q-body"><div class="q-body-inner">
        <div class="field"><label>Expected start date *</label>
          <input type="date" id="wStartDate" onchange="checkStep2();if(this.value)confirmQ('q2-start',null,function(){return $('wStartDate').value;})" style="max-width:240px;">
          <div class="field-hint">Used to allocate costs by calendar year in the comparison</div>
        </div>
      </div></div>
    </div>

    <div class="nav-row">
      <button class="btn btn-secondary" onclick="goStep(1)"> Back</button>
      <button class="btn btn-primary" id="btn2next" onclick="goNextFromStep2()" disabled>Continue </button>
    </div>
  </div>


  <!-- STEP 3: Direct Hire Details -->
  <div class="step" id="step3">
    <div class="step-label" id="step3Label">Step 3 of 5</div>
    <div class="step-title" id="step3Title" style="font-size:1.35em;margin-bottom:4px;">Direct Hire Details</div>
    <div class="step-desc" id="step3Desc" style="margin-bottom:14px;">Enter the compensation details for this full-time W-2 position.</div>

    <div class="q-section q-open" id="q3-salary">
      <div class="q-header" onclick="toggleQ(this)">
        <div class="q-check"></div>
        <div class="q-title">Annual Salary</div>
        <div class="q-chevron"></div>
      </div>
      <div class="q-body"><div class="q-body-inner">
        <div class="field" style="margin-bottom:0;"><label>Annual base salary *</label>
          <input type="text" id="wSalary" placeholder="$100,000" oninput="formatCurrency(this);liveCalc()">
        </div>
        <button class="q-confirm" onclick="confirmQ('q3-salary','q3-recruit',function(){return parseCurrency($('wSalary').value)>0;})">Confirm</button>
      </div></div>
    </div>

    <div class="q-section" id="q3-recruit">
      <div class="q-header" onclick="toggleQ(this)">
        <div class="q-check"></div>
        <div class="q-title">Recruiting Method</div>
        <div class="q-chevron"></div>
      </div>
      <div class="q-body"><div class="q-body-inner">
        <div class="field" style="margin-bottom:12px;"><label>Will a recruiter or staffing agency be used?</label>
          <div class="choices" id="recruitChoices" style="margin-top:8px;">
            <div class="choice" data-val="yes" onclick="selectChoice('recruit',this)" style="padding:12px 14px;"><div class="choice-text"><strong>Yes</strong></div><div class="choice-check"></div></div>
            <div class="choice" data-val="no" onclick="selectChoice('recruit',this);confirmQ('q3-recruit','q3-ramp',function(){return true;})" style="padding:12px 14px;"><div class="choice-text"><strong>No, hiring internally</strong></div><div class="choice-check"></div></div>
          </div>
        </div>
        <div id="recruitFeeBlock" style="display:none;">
          <div class="field" style="margin-bottom:0;"><label>Recruitment Fee Percentage</label>
            <div class="range-value" id="recruitFeeVal">30%</div>
            <input type="range" id="wRecruitFee" min="15" max="50" value="30" oninput="document.getElementById('recruitFeeVal').textContent=this.value+'%';debouncedCalc()">
            <div class="range-labels"><span>15%</span><span>50%</span></div>
            <div class="field-hint">Industry average ranges from 20% to 30% of first-year salary</div>
          </div>
        </div>
        <button class="q-confirm" onclick="confirmQ('q3-recruit','q3-ramp',function(){return wizardData.useRecruiter!==null;})">Confirm</button>
      </div></div>
    </div>


    <div class="q-section" id="q3-ramp">
      <div class="q-header" onclick="toggleQ(this)">
        <div class="q-check"></div>
        <div class="q-title">Ramp-Up Speed</div>
        <div class="q-chevron"></div>
      </div>
      <div class="q-body"><div class="q-body-inner">
        <div class="field" style="margin-bottom:0;">
          <label>Expected time to full productivity *</label>
          <div class="choices" id="rampChoices" style="margin-top:8px;">
            <div class="choice" data-val="fast" onclick="selectChoice('ramp',this);confirmQ('q3-ramp','q3-benefits',function(){return true;})">
              <div class="choice-icon" style="background:#e8f5ee;"><span style="filter:none;"></span></div>
              <div class="choice-text">
                <strong>Fast: minimal onboarding required</strong>
                <small>Experienced hires with clear deliverables. Approximately 4-week ramp.</small>
              </div>
              <div class="choice-check"></div>
            </div>
            <div class="choice" data-val="moderate" onclick="selectChoice('ramp',this);confirmQ('q3-ramp','q3-benefits',function(){return true;})">
              <div class="choice-icon" style="background:#fef9e7;"><span style="filter:none;"></span></div>
              <div class="choice-text">
                <strong>Moderate: some learning curve</strong>
                <small>Some process and systems knowledge required. Approximately 10-week ramp.</small>
              </div>
              <div class="choice-check"></div>
            </div>
            <div class="choice" data-val="significant" onclick="selectChoice('ramp',this);confirmQ('q3-ramp','q3-benefits',function(){return true;})">
              <div class="choice-icon" style="background:#fef0e6;"><span style="filter:none;"></span></div>
              <div class="choice-text">
                <strong>Significant: requires learning your processes</strong>
                <small>Cross-departmental or client-facing roles. Approximately 16-week ramp.</small>
              </div>
              <div class="choice-check"></div>
            </div>
            <div class="choice" data-val="extended" onclick="selectChoice('ramp',this);confirmQ('q3-ramp','q3-benefits',function(){return true;})">
              <div class="choice-icon" style="background:#fde8e8;"><span style="filter:none;"></span></div>
              <div class="choice-text">
                <strong>Extended: deep organizational knowledge required</strong>
                <small>Leadership or roles requiring institutional expertise. Approximately 26-week ramp.</small>
              </div>
              <div class="choice-check"></div>
            </div>
          </div>
        </div>
      </div></div>
    </div>

    <div class="q-section" id="q3-benefits">
      <div class="q-header" onclick="toggleQ(this)">
        <div class="q-check"></div>
        <div class="q-title">Additional Benefits <span style="font-weight:400;color:var(--muted);font-size:0.85em;">(Optional)</span></div>
        <div class="q-chevron"></div>
      </div>
      <div class="q-body"><div class="q-body-inner">
        <div class="field" style="margin-bottom:14px;">
          <label>401(k) Employer Match</label>
          <div style="display:flex;gap:8px;align-items:center;margin-top:6px;">
            <input type="text" id="w401kPct" value="3" style="width:70px;text-align:center;padding:10px 8px;" oninput="liveCalc()">
            <span style="font-size:0.85em;color:var(--muted);">% of salary</span>
          </div>
          <div class="field-hint">Default is 3%. Enter 0 if no employer match is offered.</div>
        </div>

        <div class="field" style="margin-bottom:14px;">
          <label>Bonus / Incentive Compensation</label>
          <select id="wBonusType" onchange="onBonusTypeChange();liveCalc()" style="margin-top:6px;">
            <option value="none">No bonus</option>
            <option value="onetime">One-time (e.g. sign-on)</option>
            <option value="quarterly">Quarterly bonus</option>
            <option value="annual">Annual bonus</option>
          </select>
        </div>

        <div id="bonusDetailBlock" style="display:none;">
          <div style="display:flex;gap:8px;align-items:flex-end;margin-bottom:6px;">
            <div class="field" style="flex:1;margin-bottom:0;">
              <label>Bonus Amount</label>
              <input type="text" id="wBonusAmt" placeholder="5,000" oninput="formatCurrency(this);liveCalc()">
            </div>
            <div class="field" style="width:90px;margin-bottom:0;">
              <label>Type</label>
              <select id="wBonusUnit" onchange="liveCalc()">
                <option value="dollar">$</option>
                <option value="percent">%</option>
              </select>
            </div>
          </div>
          <div class="field-hint" id="bonusHint">Enter the bonus amount.</div>
        </div>

        <button class="q-confirm" onclick="confirmQ('q3-benefits',null,function(){return true;})">Confirm</button>
      </div></div>
    </div>

    <div class="nav-row">
      <button class="btn btn-secondary" onclick="goBackFromStep3()"> Back</button>
      <button class="btn btn-primary" id="btn3next" onclick="goNextFromStep3()" disabled>Continue </button>
    </div>
  </div>

  <!-- STEP 4: Contractor Details -->
  <div class="step" id="step4">
    <div class="step-label" id="step4Label">Step 4 of 5</div>
    <div class="step-title" id="step4Title" style="font-size:1.35em;margin-bottom:4px;">Contractor Details</div>
    <div class="step-desc" id="step4Desc" style="margin-bottom:14px;">What would the contractor engagement look like for this role?</div>

    <div class="q-section q-open" id="q4-rate">
      <div class="q-header" onclick="toggleQ(this)">
        <div class="q-check"></div>
        <div class="q-title">Bill Rate</div>
        <div class="q-chevron"></div>
      </div>
      <div class="q-body"><div class="q-body-inner">
        <div class="field" style="margin-bottom:0;"><label>Contractor bill rate (per hour) *</label>
          <input type="text" id="wRate" placeholder="$200" oninput="formatCurrency(this);liveCalc()">
          <div class="field-hint">Hourly rate charged by the contractor or staffing agency</div>
        </div>
        <button class="q-confirm" onclick="confirmQ('q4-rate','q4-length',function(){return parseCurrency($('wRate').value)>0;})">Confirm</button>
      </div></div>
    </div>

    <div class="q-section" id="q4-length">
      <div class="q-header" onclick="toggleQ(this)">
        <div class="q-check"></div>
        <div class="q-title">Engagement Length</div>
        <div class="q-chevron"></div>
      </div>
      <div class="q-body"><div class="q-body-inner">
        <div class="field" style="margin-bottom:0;">
          <label>Engagement duration</label>
          <div class="range-value" id="monthsVal">12 months</div>
          <input type="range" id="wMonths" min="1" max="36" value="12" oninput="$('monthsVal').textContent=this.value+(this.value==='1'?' month':' months');debouncedCalc()">
          <div class="range-labels"><span>1 month</span><span>36 months</span></div>
        </div>
        <button class="q-confirm" onclick="confirmQ('q4-length','q4-billing',function(){return true;})">Confirm</button>
      </div></div>
    </div>

    <div class="q-section" id="q4-billing">
      <div class="q-header" onclick="toggleQ(this)">
        <div class="q-check"></div>
        <div class="q-title">Rate &amp; Billing Model</div>
        <div class="q-chevron"></div>
      </div>
      <div class="q-body"><div class="q-body-inner">
        <div class="field"><label>How many hours per week?</label>
          <div class="range-value" id="hoursVal">20 hrs/wk</div>
          <input type="range" id="wHours" min="10" max="60" value="20" oninput="$('hoursVal').textContent=this.value+' hrs/wk';checkHoursWarning();debouncedCalc()">
          <div class="range-labels"><span>10 hrs</span><span>60 hrs</span></div>
        </div>
        <div id="hoursWarning" class="field-warning" style="display:none;"> Weekly hours are lower than guaranteed retainer hours. You'll be paying for hours not used.</div>
        <div class="field"><label>How will the contractor be billed?</label>
          <select id="wBillingMode" onchange="onBillingChange();liveCalc()">
            <option value="hourly">Hourly (pay for hours used)</option>
            <option value="retainer">Retainer (guaranteed commitment)</option>
          </select>
        </div>

        <div id="retainerOptions" style="display:none;">
          <div class="field"><label>Retainer Period</label>
            <select id="wRetainerFreq" onchange="onRetainerFreqChange();liveCalc()">
              <option value="weekly">Weekly Retainer</option>
              <option value="monthly">Monthly Retainer</option>
            </select>
          </div>
          <div class="field"><label id="retainerHoursLabel">Guaranteed Hours per Week</label>
            <div class="range-value" id="minHoursVal">20 hrs</div>
            <input type="range" id="wMinHours" min="10" max="60" value="20" oninput="document.getElementById('minHoursVal').textContent=this.value+' hrs';checkHoursWarning();debouncedCalc()">
            <div class="range-labels"><span>10 hrs</span><span>60 hrs</span></div>
          </div>
          <div class="field"><label>Retainer Discount Type</label>
            <select id="wDiscountType" onchange="updateDiscountSlider();liveCalc()">
              <option value="dollar">$ per hour off bill rate</option>
              <option value="percent">% off bill rate</option>
            </select>
          </div>
          <div class="field" style="margin-bottom:0;"><label id="discountLabel">Discount Amount</label>
            <div class="range-value" id="discountVal">$10/hr</div>
            <input type="range" id="wDiscountAmt" min="0" max="20" value="10" oninput="updateDiscountDisplay();debouncedCalc()">
            <div class="range-labels"><span id="discountMin">$0</span><span id="discountMax">$20/hr</span></div>
            <div class="field-hint">Discount applied to the hourly rate for guaranteed commitment</div>
          </div>
        </div>
        <button class="q-confirm" onclick="confirmQ('q4-billing',null,function(){return true;})">Confirm</button>
      </div></div>
    </div>

    <div class="nav-row">
      <button class="btn btn-secondary" id="btn4back" onclick="goBackFromStep4()"> Back</button>
      <button class="btn btn-primary" id="btn4next" onclick="goNextFromStep4()" disabled>See Full Results </button>
    </div>
  </div>

  <!-- STEP 5: Results -->
  <div class="step" id="step5">
    <div class="step-label">Step 5 of 5</div>
    <div class="step-title" style="font-size:1.35em;margin-bottom:4px;">Your Cost Comparison</div>
    <div class="step-desc" style="margin-bottom:14px;">Complete breakdown for <strong id="resultRoleLabel"></strong>.</div>
    <div id="verdictBarContainer"></div>
    <div id="recommendationContainer"></div>
    <div class="result-cards" id="resultCards"></div>

    <div class="report-cta">
      <h3>Get the Full Report</h3>
      <p>Generate a branded PDF report with PESTLE industry analysis, risk assessment, strategic recommendations, and actionable next steps tailored to your scenario.</p>
      <button class="btn btn-red" onclick="generateReport()" style="width:100%;">Generate PDF Report </button>
    </div>
    <div class="nav-row">
      <button class="btn btn-secondary" onclick="goBackFromStep5()"> Adjust Numbers</button>
    </div>
  </div>
</div>

<!-- Email modal -->
<div class="email-modal-overlay" id="emailModal">
  <div class="email-modal">
    <button class="email-modal-close" onclick="closeEmailModal()"></button>
    <div class="email-modal-header">
      <h3>Where Should We Send Your Report?</h3>
      <p>Enter your details and your personalized report will be ready instantly.</p>
    </div>
    <div class="email-modal-body"><div id="hsFormContainer"></div></div>
  </div>
</div>

<footer class="ftr">Main Line Talent Group &nbsp;&nbsp; For planning purposes only. Not a substitute for professional HR, financial, or legal counsel. &nbsp;&nbsp; Based on 2025 national benchmarks.</footer>

<script>
const $ = id => document.getElementById(id);
const fmtD = n => '$' + Math.round(n).toLocaleString();
const fmtHr = n => '$' + n.toFixed(2) + '/hr';

//  Wizard State 
var currentStep = 1;
var wizardData = { intent:'', industry:'', role:'', stateVal:'', salary:0, rate:0, months:12, hours:40, useRecruiter:null, recruitFee:30, billingMode:'hourly', minHours:30, rampLevel:null };
var _lastCalc = null;
var _snap = {};

//  Navigation 
// Step order depends on intent:
//   perm:     123(DH)4(CT)5
//   contract: 124(CT)3(DH)5
//   compare:  123(DH)4(CT)5

function stepOrder() {
  if (wizardData.intent==='contract') return [1,2,4,3,5];
  return [1,2,3,4,5]; // perm + compare
}

function goStep(n) {
  if (n===3) setupStep3();
  if (n===4) setupStep4();
  if (n===5) buildResults();
  $('step'+currentStep).classList.remove('active');
  $('step'+n).classList.add('active');
  currentStep = n;
  // Update progress based on position in order
  var order = stepOrder();
  var pos = order.indexOf(n);
  var flowTitles = ['Role','Details','Direct Hire','Contractor','Results'];
  // If contractor flow, swap steps 3 & 4 titles
  if (order[2]===4) { flowTitles[2]='Contractor'; flowTitles[3]='Direct Hire'; }
  document.querySelectorAll('.progress-dot').forEach(function(d,i){
    d.className='progress-dot'+(i<pos?' done':i===pos?' active':'');
    d.querySelector('.prog-title').textContent=flowTitles[i];
  });
  // Update step labels to reflect flow position
  if (n===3 && $('step3Label')) $('step3Label').textContent = 'Step ' + (pos+1) + ' of 5';
  if (n===4 && $('step4Label')) $('step4Label').textContent = 'Step ' + (pos+1) + ' of 5';
  window.scrollTo({top:0,behavior:'smooth'});
}

function goNextFromStep2() {
  // Validate all required fields before advancing
  if(!wizardData.industry||!wizardData.role||(!wizardData.stateVal&&!($('wRemote')&&$('wRemote').checked))||!wizardData.startDate){
    checkStep2(); return;
  }
  var order = stepOrder();
  goStep(order[2]);
}
function goNextFromStep3() {
  // Validate salary is reasonable
  var sal=parseCurrency($('wSalary')?$('wSalary').value:'0');
  if(sal<=0){$('wSalary').style.borderColor='var(--red)';$('wSalary').focus();return;}
  if(sal>10000000){$('wSalary').style.borderColor='var(--red)';$('wSalary').focus();return;}
  $('wSalary').style.borderColor='';
  var order = stepOrder();
  var pos = order.indexOf(3);
  goStep(order[pos + 1]);
}
function goNextFromStep4() {
  // Validate rate is reasonable
  var rt=parseCurrency($('wRate')?$('wRate').value:'0');
  if(rt<=0){$('wRate').style.borderColor='var(--red)';$('wRate').focus();return;}
  if(rt>5000){$('wRate').style.borderColor='var(--red)';$('wRate').focus();return;}
  $('wRate').style.borderColor='';
  var order = stepOrder();
  var pos = order.indexOf(4);
  goStep(order[pos + 1]);
}
function goBackFromStep3() {
  var order = stepOrder();
  var pos = order.indexOf(3);
  goStep(order[pos - 1]);
}
function goBackFromStep4() {
  var order = stepOrder();
  var pos = order.indexOf(4);
  goStep(order[pos - 1]);
}
function goBackFromStep5() {
  var order = stepOrder();
  goStep(order[3]); // 4th position in flow (index 3), the last data entry step
}

// Contextual titles based on whether this is the user's primary or comparison step
function setupStep3() {
  var role = wizardData.role || 'this role';
  var order = stepOrder();
  var pos = order.indexOf(3);
  var isLastDataStep = (pos === 3); // position 4 in flow (index 3) = last before results
  if (wizardData.intent==='contract') {
    $('step3Title').textContent = "Direct hire comparison";
    $('step3Desc').textContent = "For an accurate comparison, the following details are needed to calculate the full cost of hiring " + role + " as a full-time W-2 employee.";
  } else if (wizardData.intent==='perm') {
    $('step3Title').textContent = "Direct hire details for " + role;
    $('step3Desc').textContent = "Enter the compensation details for this full-time W-2 position.";
  } else {
    $('step3Title').textContent = "Direct hire details for " + role;
    $('step3Desc').textContent = "Enter the compensation details to calculate the full cost of a W-2 hire.";
  }
  // Update button label based on flow position
  $('btn3next').textContent = isLastDataStep ? 'See Full Results ' : 'Continue ';
  liveCalc();
}

function setupStep4() {
  var role = wizardData.role || 'this role';
  var order = stepOrder();
  var pos = order.indexOf(4);
  var isLastDataStep = (pos === 3);
  if (wizardData.intent==='contract') {
    $('step4Title').textContent = "Contractor details for " + role;
    $('step4Desc').textContent = "Enter the details for this contractor engagement.";
  } else if (wizardData.intent==='perm') {
    $('step4Title').textContent = "Contractor comparison";
    $('step4Desc').textContent = "For an accurate comparison, the following details are needed to calculate the cost of engaging " + role + " as a contractor.";
  } else {
    $('step4Title').textContent = "Contractor details for " + role;
    $('step4Desc').textContent = "Enter the contractor engagement details for a side-by-side comparison.";
  }
  // Update button label based on flow position
  $('btn4next').textContent = isLastDataStep ? 'See Full Results ' : 'Continue ';
  liveCalc();
}

//  Choice Selection 
// Accordion question system
function toggleQ(headerEl){
  var section=headerEl.parentElement;
  section.classList.toggle('q-open');
}
function openQ(id){
  var el=$(id);if(!el)return;
  // close all siblings
  el.parentElement.querySelectorAll('.q-section').forEach(function(s){s.classList.remove('q-open');});
  el.classList.add('q-open');
  setTimeout(function(){el.scrollIntoView({behavior:'smooth',block:'nearest'});},100);
}
function markQ(id,hasValue){
  var el=$(id);if(!el)return;
  if(hasValue){el.classList.add('completed');}else{el.classList.remove('completed');}
}
function autoAdvanceQ(inputEl,nextId){
  if(inputEl.value){setTimeout(function(){openQ(nextId);},200);}
}
function confirmQ(currentId,nextId,validateFn){
  if(validateFn && !validateFn()) return;
  markQ(currentId,true);
  setTimeout(function(){
    var el=$(currentId);if(el)el.classList.remove('q-open');
    if(nextId){setTimeout(function(){openQ(nextId);},200);}
  },400);
}

function selectChoice(group, el) {
  el.parentElement.querySelectorAll('.choice').forEach(function(c){c.classList.remove('selected');});
  el.classList.add('selected');
  var val=el.dataset.val;
  if(group==='intent'){wizardData.intent=val;$('btn1next').disabled=false;}
  if(group==='recruit'){
    wizardData.useRecruiter=val!=='no';
    $('recruitFeeBlock').style.display=val!=='no'?'block':'none';
    if(val==='yes'){var rfe=$('wRecruitFee');if(rfe)rfe.value=30;var rfv=$('recruitFeeVal');if(rfv)rfv.textContent='30%';wizardData.recruitFee=30;}
    liveCalc();
  }
  if(group==='ramp'){
    wizardData.rampLevel=val;
    liveCalc();
  }
}

function checkStep2() {
  wizardData.industry=$('wIndustry').value;
  wizardData.role=$('wRole').value.trim();
  wizardData.startDate=$('wStartDate')?$('wStartDate').value:'';
  var isRemote=$('wRemote')&&$('wRemote').checked;
  if(!isRemote) wizardData.stateVal=$('wState').value;
  var stateOk=isRemote||wizardData.stateVal;
  $('btn2next').disabled=!(wizardData.industry&&wizardData.role&&stateOk&&wizardData.startDate);
}

function parseCurrency(v){if(!v)return 0;var n=parseInt(String(v).replace(/[^0-9]/g,''));return isNaN(n)||n<0?0:n;}
function formatCurrency(el){var v=parseCurrency(el.value);if(v>0){el.value='$'+v.toLocaleString();el.style.borderColor='';}else if(el.value.trim()&&el.value!=='$'){el.style.borderColor='var(--red)';}}
function onBillingChange(){
  var mode=$('wBillingMode').value;
  var isRetainer=mode==='retainer';
  $('retainerOptions').style.display=isRetainer?'block':'none';
  checkHoursWarning();
}
function onRetainerFreqChange(){
  var freq=$('wRetainerFreq').value;
  $('retainerHoursLabel').textContent=freq==='weekly'?'Guaranteed Hours per Week':'Guaranteed Hours per Month';
  var slider=$('wMinHours');
  if(freq==='monthly'){slider.max=160;$('minHoursVal').textContent=slider.value+' hrs';document.querySelector('#wMinHours ~ .range-labels span:last-child').textContent='160 hrs';}
  else{slider.max=60;if(parseInt(slider.value)>60)slider.value=40;$('minHoursVal').textContent=slider.value+' hrs';document.querySelector('#wMinHours ~ .range-labels span:last-child').textContent='60 hrs';}
  checkHoursWarning();
}
function updateDiscountSlider(){
  var isDollar=$('wDiscountType').value==='dollar';
  var slider=$('wDiscountAmt');
  if(isDollar){slider.max=20;slider.value=Math.min(parseInt(slider.value),20);$('discountMin').textContent='$0';$('discountMax').textContent='$20/hr';}
  else{slider.max=20;slider.value=Math.min(parseInt(slider.value),20);$('discountMin').textContent='0%';$('discountMax').textContent='20%';}
  updateDiscountDisplay();
}
function updateDiscountDisplay(){
  var isDollar=$('wDiscountType').value==='dollar';
  var val=$('wDiscountAmt').value;
  $('discountVal').textContent=isDollar?'$'+val+'/hr':val+'%';
}
function checkHoursWarning(){
  var warn=$('hoursWarning');
  if(!warn) return;
  var isRetainer=$('wBillingMode')&&$('wBillingMode').value==='retainer';
  var weekly=parseInt($('wHours')?$('wHours').value:20)||20;
  var guaranteed=parseInt($('wMinHours')?$('wMinHours').value:30)||30;
  var freq=$('wRetainerFreq')?$('wRetainerFreq').value:'weekly';
  var guaranteedWeekly=freq==='monthly'?Math.round(guaranteed/4.33):guaranteed;
  warn.style.display=(isRetainer&&weekly<guaranteedWeekly)?'block':'none';
}
function onRemoteToggle(){
  var isRemote=$('wRemote').checked;
  $('remoteNotice').style.display=isRemote?'block':'none';
  if(isRemote){
    $('wState').value='';
    $('wState').disabled=true;
    $('wState').style.opacity='0.4';
    wizardData.stateVal='AVG-2.50-10000-0';
  } else {
    $('wState').disabled=false;
    $('wState').style.opacity='1';
    wizardData.stateVal=$('wState').value;
  }
  checkStep2();
}



function onBonusTypeChange(){
  var t=$('wBonusType').value;
  var block=$('bonusDetailBlock');
  var hint=$('bonusHint');
  if(t==='none'){block.style.display='none';return;}
  block.style.display='block';
  if(t==='onetime') hint.textContent='One-time bonus paid at hire, such as a sign-on bonus.';
  else if(t==='quarterly') hint.textContent='Enter the per-quarter bonus amount.';
  else hint.textContent='Enter the annual bonus amount.';
}

//  Calculation Engine 
var SS_RATE=0.062,SS_CAP=168600,MED_RATE=0.0145,FUTA=0.006;
var PTO_PCT=0.0365,HEALTH=13100,IT_ANNUAL=2200;
var WORK_HRS=2080,WKS_YR=52;

// Graduated ramp curve: linear ramp from startProd to 100% over rampWks
// Cost = (salary/hr)  (rampWks  40)  (1 - startProd) / 2
// The /2 accounts for the linear improvement (triangle area)
var RAMP_TIERS = {
  fast:        { wks:4,  start:0.70, label:'Fast ramp: 4 weeks' },
  moderate:    { wks:10, start:0.45, label:'Moderate ramp: 10 weeks' },
  significant: { wks:16, start:0.25, label:'Significant ramp: 16 weeks' },
  extended:    { wks:26, start:0.15, label:'Extended ramp: 26 weeks' }
};

function getRampBand(salary, level) {
  var tier = RAMP_TIERS[level] || RAMP_TIERS['moderate'];
  return tier;
}
function parseStateVal(val){if(!val)return{suta:0.027,base:8000,extra:0};var p=val.split('-');if(p.length>=4){return{suta:parseFloat(p[1])/100,base:parseInt(p[2]),extra:parseFloat(p[3])||0};}return{suta:parseFloat(p[0])/100,base:parseInt(p[1]),extra:parseFloat(p[2])||0};}
function getStateLabel(val){if(val==='AVG-2.50-10000-0')return'Remote (National Average)';var sel=$('wState');for(var i=0;i<sel.options.length;i++){if(sel.options[i].value===val)return sel.options[i].textContent;}return '';}

function computeCosts(salary,rate,months,hours,minHrs,mode,stateVal,useRecruiter,recruitFee,customDiscount,rampLevel,k401Pct,bonusType,bonusAmt,bonusUnit){
  var sd=parseStateVal(stateVal), moFrac=months/12, engWks=months*(WKS_YR/12);
  var ssAmt=Math.min(salary,SS_CAP)*SS_RATE, medAmt=salary*MED_RATE;
  var futaAmt=Math.min(salary,7000)*FUTA, sutaAmt=Math.min(salary,sd.base)*sd.suta;
  var extraAmt=salary*sd.extra, annualTax=ssAmt+medAmt+futaAmt+sutaAmt+extraAmt;
  var kPct=(typeof k401Pct==='number')?k401Pct/100:0.03;
  var taxTotal=annualTax*moFrac, k401=salary*kPct*moFrac, ptoAmt=salary*PTO_PCT*moFrac;
  var healthAmt=HEALTH*moFrac, itAmt=IT_ANNUAL*moFrac;
  var recruitAmt=useRecruiter?salary*(recruitFee/100):0;
  var ramp=getRampBand(salary, rampLevel);
  // Graduated ramp cost: linear from startProd to 100%
  // Lost productivity = (1 - startProd) / 2 (triangle average)
  var rampCost=(salary/WORK_HRS)*(ramp.wks*40)*((1-ramp.start)/2);
  var salaryPro=salary*moFrac;
  var bonusCost=0;
  if(bonusType&&bonusType!=='none'){
    var bAmt=(bonusUnit==='percent')?(salary*(bonusAmt/100)):bonusAmt;
    if(bonusType==='onetime') bonusCost=bAmt;
    else if(bonusType==='quarterly') bonusCost=bAmt*(months/3);
    else if(bonusType==='annual') bonusCost=bAmt*moFrac;
  }
  var dTotal=salaryPro+taxTotal+healthAmt+k401+ptoAmt+itAmt+recruitAmt+rampCost+bonusCost;
  var dEhr=(hours*engWks>0)?dTotal/(hours*engWks):0;

  var discountPerHr=customDiscount||0;
  var effectiveRate=Math.max(rate-discountPerHr,0);

  var cTotal=0;
  if(mode==='hourly'){cTotal=effectiveRate*hours*engWks;}
  else if(mode==='weekly'){var minWk=effectiveRate*minHrs;var overWk=hours>minHrs?effectiveRate*(hours-minHrs):0;cTotal=(minWk+overWk)*engWks;}
  else{var ret=effectiveRate*minHrs;var hpm=hours*(WKS_YR/12);var ov=hpm>minHrs?effectiveRate*(hpm-minHrs):0;cTotal=(ret+ov)*months;}
  var cEhr=hours*engWks>0?cTotal/(hours*engWks):effectiveRate;

  var oneTimeBonusPart=(bonusType==='onetime')?bonusCost:0;
  var recurringBonusMo=(bonusType&&bonusType!=='none'&&bonusType!=='onetime')?(bonusCost/months):0;
  var oneTime=recruitAmt+rampCost+itAmt+oneTimeBonusPart;
  var dMo=(salaryPro+taxTotal+healthAmt+k401+ptoAmt+recurringBonusMo*months)/months;
  var cMo=cTotal/months;
  var prem=cMo-dMo;
  var xMo=prem>0?Math.max(2,Math.ceil(oneTime/prem)):999;

  var cHeading=mode==='hourly'?'Contractor: Hourly':mode==='weekly'?'Contractor: Weekly Retainer':'Contractor: Monthly Retainer';

  return{dTotal:dTotal,salaryPro:salaryPro,taxTotal:taxTotal,healthAmt:healthAmt,k401:k401,k401Pct:kPct*100,ptoAmt:ptoAmt,itAmt:itAmt,recruitAmt:recruitAmt,rampCost:rampCost,rampLabel:ramp.label,bonusCost:bonusCost,bonusType:bonusType||'none',dEhr:dEhr,cTotal:cTotal,cEhr:cEhr,effectiveRate:effectiveRate,discountPerHr:discountPerHr,delta:dTotal-cTotal,xMo:xMo,cHeading:cHeading};
}

//  Live Calc 
// Debounce helper for slider/input performance
var _calcTimer=null;
function debouncedCalc(){clearTimeout(_calcTimer);_calcTimer=setTimeout(liveCalc,60);}

function liveCalc(){
  var salEl=$('wSalary'), rtEl=$('wRate');
  var salary=salEl?parseCurrency(salEl.value):0;
  var rate=rtEl?parseCurrency(rtEl.value):0;
  if(salary<0)salary=0; if(rate<0)rate=0;
  var months=Math.max(1,Math.min(60,parseInt($('wMonths')?$('wMonths').value:12)||12));
  var hours=Math.max(1,Math.min(80,parseInt($('wHours')?$('wHours').value:20)||20));
  var billingMode=$('wBillingMode')?$('wBillingMode').value:'hourly';
  var minHrs=$('wMinHours')?Math.max(0,parseInt($('wMinHours').value)||20):20;
  var recruitFee=$('wRecruitFee')?parseInt($('wRecruitFee').value)||30:30;

  var mode=billingMode;
  if(billingMode==='retainer'){
    var freq=$('wRetainerFreq')?$('wRetainerFreq').value:'weekly';
    mode=freq;
  }

  var customDiscount=0;
  if(billingMode==='retainer'){
    var dType=$('wDiscountType')?$('wDiscountType').value:'dollar';
    var dAmt=parseFloat($('wDiscountAmt')?$('wDiscountAmt').value:0)||0;
    if(dType==='percent') customDiscount=rate*(dAmt/100);
    else customDiscount=dAmt;
  }

  wizardData.salary=salary;wizardData.rate=rate;wizardData.months=months;
  wizardData.hours=hours;wizardData.billingMode=mode;wizardData.minHours=minHrs;
  wizardData.recruitFee=recruitFee;

  // Step 3 (DH): enable Continue if salary entered and recruiter answered
  if(currentStep===3) {
    var canProceed = salary > 0 && wizardData.useRecruiter !== null && wizardData.rampLevel !== null;
    $('btn3next').disabled = !canProceed;
  }

  // Step 4 (CT): enable next button if rate entered
  if(currentStep===4) {
    $('btn4next').disabled = !rate;
    if(salary && rate) {
      var k401Pct=parseFloat($('w401kPct')?$('w401kPct').value:3)||0;
      var bonusType=$('wBonusType')?$('wBonusType').value:'none';
      var bonusAmt=parseCurrency($('wBonusAmt')?$('wBonusAmt').value:'0');
      var bonusUnit=$('wBonusUnit')?$('wBonusUnit').value:'dollar';
      var c = computeCosts(salary, rate, months, hours, minHrs, mode, wizardData.stateVal, wizardData.useRecruiter, recruitFee, customDiscount, wizardData.rampLevel, k401Pct, bonusType, bonusAmt, bonusUnit);
      _lastCalc = c;
      _snap={role:wizardData.role||'Not specified',industry:wizardData.industry,salary:salary,rate:rate,months:months,hrs:hours,minHrs:minHrs,mode:mode,stateLabel:getStateLabel(wizardData.stateVal),startDate:wizardData.startDate,dTotal:c.dTotal,dAnnual:c.dTotal*(12/months),salaryPro:c.salaryPro,taxTotal:c.taxTotal,healthAmt:c.healthAmt,k401:c.k401,ptoAmt:c.ptoAmt,itAmt:c.itAmt,recruitAmt:c.recruitAmt,rampCost:c.rampCost,bonusCost:c.bonusCost,bonusType:c.bonusType,k401Pct:c.k401Pct,dEhr:c.dEhr,rampLabel:c.rampLabel,cTotal:c.cTotal,cEhr:c.cEhr,cHeading:c.cHeading,delta:c.delta,xMo:c.xMo,effectiveRate:c.effectiveRate,discountPerHr:c.discountPerHr};
    }
  }
}

//  Build Results (Step 5) 
function buildResults(){
  if(!_lastCalc)return;
  var c=_lastCalc, s=_snap;
  $('resultRoleLabel').textContent=s.role+' | '+s.industry;

  // Verdict + Recommendation
  var vb=$('verdictBarContainer');
  var rec=$('recommendationContainer');
  var contractorWins=c.delta>0;
  var savingsAmt=fmtD(Math.abs(c.delta));
  var pctSavings=Math.round(Math.abs(c.delta)/Math.max(c.dTotal,c.cTotal)*100);
  var noCrossover=c.xMo>=48||c.xMo===999;
  var winner=contractorWins?'Contractor':'Direct Hire';
  var loser=contractorWins?'Direct Hire':'Contractor';
  var months=s.months;

  // Verdict bar
  if(c.delta===0){
    vb.innerHTML='<div class="verdict-bar cw"><div class="big">Costs are approximately equal</div><div class="sm">Either option delivers similar total cost over this engagement.</div></div>';
  } else if(noCrossover){
    vb.innerHTML='<div class="verdict-bar one-clear"><div class="big">'+winner+' is the clear financial choice, saving '+savingsAmt+' ('+pctSavings+'%)</div><div class="sm">No realistic break-even point within a standard planning horizon (48+ months)</div></div>';
  } else if(contractorWins){
    vb.innerHTML='<div class="verdict-bar cw"><div class="big">Contractor saves '+savingsAmt+' over this engagement</div><div class="sm">Break-even at approximately month '+c.xMo+'</div></div>';
  } else {
    vb.innerHTML='<div class="verdict-bar dw"><div class="big">Direct hire saves '+savingsAmt+' over this engagement</div><div class="sm">Break-even at approximately month '+c.xMo+'</div></div>';
  }

  // Recommendation section
  var recHtml='<div class="recommendation-box"><div class="rec-header"> Our Recommendation</div><div class="rec-body">';

  if(noCrossover){
    // One clearly dominant option
    recHtml+='<div class="rec-highlight green"><strong>From a purely financial standpoint, '+winner.toLowerCase()+' is the only cost-effective option for this scenario.</strong> The '+loser.toLowerCase()+' model costs '+savingsAmt+' more ('+pctSavings+'%), and the break-even point exceeds 48 months, well beyond any reasonable planning horizon. There is no engagement length at which '+loser.toLowerCase()+' becomes the less expensive choice.</div>';
    recHtml+='<p>That said, cost is only one factor in a workforce decision. '+(contractorWins
      ? 'Organizations often choose direct hire despite higher cost for reasons that do not appear on a spreadsheet: building institutional knowledge, strengthening team culture, reducing turnover disruption, protecting intellectual property, and investing in long-term capability. If this role is core to your operations or represents a strategic bet on your organization\'s future, the premium may be justified.'
      : 'Organizations often engage contractors despite higher cost for strategic reasons: speed to start (contractors can typically begin in days, not weeks), access to specialized expertise that does not exist internally, the ability to scale up or down with project demand, and avoiding the long-term commitment of a permanent hire when the need may be temporary.')
    +'</p>';
    recHtml+='<p><strong>If you choose '+loser.toLowerCase()+' despite the cost difference, make sure that decision is intentional and tied to a clear business rationale</strong>, not simply inertia or a default assumption about how your organization staffs roles like this.</p>';
  } else if(c.xMo > months){
    // Winner is clear for this engagement length, but crossover exists
    recHtml+='<p><strong>'+winner+' is the better financial option for this '+months+'-month engagement</strong>, saving '+savingsAmt+' ('+pctSavings+'%). The break-even point is approximately month '+c.xMo+', which is beyond your planned engagement length.</p>';
    recHtml+='<p>However, if there is a realistic chance this need extends past month '+c.xMo+', the cost advantage shifts. '+(contractorWins
      ? 'If you anticipate converting to a permanent hire, consider a contract-to-hire structure upfront. This preserves the near-term savings while establishing a path to direct employment if the role proves long-term.'
      : 'If the scope of work could wrap up earlier than planned, the contractor model becomes more competitive since the one-time direct hire costs will not fully amortize.')
    +'</p>';
  } else {
    // Close call: crossover is within the engagement
    recHtml+='<p><strong>This is a close decision.</strong> '+winner+' saves '+savingsAmt+' over '+months+' months, but the break-even falls at month '+c.xMo+', within your engagement window. Small changes in timeline, rate, or scope could tip the balance.</p>';
    recHtml+='<p>'+(contractorWins
      ? 'If the engagement runs even slightly longer than planned, direct hire becomes the more economical path. Consider whether a contract-to-hire arrangement gives you the best of both worlds: lower initial risk with a clear path to permanent employment.'
      : 'If the project scope shrinks or wraps up early, the contractor model becomes competitive because the one-time hiring costs will not fully amortize. Weigh how confident you are in the '+months+'-month timeline.')
    +'</p>';
  }

  // Always include non-financial factors
  recHtml+='<p style="font-weight:600;margin-top:12px;margin-bottom:6px;">Beyond the numbers, consider these factors:</p>';
  recHtml+='<div class="rec-factors">';
  recHtml+='<span class="rec-factor"> Culture Fit & Team Cohesion</span>';
  recHtml+='<span class="rec-factor"> Risk Mitigation & Compliance</span>';
  recHtml+='<span class="rec-factor"> IP & Knowledge Retention</span>';
  recHtml+='<span class="rec-factor"> Speed to Productivity</span>';
  recHtml+='<span class="rec-factor"> Long-Term Strategic Value</span>';
  recHtml+='<span class="rec-factor"> Flexibility & Scalability</span>';
  recHtml+='</div>';

  recHtml+='</div></div>';
  rec.innerHTML=recHtml;

  // Calendar year periods
  var years = getYearPeriods(s.startDate, s.months);
  var moNames = ['','Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];

  // Monthly rates
  var salMo = c.salaryPro / months;
  var taxMo = c.taxTotal / months;
  var healthMo = c.healthAmt / months;
  var k401Mo = c.k401 / months;
  var ptoMo = c.ptoAmt / months;
  var itMo = c.itAmt / months;
  var cMo = c.cTotal / months;

  // Build column headers
  var colHeaders = '';
  for(var i=0;i<years.length;i++){
    var yr = years[i];
    var label = yr.year.toString();
    if(yr.startMo > 1 || yr.months < 12){
      var endMo = yr.startMo + yr.months - 1;
      label = moNames[yr.startMo]+' - '+moNames[endMo]+' \''+String(yr.year).slice(2);
    }
    colHeaders += '<th>'+label+'</th>';
  }
  if(years.length > 1) colHeaders += '<th>Total</th>';

  function rowCells(perMonth, oneTimeFirstYr){
    var cells = '', total = 0;
    for(var i=0;i<years.length;i++){
      var val = perMonth * years[i].months;
      if(i===0 && oneTimeFirstYr) val += oneTimeFirstYr;
      total += val;
      cells += '<td>'+fmtD(val)+'</td>';
    }
    if(years.length > 1) cells += '<td>'+fmtD(total)+'</td>';
    return cells;
  }

  function subtotalCells(items){
    var cells = '', grandTotal = 0;
    for(var i=0;i<years.length;i++){
      var yrTotal = 0;
      for(var j=0;j<items.length;j++){
        yrTotal += items[j].mo * years[i].months;
        if(i===0 && items[j].oneTime) yrTotal += items[j].oneTime;
      }
      grandTotal += yrTotal;
      cells += '<td>'+fmtD(yrTotal)+'</td>';
    }
    if(years.length > 1) cells += '<td>'+fmtD(grandTotal)+'</td>';
    return cells;
  }

  function zeroCells(label){
    var cells = '', count = years.length + (years.length > 1 ? 1 : 0);
    for(var i=0;i<count;i++) cells += '<td style="color:var(--green);">'+label+'</td>';
    return cells;
  }

  var rc=$('resultCards');

  //  Direct Hire Card 
  var dh = '<div class="result-card"><div class="rc-accent" style="background:var(--red);"></div><div class="rc-body">'
    +'<div class="rc-label">Direct W-2 Hire</div>'
    +'<div class="rc-total">'+fmtD(c.dTotal)+'</div>'
    +'<div class="rc-sub">'+fmtHr(c.dEhr)+' effective rate</div>'
    +'<div style="overflow-x:auto;margin-top:16px;-webkit-overflow-scrolling:touch;">'
    +'<table class="fin-stmt"><thead><tr><th></th>'+colHeaders+'</tr></thead><tbody>'
    +'<tr><td>Base Salary</td>'+rowCells(salMo,0)+'</tr>'
    +'<tr><td>Employer Payroll Taxes</td>'+rowCells(taxMo,0)+'</tr>'
    +'<tr><td>Health Insurance</td>'+rowCells(healthMo,0)+'</tr>'
    +'<tr><td>401(k) Match ('+(typeof c.k401Pct==="number"?c.k401Pct:3)+'%)</td>'+rowCells(k401Mo,0)+'</tr>'
    +'<tr><td>PTO Cost</td>'+rowCells(ptoMo,0)+'</tr>'
    +'<tr><td>IT & Equipment</td>'+rowCells(itMo,0)+'</tr>'
    +'<tr><td>Recruiting Fee</td>'+rowCells(0,c.recruitAmt)+'</tr>'
    +'<tr><td>Ramp Cost ('+(_snap.rampLabel||'')+')</td>'+rowCells(0,c.rampCost)+'</tr>'
    +(c.bonusCost>0?'<tr><td>Bonus / Incentive</td>'+rowCells(c.bonusType==='onetime'?0:(c.bonusCost/(months||12)),c.bonusType==='onetime'?c.bonusCost:0)+'</tr>':'')
    +'<tr class="fin-subtotal"><td>Total Cost</td>'
    +subtotalCells([{mo:salMo},{mo:taxMo},{mo:healthMo},{mo:k401Mo},{mo:ptoMo},{mo:itMo},{mo:0,oneTime:c.recruitAmt},{mo:0,oneTime:c.rampCost}].concat(c.bonusCost>0?[{mo:c.bonusType==='onetime'?0:(c.bonusCost/(months||12)),oneTime:c.bonusType==='onetime'?c.bonusCost:0}]:[]))
    +'</tr>'
    +'</tbody></table></div>'
    +'</div></div>';

  //  Contractor Card 
  var ct = '<div class="result-card"><div class="rc-accent" style="background:var(--blue);"></div><div class="rc-body">'
    +'<div class="rc-label">'+c.cHeading+'</div>'
    +'<div class="rc-total">'+fmtD(c.cTotal)+'</div>'
    +'<div class="rc-sub">'+fmtHr(c.cEhr)+' effective rate</div>'
    +'<div style="overflow-x:auto;margin-top:16px;-webkit-overflow-scrolling:touch;">'
    +'<table class="fin-stmt"><thead><tr><th></th>'+colHeaders+'</tr></thead><tbody>'
    +'<tr><td>Bill Rate x Hours Billed</td>'+rowCells(cMo,0)+'</tr>'
    +'<tr class="fin-green"><td>Payroll Taxes</td>'+zeroCells('$0')+'</tr>'
    +'<tr class="fin-green"><td>Benefits & Insurance</td>'+zeroCells('$0')+'</tr>'
    +'<tr class="fin-green"><td>IT & Equipment</td>'+zeroCells('$0')+'</tr>'
    +'<tr class="fin-green"><td>Recruiting Fee</td>'+zeroCells('$0')+'</tr>'
    +'<tr class="fin-green"><td>Ramp Time</td>'+zeroCells('Minimal')+'</tr>'
    +'<tr class="fin-subtotal"><td>Total Cost</td>'+rowCells(cMo,0)+'</tr>'
    +'</tbody></table></div>'
    +'</div></div>';

  rc.innerHTML = dh + ct;
}

function getYearPeriods(sd, months){
  if(!sd) return [{year:new Date().getFullYear(),months:months,startMo:1}];
  var parts = sd.split('-');
  var startYear = parseInt(parts[0]);
  var startMonth = parseInt(parts[1]);
  var years = [], remaining = months, curYear = startYear, curStartMo = startMonth;
  while(remaining > 0){
    var moThisYear = Math.min(remaining, 12 - curStartMo + 1);
    years.push({year:curYear, months:moThisYear, startMo:curStartMo});
    remaining -= moThisYear;
    curYear++;
    curStartMo = 1;
  }
  return years;
}

//  HubSpot Form + Report Generation 
function loadHsScript(cb){
  if(typeof hbspt!=='undefined'&&hbspt.forms){cb();return;}
  var s=document.createElement('script');s.src='https://js.hsforms.net/forms/embed/v2.js';s.charset='utf-8';
  s.onload=function(){cb();};s.onerror=function(){cb('fail');};document.head.appendChild(s);
}
function generateReport(){
  var reportURL=buildReportURL(_snap);
  var summary=buildCalculatorSummary();
  $('emailModal').classList.add('open');
  var container=$('hsFormContainer');
  container.innerHTML='<p style="font-size:0.85em;color:#666;text-align:center;padding:20px;">Loading form...</p>';
  loadHsScript(function(err){
    if(err||typeof hbspt==='undefined'){container.innerHTML='<p style="color:var(--red);font-size:0.85em;padding:20px;">Could not load form. Please refresh and try again.</p>';return;}
    container.innerHTML='';
    hbspt.forms.create({
      region:'na1',portalId:'47653730',formId:'a9ea9419-e2c0-49c7-a217-c236c350750c',target:'#hsFormContainer',
      onFormReady:function(form){
        var mf=form.querySelector('input[name="message"],textarea[name="message"]');if(mf)mf.value=summary;
        var wf=form.querySelector('input[name="workforce_planning"]');if(wf)wf.value=reportURL;
        var inf=form.querySelector('select[name="industry"],input[name="industry"]');if(inf)inf.value=wizardData.industry;
      },
      onFormSubmitted:function(){
        console.log(' HubSpot form submitted');
        var permLink=reportURL;
        var container=$('hsFormContainer');
        container.innerHTML='<div style="text-align:center;padding:10px 0;">'
          +'<div style="font-size:32px;margin-bottom:12px;"></div>'
          +'<h3 style="font-size:1.1em;font-weight:800;color:#231F20;margin:0 0 8px;">Thank You!</h3>'
          +'<p style="font-size:0.9em;color:#666;line-height:1.6;margin:0 0 16px;">Your information has been received. Click below to view your report.</p>'
          +'<button class="report-ready-btn" id="viewReportBtn">View Your Report </button>'
          +'<div style="margin-top:14px;padding:10px 12px;background:#f5f3f0;border-radius:6px;text-align:left;">'
          +'<div style="font-size:0.7em;font-weight:700;color:#999;text-transform:uppercase;letter-spacing:0.06em;margin-bottom:4px;">Shareable Report Link</div>'
          +'<div style="display:flex;gap:8px;align-items:center;">'
          +'<input type="text" id="shareLink" value="'+permLink.replace(/"/g,'&quot;')+'" readonly style="flex:1;font-size:0.75em;padding:6px 8px;border:1px solid #ddd;border-radius:4px;background:#fff;color:#333;font-family:monospace;overflow:hidden;text-overflow:ellipsis;">'
          +'<button id="copyLinkBtn" style="flex-shrink:0;padding:6px 12px;font-size:0.75em;font-weight:700;background:var(--dark);color:#fff;border:none;border-radius:4px;cursor:pointer;">Copy</button>'
          +'</div></div></div>';
        var hdr=document.querySelector('.email-modal-header h3');if(hdr)hdr.textContent='Your Report Is Ready';
        var sub=document.querySelector('.email-modal-header p');if(sub)sub.textContent='';
        $('viewReportBtn').addEventListener('click',function(){
          closeEmailModal();
          try{var narrative=fetchNarrative(_snap);buildPDF(_snap,narrative,null);}
          catch(e){alert('Could not generate report. Please disable your popup blocker and try again.');}
        });
        $('copyLinkBtn').addEventListener('click',function(){
          $('shareLink').select();
          navigator.clipboard.writeText(permLink).then(function(){$('copyLinkBtn').textContent='Copied!';setTimeout(function(){$('copyLinkBtn').textContent='Copy';},2000);});
        });
      }
    });
  });
}
function closeEmailModal(){$('emailModal').classList.remove('open');}

function buildCalculatorSummary(){
  var l=[];l.push('Industry: '+(wizardData.industry||'N/A'));l.push('Role: '+(wizardData.role||'N/A'));l.push('State: '+getStateLabel(wizardData.stateVal));
  l.push('Salary: $'+wizardData.salary.toLocaleString());l.push('Rate: $'+wizardData.rate+'/hr');l.push('Months: '+wizardData.months);
  if(_lastCalc){l.push('Direct Hire: '+fmtD(_lastCalc.dTotal));l.push('Contractor: '+fmtD(_lastCalc.cTotal));l.push('Savings: '+fmtD(Math.abs(_lastCalc.delta)));}
  return l.join('\n');
}

// Close modal on Escape
document.addEventListener('keydown',function(e){if(e.key==='Escape'&&$('emailModal').classList.contains('open'))closeEmailModal();});

//  NARRATIVE GENERATOR (preserved from original) 
function fetchNarrative(s) {
  const ind = s.industry || '';
  const contractorWins = s.delta > 0;
  const savingsAmt = '$'+Math.round(Math.abs(s.delta)).toLocaleString();
  const pctSavings = Math.round(Math.abs(s.delta) / Math.max(s.dTotal, s.cTotal) * 100);
  const shortTerm = s.months <= 12;
  const longTerm = s.months > 24;
  const highSalary = s.salary >= 150000;
  const state = s.stateLabel || 'the selected state';
  const stateClean = (s.stateLabel||'').replace(/ \(.*\)/,'');
  const obligationTotal = Math.round(s.taxTotal+s.healthAmt+s.k401+s.ptoAmt+s.itAmt+s.recruitAmt+s.rampCost);
  const billingDesc = s.mode==='hourly' ? 'Hourly (no commitment)' : s.mode==='weekly' ? 'Guaranteed Hours ('+s.minHrs+' hrs/wk guaranteed)' : 'Monthly Retainer ('+s.minHrs+' hrs/mo)';
  const roleName = s.role && s.role !== 'Not specified' ? s.role : 'this role';

  const industryInsights = {
    'Aerospace & Defense': {
      directPro: 'Aerospace and defense organizations benefit significantly from permanent hires who can obtain and maintain security clearances, understand ITAR/EAR export control regulations, and build deep knowledge of program-specific requirements that often span multi-year contracts. The institutional continuity that direct hires provide is especially valuable in an industry where program knowledge directly affects contract performance and audit outcomes.',
      contractorPro: 'Aerospace programs frequently operate in distinct phases with varying staffing needs, and contractors allow organizations to scale specialized engineering, compliance, or program management talent to match program milestones without carrying overhead between phases. Many defense contractors maintain a flexible workforce model specifically because contract vehicles have defined periods of performance.',
      risk: 'Security clearance requirements can add 3-12 months to onboarding for either employment model, and interim clearances may not be available for all contract types. ITAR and export control regulations impose strict limitations on who can access technical data, which may affect contractor eligibility based on citizenship status. Co-employment risks are heightened in defense environments where contractors work alongside government personnel.',
      research: 'Verify whether this role requires a security clearance and at what level, as this significantly affects both the available talent pool and time-to-start. Review DCAA audit history for your contract type to understand how contractor labor is scrutinized versus direct hire labor. Investigate whether your prime or subcontract agreement places restrictions on the use of contract labor for key personnel positions.',
      context: 'The aerospace and defense sector operates under unique workforce constraints driven by security clearance requirements, export control regulations, and government contracting rules. Talent mobility is constrained by clearance portability and program-specific knowledge that does not transfer easily. The industry is experiencing a generational workforce transition, with experienced program managers and systems engineers retiring faster than they can be replaced, putting upward pressure on compensation for both direct hires and contractors.'
    },
    'Automotive': {
      directPro: 'Automotive organizations benefit from permanent hires who understand the complex interplay between manufacturing engineering, supply chain management, and quality systems like IATF 16949. The automotive product development cycle requires deep cross-functional knowledge that takes years to develop, and direct hires who understand your specific platform architectures and launch processes become increasingly valuable over time.',
      contractorPro: 'The automotive industry operates on well-defined program timelines tied to vehicle launches and model year changes, making contractors a natural fit for roles that align with specific program phases. Contract engineers and IT specialists are commonly used during ERP migrations, plant automation projects, and new model launch support.',
      risk: 'Automotive quality standards require extensive training and certification, and contractors may face longer ramp times within your quality management system. OEM supplier requirements often mandate specific workforce stability metrics, and high contractor ratios in key functions could trigger customer audit findings.',
      research: 'Review your OEM customer requirements for workforce stability ratios and ensure contractor usage will not trigger audit concerns. Benchmark compensation against automotive-specific salary data from the Center for Automotive Research or the Original Equipment Suppliers Association. Investigate whether your Tier 1 or Tier 2 supplier agreements include provisions about contract labor on customer-facing programs.',
      context: 'The automotive industry is undergoing a fundamental transformation driven by electrification, autonomous driving, and software-defined vehicles. This shift creates intense demand for software engineers, battery specialists, and ADAS experts while traditional mechanical and manufacturing roles remain critical. Organizations that can blend permanent core teams with flexible contract talent for emerging technology initiatives are better positioned to navigate this transition.'
    },
    'Construction & Engineering': {
      directPro: 'Construction and engineering firms benefit from permanent hires who understand project-based accounting, lien waiver processes, prevailing wage requirements, and ERP modules specific to job costing and equipment tracking. The relationships that project managers and estimators build with subcontractors, inspectors, and owners over time create significant business value.',
      contractorPro: 'Construction projects are inherently finite, and using contractors for technology implementations or specialized compliance roles mirrors the project-based work model the industry already operates under. The ability to scale staff without carrying overhead between projects protects margins.',
      risk: 'Construction industry margins are typically tight, so cost overruns on technology projects have outsized financial impact. Prevailing wage and Davis-Bacon requirements on government-funded projects may affect labor classification for technology roles. Bonding and insurance requirements may need to cover contractor activities.',
      research: 'Review whether prevailing wage or Davis-Bacon requirements affect labor classification for technology roles on government-funded projects. Investigate whether your surety bonding program has provisions affecting contract labor. Benchmark compensation against surveys from the Associated General Contractors or the Construction Financial Management Association.',
      context: 'The construction industry faces a persistent skilled labor shortage extending into project management, estimating, and technology roles. The push toward BIM, drone-based surveying, and integrated project delivery is accelerating demand for tech-savvy professionals who also understand construction workflows. This creates a premium for candidates who combine construction domain knowledge with technology skills.'
    },
    'Distribution & Logistics': {
      directPro: 'Distribution and logistics organizations benefit from permanent hires who understand the full supply chain lifecycle, from warehouse management and transportation optimization to last-mile delivery. The institutional knowledge required to manage complex distribution networks and optimize inventory positioning across multiple facilities takes significant time to develop.',
      contractorPro: 'Logistics technology projects like WMS implementations or TMS upgrades often have well-defined timelines that align naturally with contractor engagements. Bringing in specialized implementation consultants for system cutovers and scaling back to steady-state support manages technology investment without permanent headcount inflation.',
      risk: 'Supply chain disruptions can shift project timelines rapidly, and fixed-term contractor agreements may need flexibility clauses. Distribution center operations run on tight schedules where contractor ramp time in mission-critical roles can have immediate financial impact through shipping delays or inventory errors.',
      research: 'Review seasonal volume patterns and how they align with the engagement timeline to ensure coverage during peak shipping periods. Benchmark compensation against data from the Council of Supply Chain Management Professionals or the Warehousing Education and Research Council. Investigate whether your WMS or TMS vendor offers implementation services that could be bundled with the technology investment.',
      context: 'Distribution and logistics is experiencing rapid transformation driven by e-commerce growth, customer expectations for faster delivery, and adoption of warehouse automation including robotics and AI-powered inventory management. This transformation creates strong demand for professionals who can bridge traditional logistics operations and emerging technology. Labor availability remains constrained at all levels, giving candidates significant leverage in both permanent and contract negotiations.'
    },
    'Education': {
      directPro: 'Educational institutions benefit from permanent hires who understand the academic calendar, FERPA requirements, and unique governance structures including shared governance and accreditation requirements. Staff who can navigate committee-based decision-making and institutional politics effectively become invaluable organizational resources.',
      contractorPro: 'Education technology projects often align with academic breaks, making summer and winter periods natural windows for implementations. Contractors can execute major projects during low-impact periods and transition to internal teams for ongoing support. Budget constraints common in education also make contractors attractive for one-time initiatives.',
      risk: 'Education budgets are typically approved annually and subject to mid-year adjustments based on enrollment or state funding changes. FERPA compliance requires contractor training and institutional data governance compliance. The nonprofit salary structure may create internal equity concerns when contractor rates are visible.',
      research: 'Check whether the institution has preferred vendor lists or staffing agreements that may affect contractor sourcing and rates. Review the fiscal year calendar and budget approval process. Investigate whether IRB review or data governance committee approval is required for contractor access to student or institutional data systems.',
      context: 'Higher education is under significant financial pressure from declining enrollment, competition from online providers, and growing expectations for technology-enabled learning. These pressures force institutions to modernize while managing costs, creating demand for technology talent that often exceeds what institutions can attract at academic salary scales. The compensation gap between education and private sector is widening for technology roles.'
    },
    'Energy & Utilities': {
      directPro: 'Energy and utility companies benefit from permanent hires who understand the regulatory environment, SCADA/OT system integrations, and the long planning horizons that characterize infrastructure investment. The safety-critical nature of energy operations requires deep organizational knowledge and regulatory framework continuity.',
      contractorPro: 'Utility modernization projects including grid automation, smart meter deployments, and ERP upgrades often involve specialized skills needed for defined implementation phases. Contractors bring niche expertise without adding permanent headcount in skills that may not be needed at steady-state.',
      risk: 'Energy sector roles may require NERC CIP clearance, hazmat training, or other security vetting that adds significant onboarding time. Critical infrastructure designations impose additional background check requirements. Rate cases and regulatory proceedings can affect project timelines and budgets unpredictably.',
      research: 'Confirm whether this role involves access to critical infrastructure systems triggering NERC CIP or TSA security requirements. Review public utility commission requirements for workforce-related reporting. Investigate whether comparable utilities have established preferred staffing partnerships that could provide rate benchmarks.',
      context: 'The energy sector is in the midst of a generational transformation driven by grid modernization, renewable energy integration, and electrification of transportation. This requires a workforce bridging legacy infrastructure knowledge with emerging technology skills. Retirements among experienced operations staff are accelerating the shortage, creating both opportunity and risk for organizations maintaining reliable service while modernizing.'
    },
    'Financial Services': {
      directPro: 'Financial services firms benefit from permanent hires who build deep expertise in regulatory compliance, risk frameworks, and specific trading, banking, or insurance systems. The regulatory environment demands institutional continuity, as auditors and examiners expect consistent contacts who understand the history of compliance decisions. Permanent staff provide stability for SOX-controlled processes where personnel changes trigger additional documentation.',
      contractorPro: 'Financial services projects often face immovable regulatory deadlines from consent orders or exam findings, and contractors with specific compliance or platform experience can hit the ground running. The cost premium is often justified by speed and the ability to bring specialized expertise for niche areas like model validation or AML technology.',
      risk: 'Financial services roles typically require extensive background checks, licensing verification, and compliance training adding 4-8 weeks to onboarding. Contractor access to non-public financial information must be carefully governed under Reg SP and GLBA. Some regulatory frameworks limit non-employee personnel in certain risk management and audit functions.',
      research: 'Verify whether this role touches SOX-controlled systems, BSA/AML processes, or requires FINRA/SEC registrations. Review your third-party risk management policy for due diligence requirements on contract staffing. Benchmark the bill rate against financial services staffing market data from specialized recruiters in your market.',
      context: 'Financial services is navigating simultaneous pressures from regulatory modernization, digital transformation, and fintech competition. Regulatory technology spend continues to grow while customer-facing digital platforms require continuous development. These parallel demands create persistent talent pressure, particularly for professionals combining technology expertise with financial services domain knowledge.'
    },
    'Food & Beverage': {
      directPro: 'Food and beverage companies benefit from permanent hires who understand FDA/USDA regulatory requirements, food safety management systems like SQF and FSSC 22000, and the complex supply chain dynamics of perishable goods. Institutional knowledge of your specific manufacturing processes and customer requirements represents a significant competitive advantage.',
      contractorPro: 'The food and beverage industry experiences pronounced seasonal demand patterns creating natural windows for technology projects. Contractors allow staffing specialized projects during off-peak production periods and scaling back during high-volume seasons without carrying permanent overhead.',
      risk: 'Food safety and regulatory compliance requirements demand that all personnel, including contractors, receive HACCP, allergen management, and facility-specific safety training. This training time and cost should be factored into the total engagement cost. Facilities often require specific health certifications and background checks.',
      research: 'Review your food safety and quality management system requirements for training and certification needs. Investigate whether co-packing or co-manufacturing partners have staffing models providing benchmarks. Benchmark compensation against food industry surveys from the Food Processing Suppliers Association or International Food Technologists.',
      context: 'The food and beverage industry is adapting to shifting consumer preferences, supply chain complexity, and increasing regulatory scrutiny. Technology adoption is accelerating with investments in traceability systems, predictive quality analytics, and automated production. The industry competes for technology talent against sectors offering higher compensation, making creative workforce strategies particularly important.'
    },
    'Government & Public Sector': {
      directPro: 'Public sector organizations benefit from permanent hires who navigate procurement rules, FOIA requirements, and lengthy budget and approval cycles. The stability of permanent employment is a meaningful recruiting advantage, where pension benefits and job security help offset lower base compensation compared to the private sector.',
      contractorPro: 'Government agencies frequently use contractors to access specialized skills difficult to recruit at public-sector salary bands and to manage work within fiscal year budget constraints. The contractor model provides flexibility to address time-bound mandates or legislative requirements without long-term staffing obligations.',
      risk: 'Government hiring processes can involve lengthy approval chains, procurement reviews, and compliance checks. Contractor classification must comply with FAR for federal work or state-specific procurement rules. Personal services contracts face particularly strict scrutiny as they can create unauthorized employer-employee relationships.',
      research: 'Verify whether this engagement falls under existing contract vehicles, BPAs, or GSA schedules. Review the fiscal year timeline and continuing resolution risks. Investigate whether comparable agencies have established staffing strategies that could provide rate benchmarks and engagement structure templates.',
      context: 'Government agencies at all levels are under pressure to modernize legacy technology while managing constrained budgets and competing with the private sector for talent. The compensation gap continues to widen, making it increasingly difficult to attract skilled permanent staff. This has accelerated contractor and consultant use, creating a robust market but also raising concerns about institutional knowledge loss.'
    },
    'Healthcare': {
      directPro: 'Healthcare organizations benefit enormously from permanent hires who navigate HIPAA compliance, EHR integrations, and the complex regulatory landscape. The institutional knowledge required to work within healthcare systems, from clinical workflows to EHR vendor relationships, takes significant time to develop and represents real organizational value.',
      contractorPro: 'Healthcare IT projects often have strict go-live deadlines tied to regulatory requirements or fiscal year budgets, and contractors bring specialized implementation experience without long-term obligations. The healthcare industry has a well-established contractor ecosystem, particularly for EHR implementations and interoperability projects.',
      risk: 'Healthcare roles may require background checks, credentialing, and HIPAA training adding 2-4 weeks to onboarding. Contractor access to PHI must be governed by a BAA, and breaches still expose the covered entity to liability. CMS and state regulations may impose specific workforce requirements affecting staffing flexibility.',
      research: 'Confirm whether this role requires PHI access, which would require a BAA and may limit the contractor talent pool. Review Joint Commission or state licensing requirements. Investigate whether comparable healthcare organizations have shifted toward contract staffing for similar roles and what compliance frameworks they use.',
      context: 'Healthcare is experiencing a workforce crisis extending beyond clinical roles into technology, finance, and administrative functions. The pandemic accelerated digital health adoption, creating permanent shifts in telehealth utilization and interoperability requirements. At the same time, margin pressure from payer mix changes and labor cost inflation creates tension between the need for talent and the ability to fund permanent positions.'
    },
    'Manufacturing': {
      directPro: 'In manufacturing, direct hires develop deep institutional knowledge of production systems, shop floor workflows, safety protocols, and ERP configurations. Manufacturing environments reward continuity, as understanding quality management processes, supplier relationships, and equipment maintenance histories compounds over time. Permanent employees also build cross-functional relationships essential for effective problem-solving.',
      contractorPro: 'Manufacturing firms often face cyclical demand patterns making contractor flexibility valuable during system implementations, plant expansions, or production automation projects. Bringing in specialized talent for ERP implementations or quality system upgrades without permanent headcount commitments aligns with the project-based nature of manufacturing improvements.',
      risk: 'Manufacturing may require specific certifications, OSHA training, or union considerations affecting onboarding timelines. Access to proprietary processes and trade secrets requires careful contractual protections. In unionized environments, collective bargaining agreements may limit when and how contractors can be deployed.',
      research: 'Investigate whether this role requires specialized certifications or safety training. Review your ERP vendor or partner network for implementation support through existing agreements. Benchmark compensation against surveys from the National Association of Manufacturers, APICS, or the Society of Manufacturing Engineers.',
      context: 'Manufacturing is undergoing significant transformation driven by Industry 4.0 technologies, reshoring initiatives, and persistent labor shortages. The convergence of OT and IT creates demand for professionals understanding both manufacturing processes and modern technology. The industry faces demographic challenges as experienced professionals retire faster than they can be replaced.'
    },
    'Nonprofit': {
      directPro: 'Nonprofit organizations benefit from mission-aligned permanent hires who navigate unique governance structures, funding cycles, and stakeholder dynamics. The institutional relationships that staff build with donors, board members, and partner organizations create organizational value difficult to replicate with temporary staff.',
      contractorPro: 'Nonprofits often operate under tight budget constraints making permanent headcount difficult to justify for specialized roles needed for time-bound initiatives like CRM implementations or digital transformation projects. Contractors allow access to expertise cost-prohibitive to maintain permanently.',
      risk: 'Nonprofit budgets are typically grant-funded or donor-restricted, creating unique constraints on labor cost allocation and reporting. Engagement costs spanning multiple grant periods may require separate funding sources. The sector typically offers below-market compensation, meaning contractor rates may create internal equity concerns.',
      research: 'Review grant requirements and donor restrictions for contractor cost allocation. Investigate whether your fiscal sponsor has established staffing agreements or preferred vendor relationships. Benchmark compensation against surveys from Bridgespan, Idealist, or the National Council of Nonprofits.',
      context: 'The nonprofit sector faces increasing pressure to modernize operations and demonstrate impact through data while competing for talent against private sector organizations offering significantly higher compensation. Many nonprofits are adopting hybrid workforce strategies combining lean permanent staff with project-based contractors to manage costs while accessing specialized expertise.'
    },
    'Pharma & Life Sciences': {
      directPro: 'Life sciences companies benefit enormously from permanent hires who understand GxP validation, 21 CFR Part 11 compliance, and the documentation rigor of regulated environments. Institutional knowledge of how validation protocols and change control procedures work within your organization is deeply valuable, as even small compliance errors can trigger FDA warning letters or product recalls.',
      contractorPro: 'Pharmaceutical companies frequently engage specialized contractors for validated system implementations, clinical trial data management, and regulatory submission preparation where niche expertise matters more than long-term retention. The project-based nature of drug development creates natural engagement windows.',
      risk: 'Validated system implementations carry significant documentation and compliance overhead, and contractor transitions can jeopardize validation status if not properly managed. FDA inspections may scrutinize qualifications and training records of all personnel touching validated systems. CSV requirements mean all contractor work must follow established validation protocols.',
      research: 'Determine whether this role supports a GxP-validated system, which requires specific documentation practices and may limit the contractor talent pool. Review quality management system requirements for contractor qualification. Benchmark compensation against surveys from Radford, BioSpace, or the Drug Information Association.',
      context: 'Pharma and life sciences is experiencing unprecedented demand for technology talent driven by digital health, real-world evidence, AI-driven drug discovery, and complex data integrity regulations. The convergence of clinical science and technology creates new role profiles commanding premium compensation. Organizations building flexible workforce strategies while maintaining rigorous compliance are best positioned to accelerate their pipelines.'
    },
    'Professional Services': {
      directPro: 'Professional services firms benefit from permanent hires who develop deep client relationships, accumulate industry expertise, and contribute to intellectual capital differentiating the firm. The leverage model depends on experienced professionals who can mentor junior staff, manage clients, and deliver consistent quality.',
      contractorPro: 'Professional services firms are accustomed to flexing workforce with demand, and subcontracting specialized talent allows bidding on engagements requiring capabilities outside the permanent bench. The contractor model also provides a natural evaluation period for potential permanent hires.',
      risk: 'Client contracts often include provisions about qualifications and continuity of key personnel. Substituting a contractor may require client approval. Subcontractor margins must be managed to maintain profitability, and rate transparency requirements in some contracts may create pricing challenges.',
      research: 'Review client contracts for key personnel provisions, non-solicitation clauses, and subcontractor approval requirements. Investigate whether professional liability insurance covers subcontractor work. Benchmark compensation against data from Kennedy Consulting Research or the Association of Management Consulting Firms.',
      context: 'Professional services operates on a people-driven model where talent quality directly determines revenue capacity and client satisfaction. The shift toward digital consulting and technology implementation has intensified competition for talent with hybrid skill sets combining domain expertise with technology capabilities.'
    },
    'Real Estate': {
      directPro: 'Real estate organizations benefit from permanent hires who understand property market cycles, transaction regulatory requirements, and technology platforms supporting portfolio management and leasing. Permanent staff with established connections to brokers, lenders, and property managers provide significant business development value.',
      contractorPro: 'Real estate technology projects, including property management system implementations and portfolio analytics upgrades, often align with lease cycles or fiscal year budgets creating natural engagement windows. Contractors execute these without adding permanent overhead to property management costs.',
      risk: 'Real estate markets are cyclical, and downturns can rapidly shift project urgency and budgets. Contractor agreements should include provisions for early termination or scope reduction. Roles involving tenant personal information or financial records require applicable privacy law compliance.',
      research: 'Review property management agreements and investor reporting requirements for staffing provisions. Benchmark compensation against surveys from NAREIT or BOMA. Investigate whether your property management or ERP vendor offers implementation services reducing external staffing needs.',
      context: 'Real estate is investing heavily in proptech to improve tenant experience, optimize building operations, and enhance portfolio analytics. The industry faces market uncertainty from interest rate dynamics, remote work patterns, and evolving ESG requirements that add complexity to property management and reporting.'
    },
    'Retail & E-commerce': {
      directPro: 'Retail organizations benefit from permanent hires who understand omnichannel operations, seasonal planning, and the complex integrations between POS, inventory, e-commerce, and fulfillment systems. Permanent staff who manage continuous platform evolution while maintaining operational stability provide essential organizational capability.',
      contractorPro: 'Retail technology projects often align with specific seasons or launches, and contractors can ramp quickly for holiday readiness or major system cutovers. Surging technology capacity during critical windows and scaling back to steady-state aligns with the retail operating model.',
      risk: 'Implementation timelines must account for peak selling seasons. Starting a major implementation too close to Q4 introduces risk to both the project and store operations. PCI-DSS compliance requirements apply to roles touching payment systems, adding training and access control requirements for contractors.',
      research: 'Map the engagement against your retail calendar to avoid conflicts with peak revenue periods. Review PCI-DSS requirements for contractor access to payment systems. Benchmark compensation against retail technology data from the National Retail Federation or retail-specific recruiting firms.',
      context: 'Retail and e-commerce is in continuous transformation driven by shifting consumer behavior, marketplace competition, and convergence of physical and digital experiences. Retailers must maintain legacy store systems while building digital capabilities, creating persistent demand for technology talent. The industry competes against technology companies offering higher compensation, making creative workforce strategies essential.'
    },
    'Technology': {
      directPro: 'Technology companies benefit from permanent hires contributing to long-term product vision, accumulating deep codebase knowledge, and participating in architectural decisions. Understanding not just what code does but why decisions were made accelerates development velocity and reduces technical debt. Permanent engineers build the cross-team relationships enabling effective collaboration in complex organizations.',
      contractorPro: 'Tech firms frequently use contractors for defined sprints, platform migrations, or bridging skill gaps. The contractor model allows access to niche expertise in specific cloud platforms, languages, or tools without committing to permanent headcount in skills that may not be needed long-term as stacks evolve.',
      risk: 'In a competitive tech labor market, top contractor rates may rise quickly and key contractors may leave mid-engagement. IP considerations require clear contractual boundaries including code ownership, patent assignment, and non-competes. Technology roles involve access to source code, production environments, and customer data creating security exposure with non-permanent staff.',
      research: 'Evaluate IP assignment clauses in your contractor agreements and assess non-compete enforceability in '+stateClean+'. Benchmark contractor rates against Levels.fyi, Glassdoor, or Blind. Consider whether contract-to-hire might reduce risk while preserving flexibility, and review your onboarding process to estimate realistic ramp time for both models.',
      context: 'Technology continues to experience intense talent competition, particularly in AI, cloud infrastructure, cybersecurity, and platform engineering. While recent corrections created some loosening, demand for senior and specialized engineers remains strong. Equity compensation plays a significant role in tech total rewards, meaning base salary comparisons alone may not capture the full cost differential between direct hire and contractor models.'
    },
  };

  const ins = industryInsights[ind] || {
    directPro: 'A permanent hire builds institutional knowledge that compounds over time, becoming increasingly valuable as they understand your systems, culture, and processes. The stability of a direct hire reduces management overhead associated with contractor transitions and knowledge transfer cycles, providing continuity benefiting both efficiency and culture.',
    contractorPro: 'Contractors bring focused expertise without long-term overhead, and the engagement can flex with project needs. This model eliminates employer obligations totaling $'+obligationTotal.toLocaleString()+' on the direct-hire side, including taxes, benefits, recruiting, and productivity ramp, providing a cleaner cost structure for defined-scope initiatives.',
    risk: 'Role transitions carry institutional knowledge risk that should be mitigated with thorough documentation and knowledge transfer plans. Consider compliance and onboarding requirements specific to your industry, and review '+stateClean+'\'s worker classification rules to ensure contractor arrangements are properly structured to avoid misclassification liability.',
    research: 'Research the local talent market for '+roleName+' roles in '+stateClean+' to understand whether contractor supply meets your timeline and quality requirements. Consider whether the role\'s scope may evolve beyond the initial engagement, which could shift the cost calculus toward direct hire.',
    context: 'The broader labor market for '+roleName+' roles continues to evolve based on economic conditions, technology adoption trends, and workforce preferences around flexibility and remote work. Organizations that clearly articulate their value proposition, whether through compensation, mission, flexibility, or growth, are better positioned to attract top talent in both permanent and contract markets.'
  };

  //  COMPENSATION BENCHMARK 
  let compBenchmark = 'COMPENSATION BENCHMARK\n';
  compBenchmark += 'The proposed salary of $'+s.salary.toLocaleString()+' for a '+roleName+' role in '+stateClean+' should be evaluated against current market data to ensure competitive positioning. ';
  if (highSalary) {
    compBenchmark += 'At this compensation level, the role falls in the senior or leadership tier where candidate expectations around equity, benefits, career growth, and work flexibility often factor as heavily as base salary. Candidates at this level typically have multiple options, and time-to-fill can extend significantly if the total compensation package is not competitive.\n\n';
    compBenchmark += 'We recommend benchmarking this salary against current job postings on LinkedIn, Indeed, and Glassdoor for comparable '+roleName+' roles in '+stateClean+'. Industry-specific compensation surveys'+(ind ? ' for the '+ind+' sector' : '')+' can provide more precise benchmarks. At the $'+s.salary.toLocaleString()+' level, the equivalent contractor rate of $'+s.rate+'/hr should also be benchmarked, as contractor rate expectations at this seniority level vary significantly based on skill set and demand.';
  } else {
    compBenchmark += 'At this compensation level, the role is positioned in the mid-market range where candidate supply is typically broader but competition from larger employers and remote opportunities can still create hiring pressure. The key question is whether $'+s.salary.toLocaleString()+' is at, above, or below median for comparable roles in your region, as below-median positioning extends time-to-fill and may reduce candidate quality.\n\n';
    compBenchmark += 'We recommend cross-referencing this salary against active job postings for '+roleName+' roles on major job boards. If below the 50th percentile, consider whether adjusting the offer, enhancing benefits, or offering flexibility could improve candidate quality. The proposed bill rate of $'+s.rate+'/hr for the contractor option should similarly be benchmarked against current market rates.';
  }

  //  DIRECT HIRE 
  let directProsCons = 'DIRECT HIRE: PROS AND CONS\n';
  if (contractorWins) {
    directProsCons += 'Direct hiring provides long-term stability and full organizational integration'+(highSalary ? ', particularly valuable at the $'+s.salary.toLocaleString()+' salary level where institutional knowledge compounds significantly' : '')+'. However, the upfront investment is significant: recruiting costs of $'+Math.round(s.recruitAmt).toLocaleString()+' and a ramp period ('+s.rampLabel+') add $'+Math.round(s.recruitAmt+s.rampCost).toLocaleString()+' before the hire reaches full productivity. The total loaded cost of $'+Math.round(s.dTotal).toLocaleString()+' includes $'+Math.round(s.taxTotal).toLocaleString()+' in employer taxes, $'+Math.round(s.healthAmt).toLocaleString()+' in health insurance, and $'+Math.round(s.ptoAmt).toLocaleString()+' in PTO costs that significantly affect the true cost of employment.\n\n';
    directProsCons += ins.directPro+' ';
    directProsCons += shortTerm ? 'For a '+s.months+'-month need, these one-time costs may not amortize before the role concludes, making direct hire the more expensive option.' : 'Over '+s.months+' months, these costs begin to amortize but the contractor option still shows a '+savingsAmt+' advantage.';
  } else {
    directProsCons += 'Direct hiring is the more cost-effective option, saving '+savingsAmt+' (approximately '+pctSavings+'%) compared to contracting over '+s.months+' months. The one-time costs of recruiting ($'+Math.round(s.recruitAmt).toLocaleString()+') and ramp productivity loss ($'+Math.round(s.rampCost).toLocaleString()+') fully amortize at this engagement length.\n\n';
    directProsCons += ins.directPro+' ';
    directProsCons += 'The trade-off is reduced flexibility. A permanent hire commits the organization to an annualized cost of approximately $'+Math.round(s.dAnnual).toLocaleString()+' in salary, taxes, benefits, and overhead extending well beyond the '+s.months+'-month project timeline.';
  }

  //  CONTRACTOR 
  let contractorProsCons = 'CONTRACTOR: PROS AND CONS\n';
  if (contractorWins) {
    contractorProsCons += 'Contracting via the '+billingDesc+' structure delivers '+savingsAmt+' in savings (approximately '+pctSavings+'%) over this '+s.months+'-month engagement. The primary advantage comes from eliminating employer-side obligations totaling $'+obligationTotal.toLocaleString()+', including payroll taxes ($'+Math.round(s.taxTotal).toLocaleString()+'), benefits ($'+Math.round(s.healthAmt+s.k401+s.ptoAmt).toLocaleString()+'), recruiting ($'+Math.round(s.recruitAmt).toLocaleString()+'), and ramp loss ($'+Math.round(s.rampCost).toLocaleString()+').\n\n';
    contractorProsCons += ins.contractorPro+' ';
    contractorProsCons += shortTerm ? 'For engagements under 12 months, contracting almost always delivers stronger ROI because one-time hiring costs cannot fully amortize.' : 'The break-even point where direct hiring becomes competitive is approximately month '+s.xMo+', '+(s.xMo > s.months ? 'beyond' : 'within')+' this engagement window.';
  } else {
    contractorProsCons += 'Contracting provides flexibility and eliminates employer obligations, but at $'+s.rate+'/hr over '+s.months+' months, the total of $'+Math.round(s.cTotal).toLocaleString()+' exceeds direct hiring by '+savingsAmt+'. The higher cost buys operational flexibility, zero long-term commitment, and the ability to end the engagement without severance or ongoing obligations.\n\n';
    contractorProsCons += ins.contractorPro+' ';
    contractorProsCons += 'Contracting may still be the right choice if speed-to-start, specialized expertise, or flexibility outweigh pure cost optimization. If the engagement ends earlier than '+s.months+' months, contracting becomes more competitive as direct-hire one-time costs of $'+Math.round(s.recruitAmt+s.rampCost).toLocaleString()+' have less time to amortize.';
  }

  //  INDUSTRY CONTEXT (PESTLE Framework) 
  const pestleData = {
    'Aerospace & Defense': {
      political: 'Defense budgets are subject to congressional appropriations cycles, continuing resolutions, and shifting administration priorities. Contract awards, cancellations, or sequestration can rapidly change workforce needs. Export control policy (ITAR/EAR) directly affects who can fill roles and where work can be performed.',
      economic: 'Defense spending tends to be counter-cyclical, providing some stability during economic downturns, but the commercial aerospace segment is highly sensitive to airline capital expenditure cycles and passenger demand. Contractor bill rates in this sector tend to carry a premium reflecting clearance requirements and the limited talent pool.',
      social: 'The industry faces a generational knowledge transfer crisis as experienced engineers and program managers retire. Younger workers increasingly prioritize work-life balance and may be less willing to accept the constraints of classified work environments. Remote work expectations conflict with facility security requirements for cleared personnel.',
      technological: 'Digital engineering, model-based systems engineering (MBSE), and AI-driven design optimization are transforming development workflows. Organizations need talent that bridges legacy platform knowledge with modern digital tools. Cybersecurity requirements (CMMC) are creating new compliance-driven staffing needs.',
      legal: 'Federal Acquisition Regulation (FAR) and Defense Federal Acquisition Regulation Supplement (DFARS) govern contractor labor practices. DCAA audit requirements affect how contractor costs are accounted and billed. Non-compete and IP assignment provisions must comply with both federal and state law.',
      environmental: 'Sustainability mandates and environmental remediation obligations are creating new roles in environmental compliance and green manufacturing. Defense industrial base decarbonization goals will drive workforce needs in energy efficiency and sustainable materials.'
    },
    'Automotive': {
      political: 'EV tax credits, emissions regulations, and trade policies (tariffs on imported vehicles and components) directly affect production planning and workforce needs. State-level right-to-repair legislation and autonomous vehicle regulations create varying compliance requirements across markets.',
      economic: 'The industry is capital-intensive with long product development cycles, making workforce planning inherently forward-looking. Interest rate changes affect consumer financing and vehicle demand. The shift to EVs is restructuring the supply chain and reallocating investment from powertrain to battery and software.',
      social: 'Consumer preference shifts toward EVs, connected vehicles, and shared mobility are reshaping the skills profile the industry needs. The traditional manufacturing workforce is aging, and attracting software talent to automotive requires competing with Silicon Valley compensation and culture.',
      technological: 'Software-defined vehicles, autonomous driving, battery technology, and connected car platforms are the primary technology drivers. The industry needs talent that bridges traditional automotive engineering with software development, data science, and AI.',
      legal: 'IATF 16949 quality standards, NHTSA safety regulations, and product liability considerations affect workforce requirements. Union collective bargaining agreements may restrict contractor usage in certain facilities. State lemon laws and warranty requirements create compliance staffing needs.',
      environmental: 'Emissions regulations (EPA, CARB) drive electrification timelines. Battery recycling mandates and supply chain sustainability requirements (conflict minerals, EU Battery Regulation) are creating new compliance and engineering roles.'
    },
    'Construction & Engineering': {
      political: 'Infrastructure spending bills, prevailing wage requirements (Davis-Bacon), and permitting reform directly affect project pipelines and workforce demand. Immigration policy affects labor availability at all skill levels. State licensing requirements vary significantly for engineering and project management roles.',
      economic: 'Construction is highly cyclical and interest-rate sensitive. Material cost volatility (steel, lumber, concrete) affects project margins and can delay or accelerate hiring needs. Bonding capacity constraints can limit the number of projects a firm can pursue simultaneously.',
      social: 'The skilled trades shortage is well-documented and extends into project management, estimating, and technology roles. An aging workforce and insufficient vocational training pipeline create persistent talent gaps. The industry struggles to attract diverse candidates and younger workers.',
      technological: 'BIM, drone surveying, prefabrication, and integrated project delivery (IPD) are driving technology adoption. Construction technology (ConTech) investment is growing, creating demand for professionals who bridge field operations and digital tools.',
      legal: 'Prevailing wage laws, OSHA regulations, contractor licensing requirements, and mechanic\'s lien statutes vary by state and affect both labor costs and workforce structure. Worker classification scrutiny is particularly intense in construction.',
      environmental: 'Green building standards (LEED, WELL), embodied carbon requirements, and state-level building performance standards are creating new roles in sustainability and energy modeling. Environmental impact assessment and remediation requirements add compliance staffing needs.'
    },
    'Distribution & Logistics': {
      political: 'Trade policy, tariff structures, and customs regulations directly affect supply chain operations and staffing needs. Hours-of-service regulations for drivers, port labor agreements, and state-level warehouse safety legislation (e.g., California AB 701) affect workforce planning.',
      economic: 'E-commerce growth continues to drive demand for distribution capacity and talent. Fuel costs, carrier rates, and real estate costs for warehouse space affect operational margins and influence build-vs-buy workforce decisions. Last-mile delivery economics create particular pressure on labor costs.',
      social: 'Warehouse and logistics labor markets are extremely tight, with high turnover rates and increasing worker expectations around compensation, scheduling flexibility, and working conditions. The shift to e-commerce has changed customer expectations around delivery speed, creating operational pressure.',
      technological: 'Warehouse automation (robotics, AS/RS), transportation management systems, real-time visibility platforms, and AI-powered demand forecasting are reshaping operations. The technology skills gap in logistics is significant as the industry moves from manual to automated operations.',
      legal: 'DOT regulations, hazmat handling requirements, and state-specific labor laws (meal breaks, scheduling predictability) affect workforce structure. Worker classification issues are prominent in last-mile delivery. Customs and trade compliance creates specialized staffing needs.',
      environmental: 'Fleet electrification mandates, Scope 3 emissions reporting requirements, and sustainable packaging initiatives are creating new roles in environmental compliance and green logistics. Reverse logistics for returns and recycling is a growing operational function.'
    },
    'Education': {
      political: 'State funding formulas, federal financial aid policy (Title IV), and accreditation requirements directly affect institutional budgets and staffing capacity. Political debate around DEI programs, curriculum content, and free speech on campus creates workforce volatility in certain administrative functions.',
      economic: 'Demographic enrollment cliffs, tuition sensitivity, and endowment performance create budget uncertainty. Institutions compete for technology talent against private sector organizations offering 30-50% higher compensation for comparable roles. Grant funding cycles affect project-based staffing.',
      social: 'Student expectations for digital learning experiences, mental health services, and career outcomes are driving institutional investment. Faculty governance and shared decision-making culture affect the pace of technology adoption and organizational change.',
      technological: 'Learning management systems, student information systems, CRM platforms, and analytics tools require ongoing investment and skilled staff. AI-driven advising, adaptive learning, and cybersecurity are emerging priorities creating new talent demands.',
      legal: 'FERPA, Title IX, ADA compliance, accreditation standards, and state authorization requirements create complex regulatory obligations. Institutional review boards (IRB) may govern data access for technology roles working with student records.',
      environmental: 'Campus sustainability commitments, carbon neutrality pledges, and green building standards for new construction create specialized staffing needs. Students increasingly expect environmental responsibility, making sustainability a recruitment and retention factor.'
    },
    'Energy & Utilities': {
      political: 'Energy policy, renewable portfolio standards, rate case proceedings, and grid reliability mandates directly drive workforce planning. Federal incentives (IRA, ITC, PTC) for clean energy are accelerating the transition and creating new hiring needs. FERC and state PUC regulatory requirements affect staffing levels.',
      economic: 'Regulated utilities operate under rate-of-return models where labor costs are passed through to ratepayers, creating different cost dynamics than competitive industries. Capital investment cycles for grid modernization drive project-based staffing needs. Commodity price volatility affects unregulated generation and trading operations.',
      social: 'The utility workforce is among the oldest in any industry, with a wave of retirements creating critical knowledge transfer challenges. Energy justice and equity considerations are increasingly factored into workforce planning and community engagement. Public expectations around reliability and storm response affect staffing levels.',
      technological: 'Grid modernization, distributed energy resources (DER), advanced metering infrastructure (AMI), and SCADA/OT cybersecurity are driving technology transformation. The convergence of IT and OT requires new skill profiles that bridge traditional utility operations with modern technology platforms.',
      legal: 'NERC CIP reliability standards, state PUC regulations, environmental permits, and pipeline safety requirements (PHMSA) create extensive compliance obligations. Labor agreements with IBEW and other unions affect workforce flexibility. OSHA and state safety regulations are particularly stringent.',
      environmental: 'Decarbonization commitments, coal plant retirements, renewable integration, and electrification of buildings and transportation are fundamentally reshaping the utility workforce. Environmental remediation obligations (coal ash, PCBs) and emissions reporting requirements create ongoing compliance needs.'
    },
    'Financial Services': {
      political: 'Regulatory priorities shift with administrations, affecting compliance staffing needs. Dodd-Frank implementation, CFPB enforcement posture, and state-level financial regulation (e.g., NY DFS) create varying compliance requirements. Sanctions policy and AML enforcement priorities drive specialized hiring.',
      economic: 'Interest rate environment affects profitability across banking, insurance, and asset management, which in turn drives hiring and technology investment budgets. Fintech competition is compressing margins in traditional banking services and forcing technology modernization. M&A activity creates integration staffing needs.',
      social: 'Consumer expectations for digital banking, mobile-first experiences, and personalized financial advice are driving technology investment. Financial inclusion and ESG investing mandates are creating new role requirements. The industry faces reputation challenges that affect talent attraction, particularly among younger candidates.',
      technological: 'Cloud migration, AI/ML for risk modeling and fraud detection, real-time payment systems, and open banking APIs are driving technology transformation. Cybersecurity is a board-level priority creating persistent demand for security professionals. RegTech adoption is accelerating.',
      legal: 'SOX, BSA/AML, GLBA, Reg SP, and state privacy laws create extensive compliance obligations. FINRA/SEC registration requirements and OCC heightened standards affect workforce structure. Third-party risk management frameworks govern contractor usage. State-level fiduciary and licensing requirements vary significantly.',
      environmental: 'ESG reporting requirements, climate risk disclosure rules (SEC), and sustainable finance commitments are creating new roles in ESG analysis, climate risk modeling, and sustainability reporting. Green bond and sustainable lending programs require specialized expertise.'
    },
    'Food & Beverage': {
      political: 'FDA and USDA regulatory changes, labeling requirements, and food safety legislation directly affect compliance staffing. Trade policy and tariffs on agricultural imports affect supply chain costs. State-level regulations on packaging, additives, and labeling create varying compliance needs.',
      economic: 'Consumer spending on food is relatively stable but shifts between foodservice and retail channels affect producer strategies. Input cost volatility (ingredients, packaging, energy) creates margin pressure that influences build-vs-buy workforce decisions. Private label growth is intensifying competition.',
      social: 'Consumer preferences for clean label, organic, plant-based, and sustainably sourced products are driving reformulation and supply chain changes. Health and wellness trends create new product development needs. Social media amplification of food safety incidents increases reputational risk and response staffing needs.',
      technological: 'Traceability systems, predictive quality analytics, automated production lines, and ERP modernization are driving technology investment. The industry is earlier in its digital transformation than many sectors, creating opportunities for both technology adoption and talent development.',
      legal: 'FSMA, HACCP requirements, SQF/FSSC 22000 certifications, and allergen management regulations create extensive compliance frameworks. State-level cottage food laws and labeling requirements vary. Product liability and recall management require dedicated resources.',
      environmental: 'Sustainability commitments around water usage, food waste reduction, regenerative agriculture, and packaging recyclability are creating new roles. Scope 3 emissions reporting requirements are extending sustainability obligations into the supply chain. Consumer and retailer expectations for sustainability credentials are intensifying.'
    },
    'Government & Public Sector': {
      political: 'Budget cycles, continuing resolutions, administration transitions, and legislative priorities directly affect agency staffing authority and project funding. Government shutdown risks create workforce planning uncertainty. Political appointee turnover at senior levels can shift strategic direction rapidly.',
      economic: 'Public sector compensation is constrained by pay tables (GS scale, state equivalents) that lag private sector market rates, particularly for technology roles. However, benefits packages (pension, health, job security) partially offset the gap. Budget sequestration and fiscal austerity can freeze hiring regardless of need.',
      social: 'Public service motivation is a meaningful recruitment lever, but competition with private sector for technology talent is intensifying. Diversity and inclusion mandates are more explicit than in many private sectors. Telework expansion during the pandemic created new expectations that are being partially walked back.',
      technological: 'Legacy system modernization (mainframe to cloud), cybersecurity (FISMA, CDM), zero trust architecture, and AI governance are driving technology demand. FedRAMP and StateRAMP compliance requirements affect which technologies can be deployed and create specialized staffing needs.',
      legal: 'FAR, personal services contract restrictions, appropriations law, and OMB circulars govern how agencies can use contract labor. Ethics regulations, financial disclosure requirements, and revolving door provisions affect hiring flexibility. State procurement codes and competitive bidding requirements add complexity at state and local levels.',
      environmental: 'Executive orders on sustainability, federal building energy performance standards, and fleet electrification mandates are creating new roles. Environmental justice and climate adaptation planning are expanding workforce needs at agencies like EPA, DOE, and state equivalents.'
    },
    'Healthcare': {
      political: 'CMS reimbursement policy, ACA implementation, Medicaid expansion decisions, and state certificate-of-need laws directly affect healthcare organization finances and staffing capacity. Scope-of-practice legislation affects role design and workforce flexibility. Surprise billing regulations and price transparency rules create compliance staffing needs.',
      economic: 'Healthcare organizations face persistent margin pressure from payer mix shifts, labor cost inflation, and rising supply costs. Technology investment competes with clinical staffing needs for limited capital. Value-based care transition is changing how organizations staff and measure performance.',
      social: 'Patient expectations for digital access, telehealth, and personalized care are driving technology investment. Health equity mandates are reshaping workforce composition and community engagement. The post-pandemic workforce has elevated expectations around flexibility and burnout prevention.',
      technological: 'EHR optimization, interoperability (FHIR/HL7), telehealth platforms, AI-assisted clinical decision support, and cybersecurity (HIPAA, HITECH) are driving persistent technology demand. Revenue cycle automation and population health analytics are creating new role requirements.',
      legal: 'HIPAA, HITECH, CMS Conditions of Participation, Joint Commission standards, and state licensing requirements create extensive compliance obligations. BAA requirements govern all contractor access to PHI. Stark Law and Anti-Kickback Statute affect how organizations structure workforce relationships with physicians.',
      environmental: 'Healthcare facilities are significant energy consumers, and sustainability commitments are driving investment in green building, waste reduction, and supply chain sustainability. Pharmaceutical waste management and medical device sterilization create specialized environmental compliance needs.'
    },
    'Manufacturing': {
      political: 'Trade policy, tariffs, reshoring incentives (CHIPS Act, IRA), and state economic development programs directly affect manufacturing workforce needs. OSHA enforcement priorities and state safety regulations affect compliance staffing. Immigration policy affects labor availability at production and engineering levels.',
      economic: 'Manufacturing is cyclical and sensitive to interest rates, housing starts, and industrial production indices. Raw material cost volatility affects margins and can accelerate or delay technology investment. Reshoring trends are creating new facility startups requiring rapid workforce buildout.',
      social: 'The manufacturing workforce is aging, with over 25% of workers eligible to retire within the next decade. Attracting younger workers requires modernizing the perception of manufacturing careers. Skills gap between traditional manufacturing and Industry 4.0 requirements is widening.',
      technological: 'Industry 4.0 (IoT, digital twins, predictive maintenance), ERP modernization, MES deployment, and robotics/automation are driving technology demand. The convergence of OT and IT requires new skill profiles. Additive manufacturing and advanced materials are creating specialized roles.',
      legal: 'OSHA regulations, EPA environmental permits, state worker compensation requirements, and product liability considerations affect workforce structure. Union collective bargaining agreements may restrict contractor usage. Export control regulations (EAR) affect who can access certain technical data.',
      environmental: 'Emissions regulations, waste reduction mandates, and circular economy initiatives are creating new roles in environmental compliance and sustainable manufacturing. Energy efficiency requirements and carbon reporting obligations are growing. ESG reporting expectations from customers and investors are intensifying.'
    },
    'Nonprofit': {
      political: 'Tax policy affecting charitable deductions, government grant programs, and advocacy restrictions (lobbying limits for 501(c)(3) organizations) directly affect nonprofit funding and staffing capacity. Political shifts can redirect government funding priorities, creating workforce volatility for grant-dependent organizations.',
      economic: 'Nonprofit funding is inherently uncertain, with revenue dependent on donor generosity, grant cycles, and government appropriations. Economic downturns simultaneously increase demand for services and reduce philanthropic giving. The sector typically offers 20-30% below market compensation for technology and administrative roles.',
      social: 'Mission alignment is the primary recruitment advantage for nonprofits, but it cannot fully compensate for below-market pay, particularly for technology roles. Board governance dynamics, volunteer management, and stakeholder engagement create unique organizational complexity. Burnout rates are high across the sector.',
      technological: 'CRM systems (Salesforce NPSP, Bloomerang), grant management platforms, outcome measurement tools, and digital fundraising are driving technology needs. Most nonprofits are under-resourced for technology, creating accumulated technical debt that compounds over time.',
      legal: 'IRS Form 990 reporting requirements, state charitable registration, donor restricted fund accounting, and grant compliance obligations create administrative complexity. Unrelated business income rules may affect certain technology ventures. Lobbying and political activity restrictions affect advocacy-related staffing.',
      environmental: 'Many nonprofits have sustainability as part of their mission, and those that do not still face growing expectations from donors and stakeholders for environmental responsibility. Grant funders increasingly require environmental impact reporting. Carbon offset and sustainability program management create specialized roles for environmental organizations.'
    },
    'Pharma & Life Sciences': {
      political: 'FDA regulatory policy, drug pricing legislation, patent law reform, and biosimilar approval pathways directly affect pharmaceutical business models and workforce needs. State-level pharmacy benefit manager regulations and drug pricing transparency laws create varying compliance requirements.',
      economic: 'The pharmaceutical industry operates with long development timelines (10-15 years) and high R&D investment, making workforce planning inherently long-range. Patent cliff dynamics drive urgency around pipeline development. Pricing pressure from government negotiation (IRA) is compressing margins and forcing operational efficiency.',
      social: 'Public trust in pharmaceutical companies affects talent attraction and retention. Clinical trial diversity requirements are reshaping how trials are designed and staffed. Patient advocacy groups and real-world evidence expectations are creating new engagement models requiring specialized talent.',
      technological: 'AI-driven drug discovery, real-world evidence platforms, decentralized clinical trials, and digital therapeutics are transforming the industry. Data integrity and computer system validation (CSV) requirements add compliance overhead to every technology decision. Pharmacovigilance automation is an emerging priority.',
      legal: '21 CFR Part 11, GxP validation requirements, ICH guidelines, HIPAA, and state pharmacy regulations create extensive compliance frameworks. Patent prosecution and Paragraph IV litigation require specialized legal talent. Transparency reporting (Sunshine Act) and anti-kickback compliance affect commercial operations staffing.',
      environmental: 'Green chemistry initiatives, pharmaceutical waste management, and API manufacturing emissions regulations create specialized environmental roles. Supply chain sustainability and cold chain logistics for biologics have environmental implications. ESG reporting expectations from investors are intensifying.'
    },
    'Professional Services': {
      political: 'Government contracting rules affect consulting firms serving public sector clients. State-level regulations around professional licensing (CPA, law, engineering) affect workforce mobility. Data privacy legislation (CCPA, state laws) creates compliance consulting demand while also affecting how firms manage their own workforce data.',
      economic: 'Professional services revenue is directly tied to billable utilization, making workforce planning a core financial discipline. Economic uncertainty drives demand for advisory services but can compress project budgets. The shift to outcome-based pricing from time-and-materials is changing how firms staff engagements.',
      social: 'Work-life balance expectations, particularly among younger professionals, are challenging the traditional professional services model of high utilization and extensive travel. Diversity and inclusion have become client selection criteria in many RFP processes. Remote work has expanded the talent pool but increased competition for top performers.',
      technological: 'AI-assisted advisory, data analytics, automation of routine deliverables, and knowledge management platforms are transforming service delivery. Firms need talent that can combine domain expertise with technology skills to deliver digital-first consulting engagements.',
      legal: 'Professional liability insurance requirements, conflict of interest policies, and client confidentiality obligations affect workforce structure. Non-compete and non-solicitation provisions are critical but face increasing legal scrutiny. State-level professional licensing requirements affect staff deployment across jurisdictions.',
      environmental: 'ESG consulting and sustainability advisory are among the fastest-growing practice areas. Firms face growing expectations from clients and employees for environmental responsibility. Carbon footprint reduction, particularly around travel, is becoming a competitive differentiator.'
    },
    'Real Estate': {
      political: 'Zoning regulations, rent control legislation, property tax policy, and housing affordability mandates directly affect real estate operations and staffing needs. Opportunity Zone incentives, LIHTC programs, and state-level housing policy create specialized compliance requirements.',
      economic: 'Real estate is highly sensitive to interest rates, cap rates, and credit availability. Remote work trends are reshaping office demand while industrial and multifamily sectors see relative strength. Property valuations and transaction volumes directly drive staffing needs for acquisitions, asset management, and disposition teams.',
      social: 'Tenant expectations for digital amenities, responsive property management, and community-oriented spaces are driving investment in property technology. ESG and sustainability expectations from institutional investors are becoming table stakes. Urbanization trends, demographic shifts, and remote work preferences are reshaping demand across property types.',
      technological: 'Property management systems, building automation (BAS), tenant experience platforms, portfolio analytics, and smart building technologies are driving technology adoption. The industry has historically underinvested in technology, creating both accumulated technical debt and greenfield opportunity.',
      legal: 'Fair housing requirements, lease accounting standards (ASC 842), state landlord-tenant laws, and ADA compliance create ongoing regulatory obligations. REIT tax qualification requirements affect organizational structure and staffing. Environmental site assessment and remediation liability affect acquisition and disposition processes.',
      environmental: 'Building energy performance standards, carbon disclosure requirements, green building certifications (LEED, ENERGY STAR), and climate risk assessment are creating new roles. ESG reporting for institutional investors requires dedicated sustainability and reporting talent. Electrification mandates for heating and cooling systems are driving capital planning and technical staffing needs.'
    },
    'Retail & E-commerce': {
      political: 'Sales tax nexus rules, data privacy legislation (CCPA, state laws), minimum wage increases, and scheduling predictability laws directly affect retail operations and labor costs. Trade policy and tariffs affect product costs and sourcing strategies.',
      economic: 'Retail is highly sensitive to consumer confidence, disposable income, and seasonal spending patterns. E-commerce growth continues to shift economics from stores to fulfillment. Margin compression from marketplace competition and promotional intensity affects technology investment capacity.',
      social: 'Consumer expectations for omnichannel experience, same-day delivery, personalization, and social commerce are driving technology investment. Retail workers increasingly expect scheduling flexibility, competitive wages, and career development opportunities. Social media amplification of customer service failures increases reputational risk.',
      technological: 'Unified commerce platforms, AI-powered personalization, inventory optimization, mobile POS, and customer data platforms are driving technology demand. PCI-DSS compliance and cybersecurity requirements create baseline staffing needs. Headless commerce architecture and composable technology stacks are reshaping platform teams.',
      legal: 'PCI-DSS compliance, state consumer protection laws, ADA web accessibility requirements, and evolving data privacy regulations create ongoing compliance obligations. Product safety and recall management require dedicated resources. State-level labor laws around scheduling, breaks, and overtime vary significantly.',
      environmental: 'Sustainable packaging mandates, supply chain transparency requirements, and consumer expectations for environmental responsibility are creating new roles. Scope 3 emissions reporting, textile waste regulations, and circular economy initiatives are particularly relevant for fashion and consumer goods retailers.'
    },
    'Technology': {
      political: 'Data privacy regulation (GDPR, CCPA, state laws), AI regulation, antitrust enforcement, and export controls on semiconductor and AI technology directly affect technology companies. Section 230 and content moderation policy create regulatory uncertainty for platform companies. Immigration policy (H-1B) significantly affects the technology talent pool.',
      economic: 'Technology sector valuations and funding availability drive hiring velocity. Interest rate environment affects growth equity and venture funding, which in turn drives startup hiring. The sector is experiencing a correction from pandemic-era over-hiring, but demand for AI, cybersecurity, and infrastructure talent remains strong.',
      social: 'Remote and hybrid work expectations are deeply embedded in technology culture and are non-negotiable for many candidates. Diversity and inclusion efforts face scrutiny from multiple directions. Developer experience, tooling quality, and engineering culture are significant factors in talent attraction and retention.',
      technological: 'AI/ML, cloud-native architecture, cybersecurity, platform engineering, and developer productivity are the primary technology vectors driving talent demand. The pace of technology change creates continuous skill obsolescence risk, making learning culture and technical growth opportunities critical retention factors.',
      legal: 'IP ownership, patent prosecution, open source licensing, non-compete enforceability (varies by state), and data privacy compliance create complex legal obligations. California\'s prohibition on non-competes significantly affects workforce mobility. AI governance and algorithmic accountability regulations are emerging.',
      environmental: 'Data center energy consumption, Scope 2 emissions, and e-waste management are the primary environmental considerations. Carbon neutrality commitments and renewable energy procurement are becoming competitive differentiators. Sustainable software engineering practices are an emerging discipline.'
    },
  };

  const defaultPestle = {
    political: 'Regulatory and policy developments at federal and state levels can affect workforce planning through changes in labor law, tax policy, industry-specific regulations, and government spending priorities. Monitor legislative developments that could affect employment costs, contractor classification rules, or industry-specific compliance requirements in '+stateClean+'.',
    economic: 'Macroeconomic conditions including interest rates, inflation, and labor market tightness directly affect both compensation levels and talent availability for '+roleName+' roles. Economic uncertainty may favor the flexibility of contracting, while stability tends to favor the investment in permanent hiring.',
    social: 'Workforce expectations around remote work, flexibility, compensation transparency, and career development continue to evolve. These expectations affect both the ability to attract candidates and the retention risk for either employment model. Understanding what '+roleName+' candidates prioritize beyond compensation is critical.',
    technological: 'Technology adoption trends in your industry are reshaping the skills profile required for '+roleName+' roles. Evaluate whether emerging technologies will change the scope of this role within the engagement period, and ensure the selected candidate has the adaptability to evolve with changing requirements.',
    legal: 'Worker classification rules, non-compete enforceability, and state-specific labor regulations in '+stateClean+' affect both employment models. Ensure contractor arrangements comply with applicable federal and state classification tests, and review IP assignment and confidentiality provisions for any non-employee engagement.',
    environmental: 'Sustainability and ESG considerations are increasingly influencing workforce decisions across industries. If your organization has environmental commitments, consider how this role contributes to or is affected by sustainability goals, reporting requirements, and stakeholder expectations.'
  };

  const pestle = pestleData[ind] || defaultPestle;

  //  INDUSTRY CONTEXT (PESTLE) 
  let industryContext = 'INDUSTRY CONTEXT: EXTERNAL ENVIRONMENT (PESTLE)\n';
  industryContext += ins.context+'\n\n';
  industryContext += 'Political and Regulatory: '+pestle.political+'\n\n';
  industryContext += 'Economic Factors: '+pestle.economic+'\n\n';
  industryContext += 'Social and Workforce Trends: '+pestle.social+'\n\n';
  industryContext += 'Technological Drivers: '+pestle.technological+'\n\n';
  industryContext += 'Legal Considerations: '+pestle.legal+'\n\n';
  industryContext += 'Environmental Factors: '+pestle.environmental;

  //  RISKS 
  let risks = 'POTENTIAL RISKS TO CONSIDER\n';
  risks += ins.risk+'\n\n';
  risks += contractorWins
    ? 'If the project extends significantly beyond '+s.months+' months, the cost advantage narrows and reverses past the break-even of approximately month '+s.xMo+'. Building in re-evaluation milestones at or before break-even is recommended to assess whether conversion to permanent hire makes sense. Conversion costs including any buyout or placement fee should be factored in.'
    : 'If the scope shrinks or the engagement ends early, the direct-hire one-time costs of $'+Math.round(s.recruitAmt+s.rampCost).toLocaleString()+' may not fully amortize, tipping economics toward contracting. Consider whether a probationary period, contract-to-hire structure, or phased commitment could mitigate this risk.';
  risks += longTerm ? '\n\nFor a '+s.months+'-month engagement, contractor retention is a real and often underestimated risk. High-performing contractors receive competing offers regularly, and mid-engagement turnover can be more disruptive than permanent hire resignation because contractor transitions typically involve less notice and no institutional handoff. Consider whether renewal terms, rate escalation provisions, or a conversion clause should be negotiated upfront.' : '';

  //  RESEARCH (Internal Analysis + External Analysis) 
  let research = 'STRATEGIC ASSESSMENT FRAMEWORK\n';

  // Internal Analysis
  research += 'Internal Analysis:\n\n';
  research += 'Pay Equity and Compensation Structure: Before making a hiring decision, evaluate how the proposed salary of $'+s.salary.toLocaleString()+' for '+roleName+' aligns with your existing internal pay structure. If current employees in comparable roles earn significantly more or less, this hire could create internal equity issues that affect morale, retention, and potential legal exposure. Review your compensation bands, recent merit increase history, and any pay equity audit findings to ensure this offer is internally consistent.\n\n';
  research += 'Historical Hiring Practices: Examine your organization\'s track record with both direct hires and contractors for similar roles. What has your average time-to-fill been for comparable positions? What is your first-year turnover rate for direct hires versus contractor non-renewal rate? If previous '+roleName+' hires have consistently left within 12-18 months, the contractor model may better match your actual retention pattern regardless of cost modeling. Conversely, if contractors have consistently been converted to permanent roles, a direct hire may be more efficient.\n\n';
  research += 'Skills Evaluation and Gap Assessment: Assess whether the skills required for this '+roleName+' role exist within your current organization at any level. If internal candidates could be developed or upskilled to fill this role within a reasonable timeframe, the cost of a contractor engagement could instead fund an internal development program with lasting organizational benefit. Document the specific technical and domain skills required, distinguish between must-have and nice-to-have qualifications, and evaluate whether your current team has adjacent capabilities that could be leveraged.\n\n';
  research += 'Succession and Progression Planning: Consider where this role fits within your organizational talent pipeline. If this is a critical function, how will knowledge be retained and transferred regardless of whether you hire directly or contract? For direct hires, define the career progression path and ensure it is competitive enough to support retention. For contractors, establish knowledge transfer protocols and documentation requirements from day one to protect against institutional knowledge loss when the engagement ends.\n\n';

  // Market Research and Next Steps
  research += 'Market Research and Next Steps: Before making a final decision, take time to evaluate the following internal factors that will shape the success of either hiring model.\n\n';
  research += '\u2022 How does the proposed salary of $'+s.salary.toLocaleString()+' compare to what you are currently paying employees in similar or adjacent roles? Would this hire create pay equity concerns that could affect morale or retention among your existing team?\n\n';
  research += '\u2022 What has your organization\'s retention history looked like for '+roleName+' roles or similar positions? If direct hires in this function have historically turned over within 12-18 months, a contractor model may better reflect your actual workforce pattern.\n\n';
  research += '\u2022 Are there internal candidates who could be developed or upskilled into this role within a reasonable timeframe? If so, a contractor engagement could serve as a bridge while you invest in building that capability from within.\n\n';
  research += '\u2022 Where does this role sit in your succession plan? If this is a critical function, what documentation, knowledge transfer protocols, or cross-training would need to be in place to protect against knowledge loss regardless of hiring model?\n\n';
  research += '\u2022 Has your organization clearly defined the scope and expected duration of this need? If the role is likely to evolve or extend beyond '+s.months+' months, factor that into your cost comparison using the break-even point of approximately month '+s.xMo+'.\n\n';
  if (ind) {
    research += '\u2022 Are there '+ind+'-specific compliance, certification, or onboarding requirements that would affect time-to-productivity for either a direct hire or contractor in this role?\n\n';
  }
  research += 'Synthesizing the Assessment: The internal factors above should be weighed alongside the external market conditions, regulatory environment, and industry dynamics covered earlier in this report. The financial comparison provides the quantitative foundation, but these organizational realities often determine whether a hiring decision succeeds or fails in practice.';
  research += '\n\nHow Main Line Talent Group Can Help: The internal assessment above is work only your organization can do. The external research, including compensation benchmarking, talent market analysis, bill rate validation, and workforce availability, is where Main Line Talent Group adds immediate value. We do this work every day across '+(ind ? ind+' and ' : '')+'dozens of industries, and we bring that market intelligence directly to our clients. More importantly, we take the time to understand your business, your culture, and your goals so that every recommendation we make is grounded in your reality, not just the numbers. We would welcome the opportunity to learn more about your organization and show you what a true workforce planning partnership looks like.';

  return compBenchmark+'\n\n'+directProsCons+'\n\n'+contractorProsCons+'\n\n'+industryContext+'\n\n'+risks+'\n\n'+research;
}


function buildPDF(s, narrative, w) {
  const roleLabel = s.role!=='Not specified' ? s.role : 'General hiring evaluation';
  const industryLabel = s.industry ? '    Industry: '+s.industry : '';
  const dateStr = new Date().toLocaleDateString('en-US',{year:'numeric',month:'long',day:'numeric'});
  const billingLabel = s.mode==='hourly'?'Hourly':s.mode==='weekly'?'Guaranteed Hours':'Monthly Retainer';
  const stateClean = (s.stateLabel||'').replace(/ \(.*\)/,'');
  const contractorWins = s.delta > 0;
  const deltaMsg = contractorWins
    ? 'Contractor saves $'+Math.round(Math.abs(s.delta)).toLocaleString()+' over this engagement'
    : 'Direct hire is $'+Math.round(Math.abs(s.delta)).toLocaleString()+' lower cost over this engagement';

  const sectionDefs = [
    {key:'COMPENSATION BENCHMARK', color:'#2d7a4f'},
    {key:'DIRECT HIRE: PROS AND CONS', color:'#8c8c8c'},
    {key:'CONTRACTOR: PROS AND CONS', color:'#2C5E79'},
    {key:'INDUSTRY CONTEXT: EXTERNAL ENVIRONMENT (PESTLE)', color:'#5b4a8a'},
    {key:'POTENTIAL RISKS TO CONSIDER', color:'#b45014'},
    {key:'STRATEGIC ASSESSMENT FRAMEWORK', color:'#231F20'},
  ];
  // Helper: auto-link emails and URLs in text
  function linkify(text) {
    // Link emails
    let out = text.replace(/([a-zA-Z0-9._%+\-]+@[a-zA-Z0-9.\-]+\.[a-zA-Z]{2,})/g, function(m) {
      return '<a href="mailto:'+m+'" style="color:#2C5E79;text-decoration:underline;">'+m+'</a>';
    });
    return out;
  }

  // PESTLE letter definitions
  const pestleLetters = [
    { letter: 'P', word: 'Political', color: '#1a3a5c' },
    { letter: 'E', word: 'Economic', color: '#2C5E79' },
    { letter: 'S', word: 'Social', color: '#5b4a8a' },
    { letter: 'T', word: 'Technological', color: '#2d7a4f' },
    { letter: 'L', word: 'Legal', color: '#b45014' },
    { letter: 'E', word: 'Environmental', color: '#3a7a5c' },
  ];

  // Map sub-header prefixes to PESTLE letters
  const pestleMap = {
    'Political and Regulatory': 0,
    'Economic Factors': 1,
    'Social and Workforce Trends': 2,
    'Technological Drivers': 3,
    'Legal Considerations': 4,
    'Environmental Factors': 5,
  };

  let sectionHTML = '';
  sectionDefs.forEach((sec,idx) => {
    const nextKey = idx < sectionDefs.length-1 ? sectionDefs[idx+1].key : null;
    const start = narrative.indexOf(sec.key);
    if (start === -1) return;
    const end = nextKey ? narrative.indexOf(nextKey) : narrative.length;
    const body = narrative.slice(start+sec.key.length, end!==-1?end:undefined).trim();
    const paragraphs = body.split(/\n\n+/).filter(p => p.trim());
    const isPestle = sec.key.indexOf('PESTLE') !== -1;

    const parasHTML = paragraphs.map(p => {
      const t = p.trim();

      // Bullet point items ( prefix)
      if (t.startsWith('\u2022')) {
        const bulletText = linkify(t.slice(1).trim());
        return '<div class="section-block" style="display:flex;gap:8px;margin:6px 0 0 0;align-items:flex-start;">'
          + '<div style="flex-shrink:0;width:6px;height:6px;background:#EB1C24;border-radius:50%;margin-top:6px;"></div>'
          + '<p style="font-size:10.5px;color:#333;line-height:1.7;margin:0;">'+bulletText+'</p></div>';
      }

      // Check for sub-headers like "Political and Regulatory: ..." or "Internal Analysis:"
      const subMatch = t.match(/^([A-Z][A-Za-z &,\/\-]+(?:\([A-Z]+\))?):[\s\n]/);
      if (subMatch) {
        const label = subMatch[1];
        const rest = linkify(t.slice(subMatch[0].length).trim());
        const pestleIdx = pestleMap[label];

        if (isPestle && pestleIdx !== undefined) {
          const pl = pestleLetters[pestleIdx];
          return '<div class="pestle-block" style="display:flex;gap:12px;margin:14px 0 0 0;align-items:flex-start;">'
            + '<div style="flex-shrink:0;width:36px;height:36px;background:'+pl.color+';color:#fff;border-radius:5px;display:flex;align-items:center;justify-content:center;font-size:18px;font-weight:800;letter-spacing:0;">'+pl.letter+'</div>'
            + '<div style="flex:1;"><div style="font-size:9px;font-weight:700;color:'+pl.color+';text-transform:uppercase;letter-spacing:0.1em;margin-bottom:2px;">'+pl.word+'</div>'
            + '<p style="font-size:10.5px;color:#333;line-height:1.7;margin:0;">'+rest+'</p></div></div>';
        }

        return '<p style="font-size:10.5px;color:#333;line-height:1.7;margin:12px 0 0 0;"><strong style="color:#231F20;">'+label+':</strong> '+linkify(rest)+'</p>';
      }
      return '<p style="font-size:10.5px;color:#333;line-height:1.7;margin:8px 0 0 0;">'+linkify(t)+'</p>';
    }).join('');

    sectionHTML += '<div class="section-banner" style="background:'+sec.color+';color:#fff;padding:6px 14px;border-radius:4px;font-size:10px;font-weight:700;letter-spacing:0.08em;margin-top:18px;">'+sec.key+'</div>'+parasHTML;
  });

  const bonusRow = s.bonusCost > 0
    ? '<tr style="color:#999;font-size:9.5px;"><td style="padding:3px 0 3px 14px;">Bonuses</td><td style="text-align:right;padding:3px 0;">$'+Math.round(s.bonusCost).toLocaleString()+'</td></tr>'
    : '';

  const html = '<!DOCTYPE html><html><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>MLTG Cost Analysis: '+roleLabel+'</title>'
    + '<style>@page{size:letter;margin:0.4in 0.6in 0.5in 0.6in;}@media print{body{-webkit-print-color-adjust:exact!important;print-color-adjust:exact!important;}.no-print{display:none!important;}}.pestle-block,.section-block,p{break-inside:avoid;page-break-inside:avoid;}.section-banner{break-after:avoid;page-break-after:avoid;}*{box-sizing:border-box;margin:0;padding:0;}body{font-family:"Segoe UI",Arial,Helvetica,sans-serif;color:#231F20;font-size:11px;line-height:1.5;background:#fff;}.page{max-width:7.5in;margin:0 auto;padding:0 20px;}.header{background:#231F20;padding:14px 20px;display:flex;justify-content:space-between;align-items:center;}.header-left{color:#fff;font-weight:700;font-size:10px;letter-spacing:0.06em;}.header-right{color:#C4B8AE;font-size:8.5px;}.red-bar{height:3px;background:#EB1C24;}.title-block{background:#f5f3f0;padding:16px 20px;margin-top:16px;border-radius:5px;}.title-block h1{font-size:18px;font-weight:800;margin-bottom:4px;}.title-block .sub{font-size:10px;color:#666;}.params-bar{display:flex;background:#231F20;border-radius:5px;margin-top:12px;overflow:hidden;}.params-bar .param{flex:1;text-align:center;padding:10px 8px;}.params-bar .param-val{color:#fff;font-weight:700;font-size:12px;}.params-bar .param-lbl{color:#b4bec8;font-size:8px;margin-top:3px;}.cards{display:flex;gap:10px;margin-top:14px;}.card{flex:1;border:1px solid #ddd;border-radius:5px;overflow:hidden;}.card-accent{height:3px;}.card-body{padding:14px 16px;}.card h3{font-size:8.5px;text-transform:uppercase;letter-spacing:0.08em;color:#888;margin-bottom:8px;}.card .total{font-size:22px;font-weight:800;margin-bottom:10px;}.card table{width:100%;border-collapse:collapse;}.card td{padding:3px 0;font-size:9.5px;}.card .total-row td{font-weight:700;font-size:10.5px;padding-top:8px;border-top:1px solid #ddd;}.card .green{color:#2d7a4f;}.card .gray{color:#999;}.delta-banner{text-align:center;padding:12px;border-radius:5px;margin-top:14px;color:#fff;}.delta-banner .big{font-size:13px;font-weight:700;}.delta-banner .sm{font-size:9px;opacity:0.85;margin-top:3px;}.section-heading{font-size:15px;font-weight:800;margin-top:24px;margin-bottom:12px;}.cta-box{background:#231F20;border-radius:6px;padding:18px 22px;margin-top:24px;border-left:4px solid #EB1C24;}.cta-box h3{color:#fff;font-size:14px;margin-bottom:6px;}.cta-box p{color:#b4c4d2;font-size:9.5px;line-height:1.6;}.cta-box .email{color:#4C9CC9;font-weight:700;font-size:10px;margin-top:10px;}.footer{text-align:center;font-size:8px;color:#999;margin-top:20px;padding-top:10px;border-top:1px solid #eee;}.print-bar{text-align:center;padding:20px;}.print-bar button{font-family:inherit;padding:12px 32px;font-size:14px;font-weight:700;background:#231F20;color:#fff;border:none;border-radius:6px;cursor:pointer;}.print-bar button:hover{opacity:0.9;}@media(max-width:600px){.page{padding:0 16px;}.header{padding:12px 16px;flex-direction:column;gap:6px;align-items:flex-start;}.title-block{padding:14px 16px;}.title-block h1{font-size:15px;}.params-bar{flex-wrap:wrap;}.params-bar .param{min-width:33%;padding:8px 6px;}.params-bar .param-val{font-size:11px;}.cards{flex-direction:column;}.card-body{padding:12px 14px;}.card .total{font-size:18px;}.delta-banner .big{font-size:11px;}.section-heading{font-size:13px;}.cta-box{padding:14px 16px;}.pestle-block{padding:0 4px;}}</style></head><body>'
    + '<div class="no-print print-bar"><button onclick="window.print()">\uD83D\uDCBE Save as PDF</button><p style="font-size:12px;color:#888;margin-top:8px;">In the print dialog, select <strong>"Save as PDF"</strong> as your destination (instead of a printer).</p></div>'
    + '<div class="page"><div class="header"><div class="header-left">MAIN LINE TALENT GROUP</div><div class="header-right">mainlinetalent.com</div></div><div class="red-bar"></div>'
    + '<div class="title-block"><h1>Workforce Cost Analysis</h1><div class="sub">Role: '+roleLabel+industryLabel+'</div><div class="sub">Prepared by Main Line Talent Group    '+dateStr+'</div></div>'
    + '<div class="params-bar"><div class="param"><div class="param-val">$'+s.salary.toLocaleString()+'</div><div class="param-lbl">Salary</div></div><div class="param"><div class="param-val">$'+s.rate+'/hr</div><div class="param-lbl">Bill Rate</div></div><div class="param"><div class="param-val">'+s.months+' months</div><div class="param-lbl">Engagement</div></div><div class="param"><div class="param-val">'+stateClean+'</div><div class="param-lbl">State</div></div><div class="param"><div class="param-val">'+billingLabel+'</div><div class="param-lbl">Billing</div></div></div>'
    + '<div class="cards"><div class="card"><div class="card-accent" style="background:#999;"></div><div class="card-body"><h3>Direct W-2 Hire</h3><div class="total">$'+Math.round(s.dTotal).toLocaleString()+'</div><table>'
    + '<tr><td>Base Salary (Prorated)</td><td style="text-align:right;">$'+Math.round(s.salaryPro).toLocaleString()+'</td></tr>'
    + '<tr style="color:#999;font-size:9.5px;"><td style="padding-left:14px;">Employer Payroll Taxes</td><td style="text-align:right;">$'+Math.round(s.taxTotal).toLocaleString()+'</td></tr>'
    + '<tr style="color:#999;font-size:9.5px;"><td style="padding-left:14px;">Health Insurance</td><td style="text-align:right;">$'+Math.round(s.healthAmt).toLocaleString()+'</td></tr>'
    + '<tr style="color:#999;font-size:9.5px;"><td style="padding-left:14px;">401(k) Match ('+(s.k401Pct!=null?Math.round(s.k401Pct):3)+'%)</td><td style="text-align:right;">$'+Math.round(s.k401).toLocaleString()+'</td></tr>'
    + '<tr style="color:#999;font-size:9.5px;"><td style="padding-left:14px;">PTO Cost (~19 Days)</td><td style="text-align:right;">$'+Math.round(s.ptoAmt).toLocaleString()+'</td></tr>'
    + '<tr style="color:#999;font-size:9.5px;"><td style="padding-left:14px;">IT &amp; Equipment</td><td style="text-align:right;">$'+Math.round(s.itAmt).toLocaleString()+'</td></tr>'
    + '<tr style="color:#999;font-size:9.5px;"><td style="padding-left:14px;">Recruiting / Placement</td><td style="text-align:right;">$'+Math.round(s.recruitAmt).toLocaleString()+'</td></tr>'
    + '<tr style="color:#999;font-size:9.5px;"><td style="padding-left:14px;">Ramp Cost</td><td style="text-align:right;">$'+Math.round(s.rampCost).toLocaleString()+'</td></tr>'
    + bonusRow
    + '<tr class="total-row"><td>TOTAL TRUE COST</td><td style="text-align:right;">$'+Math.round(s.dTotal).toLocaleString()+'</td></tr>'
    + '<tr class="gray"><td>Effective Hourly Rate</td><td style="text-align:right;">'+fmtHr(s.dEhr)+'</td></tr>'
    + '</table></div></div>'
    + '<div class="card"><div class="card-accent" style="background:#2C5E79;"></div><div class="card-body"><h3>'+(s.cHeading||'Contractor via MLTG')+'</h3><div class="total">$'+Math.round(s.cTotal).toLocaleString()+'</div><table>'
    + '<tr><td>Bill Rate  Hours Billed</td><td style="text-align:right;">$'+Math.round(s.cTotal).toLocaleString()+'</td></tr>'
    + '<tr class="green" style="font-size:9.5px;"><td style="padding-left:14px;">Payroll Taxes</td><td style="text-align:right;">$0 (not your cost)</td></tr>'
    + '<tr class="green" style="font-size:9.5px;"><td style="padding-left:14px;">Benefits &amp; Insurance</td><td style="text-align:right;">$0 (not your cost)</td></tr>'
    + '<tr class="green" style="font-size:9.5px;"><td style="padding-left:14px;">IT &amp; Equipment</td><td style="text-align:right;">$0 (not your cost)</td></tr>'
    + '<tr class="green" style="font-size:9.5px;"><td style="padding-left:14px;">Recruiting Fee</td><td style="text-align:right;">$0 (included)</td></tr>'
    + '<tr class="green" style="font-size:9.5px;"><td style="padding-left:14px;">Ramp Time</td><td style="text-align:right;">Minimal</td></tr>'
    + '<tr><td>&nbsp;</td><td></td></tr><tr><td>&nbsp;</td><td></td></tr>'
    + '<tr class="total-row"><td>TOTAL ENGAGEMENT COST</td><td style="text-align:right;">$'+Math.round(s.cTotal).toLocaleString()+'</td></tr>'
    + '<tr class="gray"><td>Effective Hourly Rate</td><td style="text-align:right;">'+fmtHr(s.cEhr)+'</td></tr>'
    + '</table></div></div></div>'
    + '<div class="delta-banner" style="background:'+(contractorWins?'#2C5E79':'#2d7a4f')+';"><div class="big">'+deltaMsg+'</div><div class="sm">Break-even: approximately month '+s.xMo+'    Annualized Direct Hire: $'+Math.round(s.dAnnual).toLocaleString()+'</div></div>'
    + '<div style="page-break-before:always;"></div><div class="header" style="margin-top:0;"><div class="header-left">MAIN LINE TALENT GROUP</div><div class="header-right">Workforce Planning Calculator  '+dateStr+'</div></div><div class="red-bar"></div>'
    + '<div class="section-heading">Analysis &amp; Recommendations</div>'
    + sectionHTML
    + '<div class="cta-box" style="background:#231F20;border-radius:6px;padding:22px 26px;margin-top:28px;border-left:4px solid #EB1C24;">'
    + '<h3 style="color:#fff;font-size:15px;margin-bottom:10px;font-weight:800;">Lets Build Your Workforce Strategy Together</h3>'
    + '<p style="color:#b4c4d2;font-size:10px;line-height:1.7;margin-bottom:6px;">This report highlights areas that deserve deeper investigation: compensation benchmarking, talent market analysis, pay equity, succession planning, and regulatory compliance. These are exactly the challenges Main Line Talent Group helps employers solve every day.</p>'
    + '<p style="color:#b4c4d2;font-size:10px;line-height:1.7;margin-bottom:6px;">Were not just a staffing firm. Were a workforce planning and talent management partner. Wed love to learn more about your business, your team, and your goals, so we can bring you the market intelligence, candidate insights, and strategic guidance that turns this analysis into action.</p>'
    + '<p style="color:#e0d6cc;font-size:10.5px;font-weight:700;margin-bottom:14px;">Whether youre ready to hire or still exploring options, a 15-minute conversation can make the difference.</p>'
    + '<div style="display:flex;gap:12px;align-items:center;flex-wrap:wrap;">'
    + '<a href="https://www.mainlinetalent.com/scheduling" target="_blank" style="display:inline-block;background:#EB1C24;color:#fff;padding:11px 28px;border-radius:5px;font-size:11px;font-weight:700;text-decoration:none;letter-spacing:0.03em;">Schedule a Consultation </a>'
    + '<a href="mailto:support@mainlinetalent.com" style="display:inline-block;background:transparent;color:#4C9CC9;padding:11px 20px;border-radius:5px;font-size:11px;font-weight:700;text-decoration:none;border:1px solid #4C9CC9;">support@mainlinetalent.com</a>'
    + '</div>'
    + '<div style="margin-top:12px;color:#666;font-size:8.5px;">mainlinetalent.com    Workforce Planning    Talent Management    Compensation Benchmarking</div>'
    + '</div>'
    + '<div class="footer">Main Line Talent Group    Workforce Planning Calculator    For Discussion Purposes Only</div>'
    + '</div></body></html>';

  if (w && w.isEmbedded) {
    // Render into the current page (report viewer mode)
    document.head.insertAdjacentHTML('beforeend', '<style>' + html.match(/<style>([\s\S]*?)<\/style>/)[1] + '</style>');
    const bodyMatch = html.match(/<body>([\s\S]*?)<\/body>/);
    if (bodyMatch) document.body.innerHTML = bodyMatch[1];
    document.title = 'Cost Analysis: ' + (s.role || 'Workforce') + ' | MLTG';
  } else if (w) {
    w.document.open(); w.document.write(html); w.document.close();
  } else {
    const blob = new Blob([html], {type:'text/html'});
    const url = URL.createObjectURL(blob);
    window.open(url, '_blank');
  }
}




// 
//  REPORT URL BUILDER 
function buildReportURL(snap) {
  var data = {
    r: snap.role, i: snap.industry, s: snap.salary, rt: snap.rate,
    m: snap.months, hrs: snap.hrs, mh: snap.minHrs, mo: snap.mode,
    st: snap.stateLabel,
    dT: Math.round(snap.dTotal), dA: Math.round(snap.dAnnual||snap.dTotal*(12/snap.months)),
    sp: Math.round(snap.salaryPro), tx: Math.round(snap.taxTotal),
    ha: Math.round(snap.healthAmt), k4: Math.round(snap.k401),
    pt: Math.round(snap.ptoAmt), it: Math.round(snap.itAmt),
    rc: Math.round(snap.recruitAmt), rp: Math.round(snap.rampCost),
    bc: Math.round(snap.bonusCost||0), de: snap.dEhr, rl: snap.rampLabel,
    cT: Math.round(snap.cTotal), ce: snap.cEhr,
    ch: snap.cHeading||'', dl: Math.round(snap.delta), xm: snap.xMo
  };
  var json = JSON.stringify(data);
  var encoded = btoa(unescape(encodeURIComponent(json)));
  return 'https://www.mainlinetalent.com/resources/workforceplanningcalculator?report=' + encodeURIComponent(encoded);
}

//  REPORT VIEWER MODE 
// If URL contains ?report=, render the report instead of the calculator
// 
(function() {
  var params = new URLSearchParams(window.location.search);
  var encoded = params.get('report');
  if (!encoded) return;

  var d;
  try {
    var json = decodeURIComponent(escape(atob(decodeURIComponent(encoded))));
    d = JSON.parse(json);
  } catch (e) {
    document.body.innerHTML = '<div style="text-align:center;padding:60px;font-family:sans-serif;"><h2>Report Not Found</h2><p>This link does not contain valid report data. Please generate a new report from the calculator.</p></div>';
    return;
  }

  var snap = {
    role: d.r, industry: d.i, salary: d.s, rate: d.rt,
    months: d.m, hrs: d.hrs, minHrs: d.mh, mode: d.mo,
    stateLabel: d.st,
    dTotal: d.dT, dAnnual: d.dA, salaryPro: d.sp, taxTotal: d.tx,
    healthAmt: d.ha, k401: d.k4, ptoAmt: d.pt, itAmt: d.it,
    recruitAmt: d.rc, rampCost: d.rp, bonusCost: d.bc || 0,
    dEhr: d.de, rampLabel: d.rl,
    cTotal: d.cT, cEhr: d.ce, cHeading: d.ch,
    delta: d.dl, xMo: d.xm
  };

  // Hide the wizard
  var shell = document.querySelector('.wizard-shell');
  if (shell) shell.style.display = 'none';
  var ftr = document.querySelector('.ftr');
  if (ftr) ftr.style.display = 'none';

  // Generate narrative and build report in the current page
  var narrative = fetchNarrative(snap);
  buildPDF(snap, narrative, { document: document, isEmbedded: true });
})();


</script>
</body>
</html>
